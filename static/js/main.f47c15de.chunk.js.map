{"version":3,"sources":["Theme/index.js","DemoSite/Editor.js","SidebarBoxContainer/index.js","TaskDescriptionSidebarBox/index.js","ImageSelectorSidebarBox/index.js","RegionSelectorSidebarBox/styles.js","RegionSelectorSidebarBox/index.js","HistorySidebarBox/index.js","DebugSidebarBox/index.js","TagsSidebarBox/index.js","KeyframeTimeline/get-time-string.js","KeyframesSelectorSidebarBox/index.js","Sidebar/index.js","Crosshairs/index.js","RegionLabel/styles.js","RegionLabel/index.js","HighlightBox/index.js","PreventScrollToParents/index.js","hooks/use-window-size.js","ImageCanvas/use-mouse.js","ImageCanvas/use-project-box.js","ImageCanvas/region-tools.js","PointDistances/index.js","RegionTags/index.js","RegionSelectAndTransformBoxes/index.js","SettingsProvider/index.js","VideoOrImageCanvasBackground/index.js","ImageCanvas/index.js","ImageCanvas/styles.js","hooks/use-exclude-pattern.js","hooks/xpattern.js","HeaderButton/index.js","Header/styles.js","KeyframeTimeline/index.js","Header/index.js","SmallToolButton/index.js","IconTools/index.js","MainLayout/styles.js","SettingsDialog/index.js","Fullscreen/index.js","Annotator/reducers/get-active-image.js","Annotator/reducers/get-implied-video-regions.js","MainLayout/use-implied-video-regions.js","MainLayout/index.js","Annotator/reducers/history-handler.js","Annotator/reducers/general-reducer.js","Annotator/reducers/image-reducer.js","Annotator/reducers/video-reducer.js","Annotator/index.js","Annotator/reducers/combine-reducers.js","DemoSite/ErrorBoundaryDialog.js","DemoSite/index.js","LandingPage/index.js","index.js"],"names":["useStyles","makeStyles","container","fontFamily","theme","createMuiTheme","typography","overrides","MuiButton","root","textTransform","Theme","_ref","children","classes","react_default","a","createElement","ThemeProvider","className","editBar","padding","borderBottom","backgroundColor","display","alignItems","& .button","margin","select","width","fontSize","contentArea","specificationArea","loadSavedInput","JSON","parse","window","localStorage","getItem","e","examples","Simple Bounding Box","taskDescription","regionTagList","regionClsList","enabledTools","images","src","name","Simple Segmentation","Custom","Editor","onOpenAnnotator","lastOutput","c","_useState","useState","_useState2","Object","slicedToArray","currentError","changeCurrentError","_useState3","_useState4","selectedExample","changeSelectedExample","_useState5","_useState6","outputDialogOpen","changeOutputOpen","_useState7","stringify","_useState8","currentJSONValue","changeCurrentJSONValue","style","flexGrow","react_select_browser_esm","value","label","options","keys","map","s","onChange","selectedOption","Button","disabled","onClick","variant","Boolean","border","lib_default","language","code","setItem","toString","height","default_highlight","Dialog","fullScreen","open","DialogTitle","DialogContent","minWidth","DialogActions","header","flexDirection","paddingLeft","paddingRight","title","fontWeight","color","grey","& span","expandButton","& .icon","marginTop","transition","&.expanded","transform","expandedContent","maxHeight","overflowY","&.noScroll","overflow","memo","icon","subTitle","_ref$noScroll","noScroll","_ref$expandedByDefaul","expandedByDefault","content","classnames","expanded","changeExpanded","toggleExpanded","useEventCallback","Paper","IconButton","ExpandMore_default","Collapse","in","prev","next","MarkdownContainer","styled","& h1","& h2","& h3","& h4","& h5","& h6","& p","& a","& img","description","src_SidebarBoxContainer","Description_default","react_markdown_default","source","img","borderRadius","mapUsedImageProps","regions","length","onSelect","concat","Collections_default","List","i","ListItem","button","dense","key","ListItemText","primary","secondary","prevProps","nextProps","isEqual","styles","& .icon2","opacity","&:hover","cursor","row","&.header:hover","&.highlighted","blue","chip","& .color","marginRight","& .text","HeaderSep","borderTop","marginBottom","Chip","text","RowLayout","_ref2","highlighted","order","classification","area","trash","tags","lock","visible","changeMouseOver","onMouseEnter","onMouseLeave","Grid","item","xs","textAlign","MemoRowHeader","RegionSelectorSidebarBox_RowLayout","SwapVert_default","PieChart_default","Delete_default","Lock_default","Visibility_default","MemoRow","_ref3","r","region","onSelectRegion","onDeleteRegion","onChangeRegion","locked","cls","index","RegionSelectorSidebarBox_Chip","objectSpread","LockOpen_default","undefined","VisibilityOff_default","id","mapUsedRegionProperties","_ref4","PictureInPicture_default","assign","emptyText","history","onRestoreHistory","History_default","time","moment","format","ListItemSecondaryAction","Undo_default","DebugSidebarBox","state","lastAction","image","find","selectedImage","mode","selectedImageFrameTime","emptyArr","currentImage","_ref$imageClsList","imageClsList","_ref$imageTagList","imageTagList","onChangeImage","_currentImage$tags","_currentImage$cls","onChangeClassification","o","onChangeTags","selectValue","useMemo","memoImgClsList","asMutable","memoImgTagList","memoCurrentTags","Style_default","placeholder","paddingTop","isMulti","getTimeString","ms","precision","arguments","secs","Number","isInteger","toFixed","mins","KeyframeRow","colors","&.current","& .time","& .regionCount","marginLeft","& .trash","KeyframesSelector","currentVideoTime","keyframes","onChangeVideoTime","onDeleteKeyframe","keyframeTimes","t","parseInt","AddLocation_default","fullWidth","stopPropagation","Sidebar","debug","labelImages","onSelectImage","src_DebugSidebarBox","src_TaskDescriptionSidebarBox","src_TagsSidebarBox","src_ImageSelectorSidebarBox","src_RegionSelectorSidebarBox","KeyframesSelectorSidebarBox","src_HistorySidebarBox","Crosshairs","mousePosition","x","y","changeForceRenderState","current","useEffect","interval","setInterval","clearInterval","react","position","zIndex","left","pointerEvents","top","RegionLabel_styles","regionInfo","& .name","& .circle","boxShadow","& .tags","& .tag","textDecoration","editing","allowedClasses","allowedTags","onDelete","onClose","onOpen","textShadow","type","tabIndex","size","newTags","Check_default","@keyframes borderDance","from","strokeDashoffset","to","highlightBox","&:not(.highlighted)","&:not(.highlighted):hover","& path","vectorEffect","strokeWidth","stroke","fill","strokeDasharray","animationName","animationDuration","animationTimingFunction","animationIterationCount","animationPlayState","HighlightBox","mouseEvents","dragWithPrimary","zoomWithPrimary","createWithPrimary","onBeginMovePoint","pbox","onMouseDown","w","h","d","Container","& > div","PreventScrollToParents","otherProps","objectWithoutProperties","mouseOver","onMouseMove","setTimeout","Combination","enabled","removeScrollBar","useWindowSize","initialWidth","Infinity","initialHeight","isClient","_useRafState","useRafState","innerWidth","innerHeight","_useRafState2","setState","handler","addEventListener","removeEventListener","useInterval","use_mouse","canvasEl","changeMat","changeDragging","zoomStart","changeZoomStart","zoomEnd","changeZoomEnd","layoutParams","mat","onMouseUp","dragging","useRef","prevMousePosition","zoomIn","direction","point","mx","my","scale","translate","scaleU","clone","_canvasEl$current$get","getBoundingClientRect","clientX","clientY","projMouse","applyToPoint","_layoutParams$current","iw","ih","preventDefault","specialEvent","_layoutParams$current2","Math","abs","_layoutParams$current3","min","newMat","Matrix","_layoutParams$current4","onWheel","deltaY","use_project_box","bbox","box","apply","toConsumableArray","points","max","_ref5","_ref6","_ref7","_ref8","sx","sy","_ref9","_ref10","_ref11","_ref12","_ref13","_ref14","_ref15","_ref16","Error","getEnclosingBox","cbox","inverse","Svg","& text","PointDistances","projectRegionBox","pointDistancePrecision","realSize","filter","r1","flatMap","i1","r2","i2","displayDistance","pr1","pr2","prm","unitName","sqrt","pow","RegionTags","onBeginRegionEdit","onCloseRegionEdit","labelBoxHeight","editingLabels","displayOnTop","coords","bottom","paddingBottom","obj","newObj","_len","args","Array","_key","_i","_args","copyWithout","src_RegionLabel","TransformGrabber","boxCursorMap","RegionSelectAndTransformBoxes","onBeginBoxTransform","onBeginMovePolygonPoint","onAddPolygonPoint","src_PreventScrollToParents","src_HighlightBox","px","py","proj","p1","p2","pa","SettingsContext","createContext","showCrosshairs","useSettings","useContext","SettingsProvider","settings","startsWith","replace","pullSettingsFromLocalStorage","changeState","Provider","changeSetting","setting","defineProperty","Video","StyledImage","VideoOrImageCanvasBackground","imagePosition","_ref$videoTime","videoTime","videoSrc","imageSrc","onLoad","videoPlaying","onChangeVideoPlaying","videoRef","imageRef","currentTime","renderLoopRunning","play","videoPlaybackSpeed","playbackRate","parseFloat","pause","checkForNewFrame","newVideoTime","floor","paused","requestAnimationFrame","onLoadedVideoMetadata","event","videoElm","currentTarget","naturalWidth","videoWidth","naturalHeight","videoHeight","duration","onImageLoaded","imageElm","stylePosition","bottomRight","topLeft","isNaN","ref","onLoadedMetadata","canvas","zoomIndicator","right","ImageCanvas","showTags","_ref$onMouseMove","p","_ref$onMouseDown","_ref$onMouseUp","_ref$dragWithPrimary","_ref$zoomWithPrimary","_ref$createWithPrimar","_ref$pointDistancePre","showPointDistances","allowedArea","_ref$videoPlaying","onImageOrVideoLoaded","_useRafState3","_useRafState4","maskImagesLoaded","changeMaskImagesLoaded","_useRafState5","_useRafState6","_useRafState7","_useRafState8","_useRafState9","_useRafState10","maskImages","windowSize","_useMouse","useMouse","useLayoutEffect","useProjectRegionBox","imageDimensions","changeImageDimensions","imageLoaded","onVideoOrImageLoaded","dims","excludePattern","Image","pattern","document","context","getContext","onload","createPattern","useExcludePattern","clientWidth","clientHeight","fitScale","canvasWidth","canvasHeight","save","toArray","globalAlpha","outer","inner","moveTo","forEach","lineTo","closePath","reverse","fillStyle","restore","lineWidth","shadowColor","shadowBlur","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_loop","beginPath","strokeStyle","arc","PI","strokeRect","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","Symbol","iterator","done","err","return","nodeName","drawImage","newCanvas","ctx","imgData","getImageData","data","_imgData$data$slice","slice","_imgData$data$slice2","g","b","black","clearRect","putImageData","_iterator","zoomBox","src_Crosshairs","src_RegionSelectAndTransformBoxes","src_RegionTags","src_PointDistances","Fragment","StyledButton","IconName","HeaderButtonContext","MemoizedHeaderButton","Icon","HeaderButton","onHeaderButtonClick","Header_styles","flexShrink","fileInfo","&.videoMode","flexMode","Tick","TickText","userSelect","PositionCursor","placeItems","fontVariantNumeric","&::before","borderLeft","borderRight","KeyframeMarker","_styled","borderTopLeftRadius","borderTopRightRadius","displayIntervalPairs","KeyframeTimeline","_ref4$currentTime","onChangeCurrentTime","_useMeasure","useMeasure","_useMeasure2","bounds","instantCurrentTime","changeInstantCurrentTime","draggingTime","changeDraggingTime","sort","_useMemo","_displayIntervalPairs","minor","major","getMajorInterval","_useMemo2","minorInterval","majorInterval","newTime","KeyframeTimeline_Container","range","kt","Header","inFullScreen","videoMode","_ref$nextVideoFrameHa","isAVideoFrame","nextVideoFrameHasRegions","videoDuration","multipleImages","headerActions","src_HeaderButton","BackIcon","NextIcon","QueuePlayNextIcon","PauseIcon","PlayIcon","SettingsIcon","FullscreenIcon","ExitIcon","SelectedTool","selected","togglable","_ref$alwaysShowing","alwaysShowing","_useContext","selectedTool","onClickTool","includes","Tooltip","placement","aria-label","iconTools","defaultTools","IconTools","_ref$enabledTools","selectedToolContextValue","src_SmallToolButton","index_es","fixedWidth","faMousePointer","faHandPaper","faSearch","faTag","faCrosshairs","faVectorSquare","faDrawPolygon","MainLayout_styles","&.fullscreen","workspace","iconToolsContainer","imageCanvasContainer","justifyContent","noImageSelected","sidebarContainer","SettingsDialog","Survey_default","noActions","defaultAnswers","onQuestionChange","q","answers","form","questions","defaultValue","choices","Fullscreen","props","react_full_screen_dist_default","get_active_image","pathToActiveImage","activeImage","currentImageIndex","annotationType","findIndex","frameTime","getIn","get_implied_video_regions","nextKeyframeTimeIndex","t1","prevKeyframe","t2","nextKeyframe","prevRegionMap","nextRegionMap","impliedRegions","w1","w2","regionId","push","pp","MainLayout","_Object$assign","nextImage","dispatch","memoizedActionFns","action","params","fnKey","join","fn","_len2","_key2","reduce","acc","_getActiveImage","getActiveImage","useKey","detectKeys","impliedVideoRegions","_state$currentVideoTi","getImpliedVideoRegions","useImpliedVideoRegions","src_Fullscreen","headerContainer","src_Header","videoName","src_IconTools","src_Sidebar","$ANNOTATE_DEBUG_MODE","src_SettingsDialog","settingsOpen","buttonName","typesToSaveWithHistory","BEGIN_BOX_TRANSFORM","BEGIN_MOVE_POINT","DELETE_REGION","saveToHistory","updateIn","toDate","without","getRandomId","random","split","getRandomColor","general_reducer","Date","now","lastMouseMoveCall","setIn","getRegionIndex","regionIndex","getRegion","modifyRegion","_getRegion","_getRegion2","unselectRegions","closeEditors","setNewImage","oldRegion","delta","_Object$keys","directions","freedom","original","polygon","pointIndex","splice","_state$mode","moveRegion","_state$mode2","_state$mode2$freedom","xFree","yFree","_state$mode2$original","ox","oy","ow","oh","dx","dw","dy","dh","_getRegion3","_getRegion4","newRegion","aa","editLabelEditorAfter","isNew","_getRegion5","_getRegion6","newRegions","toLowerCase","some","image_reducer","video_reducer","copyImpliedRegions","metadata","isPlaying","Annotator","_ref$selectedImage","_ref$showTags","_ref$regionTagList","_ref$regionClsList","_ref$keyframes","onExit","reducer","_useReducer","useReducer","reducers","_reducers","combineReducers","imageReducer","videoReducer","generalReducer","prevState","nextState","makeImmutable","_useReducer2","dispatchToReducer","src_SettingsProvider","src_MainLayout","ErrorBoundaryDialog","hasError","info","this","componentStack","Component","DemoSite","annotatorOpen","changeAnnotatorOpen","annotatorProps","changeAnnotatorProps","changeLastOutput","ErrorBoundaryDialog_ErrorBoundaryDialog","src_Annotator","output","DemoSite_Editor","RootContainer","ContentContainer","boxSizing","maxWidth","Hero","HeroMain","HeroSub","lineHeight","HeroButtons","Section","CodeBlock","prism","docco","flatten","child","React","Children","HeadingRenderer","slug","level","LandingPage","LandingPage_Header","LandingPage_HeaderButton","href","react_github_btn","data-size","data-show-count","escapeHtml","renderers","heading","ReactDOM","render","path","location","pathname","src_Theme","src_LandingPage","getElementById"],"mappings":"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","file":"static/js/main.f47c15de.chunk.js","sourcesContent":["// @flow\n\nimport React from \"react\"\nimport {\n  ThemeProvider,\n  createMuiTheme,\n  makeStyles\n} from \"@material-ui/core/styles\"\n\nconst useStyles = makeStyles({\n  container: {\n    fontFamily: '\"Inter\", sans-serif'\n  }\n})\n\nconst theme = createMuiTheme({\n  typography: {\n    fontFamily: '\"Inter\", \"Roboto\", sans-serif'\n  },\n  overrides: {\n    MuiButton: {\n      root: {\n        textTransform: \"none\"\n      }\n    }\n  }\n})\n\nexport const Theme = ({ children }: any) => {\n  const classes = useStyles()\n  return (\n    <ThemeProvider theme={theme}>\n      <div className={classes.container}>{children}</div>\n    </ThemeProvider>\n  )\n}\n\nexport default Theme\n","// @flow\n\nimport React, { useState } from \"react\"\nimport Button from \"@material-ui/core/Button\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport Select from \"react-select\"\nimport Code from \"react-syntax-highlighter\"\nimport Dialog from \"@material-ui/core/Dialog\"\nimport DialogTitle from \"@material-ui/core/DialogTitle\"\nimport DialogContent from \"@material-ui/core/DialogContent\"\nimport DialogActions from \"@material-ui/core/DialogActions\"\nimport MonacoEditor from \"react-monaco-editor\"\n\nconst useStyles = makeStyles({\n  editBar: {\n    padding: 10,\n    borderBottom: \"1px solid #ccc\",\n    backgroundColor: \"#f8f8f8\",\n    display: \"flex\",\n    alignItems: \"center\",\n    \"& .button\": { margin: 5 }\n  },\n  select: { width: 240, fontSize: 14 },\n  contentArea: {\n    padding: 10\n  },\n  specificationArea: {\n    padding: 10\n  }\n})\n\nconst loadSavedInput = () => {\n  try {\n    return JSON.parse(window.localStorage.getItem(\"customInput\") || \"{}\")\n  } catch (e) {\n    return {}\n  }\n}\n\nexport const examples = {\n  \"Simple Bounding Box\": () => ({\n    taskDescription:\n      \"Annotate each image according to this _markdown_ specification.\",\n    // regionTagList: [],\n    // regionClsList: [\"hotdog\"],\n    regionTagList: [\"has-bun\"],\n    regionClsList: [\"hotdog\", \"not-hotdog\"],\n    enabledTools: [\"select\", \"create-box\"],\n    // showTags: true,\n    images: [\n      {\n        src:\n          \"https://images.unsplash.com/photo-1496905583330-eb54c7e5915a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=634&q=80\",\n        name: \"hot-dogs-1\"\n      }\n    ]\n  }),\n  \"Simple Segmentation\": () => ({\n    taskDescription:\n      \"Annotate each image according to this _markdown_ specification.\",\n    regionClsList: [\"car\", \"truck\"],\n    enabledTools: [\"select\", \"create-polygon\"],\n    images: [\n      {\n        src:\n          \"https://images.unsplash.com/photo-1561518776-e76a5e48f731?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=750&q=80\",\n        name: \"car-image-1\"\n      }\n    ]\n  }),\n  Custom: () => loadSavedInput()\n}\n\nconst Editor = ({ onOpenAnnotator, lastOutput }: any) => {\n  const c = useStyles()\n  const [currentError, changeCurrentError] = useState()\n  const [selectedExample, changeSelectedExample] = useState(\n    window.localStorage.getItem(\"customInput\")\n      ? \"Custom\"\n      : \"Simple Bounding Box\"\n  )\n  const [outputDialogOpen, changeOutputOpen] = useState(false)\n  const [currentJSONValue, changeCurrentJSONValue] = useState(\n    JSON.stringify(examples[selectedExample](), null, \"  \")\n  )\n  return (\n    <div>\n      <div className={c.editBar}>\n        <h3>React Image Annotate</h3>\n        <div style={{ flexGrow: 1 }} />\n        <div>\n          <div style={{ display: \"inline-flex\" }}>\n            <Select\n              className={c.select}\n              value={{ label: selectedExample, value: selectedExample }}\n              options={Object.keys(examples).map(s => ({\n                label: s,\n                value: s\n              }))}\n              onChange={selectedOption => {\n                changeSelectedExample(selectedOption.value)\n\n                changeCurrentJSONValue(\n                  JSON.stringify(\n                    selectedOption.value === \"Custom\"\n                      ? loadSavedInput()\n                      : examples[selectedOption.value](),\n                    null,\n                    \"  \"\n                  )\n                )\n              }}\n            />\n          </div>\n          <Button\n            className=\"button\"\n            disabled={!lastOutput}\n            onClick={() => changeOutputOpen(true)}\n          >\n            View Output\n          </Button>\n          <Button\n            className=\"button\"\n            variant=\"outlined\"\n            disabled={Boolean(currentError)}\n            onClick={() =>\n              onOpenAnnotator(\n                selectedExample === \"Custom\"\n                  ? loadSavedInput()\n                  : examples[selectedExample]\n              )\n            }\n          >\n            Open Annotator\n          </Button>\n        </div>\n      </div>\n      <div\n        className={c.contentArea}\n        style={\n          currentError\n            ? { border: \"2px solid #f00\" }\n            : { border: \"2px solid #fff\" }\n        }\n      >\n        <div>\n          <MonacoEditor\n            value={currentJSONValue}\n            language=\"javascript\"\n            onChange={code => {\n              try {\n                window.localStorage.setItem(\n                  \"customInput\",\n                  JSON.stringify(JSON.parse(code))\n                )\n                changeCurrentError(null)\n              } catch (e) {\n                changeCurrentError(e.toString())\n              }\n              changeCurrentJSONValue(code)\n            }}\n            width=\"100%\"\n            height=\"550px\"\n          />\n        </div>\n      </div>\n      <div className={c.specificationArea}>\n        <h2>React Image Annotate Format</h2>\n        <Code language=\"javascript\">{`\n{\n  taskDescription?: string, // markdown\n  regionTagList?: Array<string>,\n  regionClsList?: Array<string>,\n  imageTagList?: Array<string>,\n  imageClsList?: Array<string>,\n  // all tools are enabled by default\n  enabledTools?: Array< \"select\" | \"create-point\" | \"create-box\" | \"create-polygon\">,\n  selectedImage?: string, // initial selected image\n  images: Array<{\n    src: string,\n    thumbnailSrc?: string, // use this if you are using high-res images\n    name: string,\n    regions?: Array<{\n      id: string | number,\n      cls?: string,\n      color?: string,\n      tags?: Array<string>,\n\n      // Point\n      type: \"point\",\n      x: number, // [0-1] % of image width\n      y: number, // [0-1] % of image height\n\n      // Bounding Box\n      type: \"box\",\n      x: number, // [0-1] % of image width\n      y: number, // [0-1] % of image height\n      w: number, // [0-1] % of image width\n      h: number, // [0-1] % of image height\n\n      // Polygon\n      type: \"polygon\",\n      open?: boolean, // should last and first points be connected, default: true\n      points: Array<[number, number]> // [0-1] % of image width/height\n    }>\n  }>,\n}\n`}</Code>\n      </div>\n      <Dialog fullScreen open={outputDialogOpen}>\n        <DialogTitle>React Image Annotate Output</DialogTitle>\n        <DialogContent style={{ minWidth: 400 }}>\n          <MonacoEditor\n            value={JSON.stringify(lastOutput, null, \"  \")}\n            language=\"javascript\"\n            width=\"100%\"\n            height=\"550px\"\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => changeOutputOpen(false)}>Close</Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  )\n}\n\nexport default Editor\n","// @flow\n\nimport React, { useState, memo } from \"react\"\nimport Paper from \"@material-ui/core/Paper\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport ExpandIcon from \"@material-ui/icons/ExpandMore\"\nimport IconButton from \"@material-ui/core/IconButton\"\nimport Collapse from \"@material-ui/core/Collapse\"\nimport { grey } from \"@material-ui/core/colors\"\nimport classnames from \"classnames\"\nimport useEventCallback from \"use-event-callback\"\n\nconst useStyles = makeStyles({\n  container: { margin: 8 },\n  header: {\n    display: \"flex\",\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: 8,\n    paddingLeft: 16,\n    paddingRight: 16\n  },\n  title: {\n    fontSize: 14,\n    fontWeight: \"bold\",\n    flexGrow: 1,\n    paddingLeft: 8,\n    color: grey[800],\n    \"& span\": {\n      color: grey[600],\n      fontSize: 12\n    }\n  },\n  expandButton: {\n    padding: 0,\n    width: 30,\n    height: 30,\n    \"& .icon\": {\n      marginTop: -6,\n      width: 20,\n      height: 20,\n      transition: \"500ms transform\",\n      \"&.expanded\": {\n        transform: \"rotate(180deg)\"\n      }\n    }\n  },\n  expandedContent: {\n    maxHeight: 300,\n    overflowY: \"auto\",\n    \"&.noScroll\": {\n      overflowY: \"visible\",\n      overflow: \"visible\"\n    }\n  }\n})\n\nexport const SidebarBoxContainer = ({\n  icon,\n  title,\n  subTitle,\n  children,\n  noScroll = false,\n  expandedByDefault = false\n}) => {\n  const classes = useStyles()\n  const content = (\n    <div\n      className={classnames(classes.expandedContent, noScroll && \"noScroll\")}\n    >\n      {children}\n    </div>\n  )\n\n  const [expanded, changeExpanded] = useState(expandedByDefault)\n  const toggleExpanded = useEventCallback(() => changeExpanded(!expanded))\n  return (\n    <Paper className={classes.container}>\n      <div className={classes.header}>\n        {icon}\n        <div className={classes.title}>\n          {title} <span>{subTitle}</span>\n        </div>\n        <IconButton onClick={toggleExpanded} className={classes.expandButton}>\n          <ExpandIcon className={classnames(\"icon\", expanded && \"expanded\")} />\n        </IconButton>\n      </div>\n      {noScroll ? (\n        expanded ? (\n          content\n        ) : null\n      ) : (\n        <Collapse in={expanded}>{content}</Collapse>\n      )}\n    </Paper>\n  )\n}\n\nexport default memo(\n  SidebarBoxContainer,\n  (prev, next) => prev.title === next.title && prev.children === next.children\n)\n","// @flow\n\nimport React, { memo } from \"react\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport DescriptionIcon from \"@material-ui/icons/Description\"\nimport { styled } from \"@material-ui/core/styles\"\nimport { grey } from \"@material-ui/core/colors\"\nimport Markdown from \"react-markdown\"\n\nconst MarkdownContainer = styled(\"div\")({\n  paddingLeft: 16,\n  paddingRight: 16,\n  fontSize: 12,\n  \"& h1\": { fontSize: 18 },\n  \"& h2\": { fontSize: 14 },\n  \"& h3\": { fontSize: 12 },\n  \"& h4\": { fontSize: 12 },\n  \"& h5\": { fontSize: 12 },\n  \"& h6\": { fontSize: 12 },\n  \"& p\": { fontSize: 12 },\n  \"& a\": {},\n  \"& img\": { width: \"100%\" }\n})\n\nexport const TaskDescriptionSidebarBox = ({ description }) => {\n  return (\n    <SidebarBoxContainer\n      title=\"Task Description\"\n      icon={<DescriptionIcon style={{ color: grey[700] }} />}\n      expandedByDefault\n    >\n      <MarkdownContainer>\n        <Markdown source={description} />\n      </MarkdownContainer>\n    </SidebarBoxContainer>\n  )\n}\n\nexport default memo(TaskDescriptionSidebarBox)\n","// @flow\n\nimport React, { memo } from \"react\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport CollectionsIcon from \"@material-ui/icons/Collections\"\nimport { grey } from \"@material-ui/core/colors\"\nimport List from \"@material-ui/core/List\"\nimport ListItem from \"@material-ui/core/ListItem\"\nimport ListItemText from \"@material-ui/core/ListItemText\"\nimport Avatar from \"@material-ui/core/Avatar\"\nimport isEqual from \"lodash/isEqual\"\n\nconst useStyles = makeStyles({\n  img: { width: 40, height: 40, borderRadius: 8 }\n})\n\nexport const ImageSelectorSidebarBox = ({ images, onSelect }) => {\n  const classes = useStyles()\n  return (\n    <SidebarBoxContainer\n      title=\"Images\"\n      subTitle={`(${images.length})`}\n      icon={<CollectionsIcon style={{ color: grey[700] }} />}\n    >\n      <div>\n        <List>\n          {images.map((img, i) => (\n            <ListItem button onClick={() => onSelect(img)} dense key={i}>\n              <img className={classes.img} src={img.src} />\n              <ListItemText\n                primary={img.name}\n                secondary={`${(img.regions || []).length} Labels`}\n              />\n            </ListItem>\n          ))}\n        </List>\n      </div>\n    </SidebarBoxContainer>\n  )\n}\n\nconst mapUsedImageProps = a => [a.name, (a.regions || []).length, a.src]\n\nexport default memo(ImageSelectorSidebarBox, (prevProps, nextProps) =>\n  isEqual(\n    prevProps.images.map(mapUsedImageProps),\n    nextProps.images.map(mapUsedImageProps)\n  )\n)\n","import { grey, blue, orange, purple } from \"@material-ui/core/colors\"\n\nexport default {\n  container: {\n    fontSize: 11,\n    fontWeight: \"bold\",\n    color: grey[700],\n    \"& .icon\": {\n      marginTop: 4,\n      width: 16,\n      height: 16\n    },\n    \"& .icon2\": {\n      opacity: 0.5,\n      width: 16,\n      height: 16,\n      transition: \"200ms opacity\",\n      \"&:hover\": {\n        cursor: \"pointer\",\n        opacity: 1\n      }\n    }\n  },\n  row: {\n    padding: 4,\n    cursor: \"pointer\",\n    \"&.header:hover\": {\n      backgroundColor: \"#fff\"\n    },\n    \"&.highlighted\": {\n      backgroundColor: blue[100]\n    },\n    \"&:hover\": {\n      backgroundColor: blue[50],\n      color: grey[800]\n    }\n  },\n  chip: {\n    display: \"flex\",\n    flexDirection: \"row\",\n    padding: 2,\n    borderRadius: 2,\n    paddingLeft: 4,\n    paddingRight: 4,\n    alignItems: \"center\",\n    \"& .color\": {\n      borderRadius: 5,\n      width: 10,\n      height: 10,\n      marginRight: 4\n    },\n    \"& .text\": {}\n  }\n}\n","// @flow\n\nimport React, { Fragment, useState, memo } from \"react\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport { makeStyles, styled } from \"@material-ui/core/styles\"\nimport { grey } from \"@material-ui/core/colors\"\nimport RegionIcon from \"@material-ui/icons/PictureInPicture\"\nimport Grid from \"@material-ui/core/Grid\"\nimport ReorderIcon from \"@material-ui/icons/SwapVert\"\nimport PieChartIcon from \"@material-ui/icons/PieChart\"\nimport TrashIcon from \"@material-ui/icons/Delete\"\nimport LockIcon from \"@material-ui/icons/Lock\"\nimport UnlockIcon from \"@material-ui/icons/LockOpen\"\nimport VisibleIcon from \"@material-ui/icons/Visibility\"\nimport VisibleOffIcon from \"@material-ui/icons/VisibilityOff\"\nimport styles from \"./styles\"\nimport classnames from \"classnames\"\nimport isEqual from \"lodash/isEqual\"\n\nconst useStyles = makeStyles(styles)\n\nconst HeaderSep = styled(\"div\")({\n  borderTop: `1px solid ${grey[200]}`,\n  marginTop: 2,\n  marginBottom: 2\n})\n\nconst Chip = ({ color, text }) => {\n  const classes = useStyles()\n  return (\n    <span className={classes.chip}>\n      <div className=\"color\" style={{ backgroundColor: color }} />\n      <div className=\"text\">{text}</div>\n    </span>\n  )\n}\n\nconst RowLayout = ({\n  header,\n  highlighted,\n  order,\n  classification,\n  area,\n  tags,\n  trash,\n  lock,\n  visible,\n  onClick\n}) => {\n  const classes = useStyles()\n  const [mouseOver, changeMouseOver] = useState(false)\n  return (\n    <div\n      onClick={onClick}\n      onMouseEnter={() => changeMouseOver(true)}\n      onMouseLeave={() => changeMouseOver(false)}\n      className={classnames(classes.row, { header, highlighted })}\n    >\n      <Grid container alignItems=\"center\">\n        <Grid item xs={2}>\n          <div style={{ textAlign: \"right\", paddingRight: 10 }}>{order}</div>\n        </Grid>\n        <Grid item xs={5}>\n          {classification}\n        </Grid>\n        <Grid item xs={2}>\n          <div style={{ textAlign: \"right\", paddingRight: 6 }}>{area}</div>\n        </Grid>\n        <Grid item xs={1}>\n          {trash}\n        </Grid>\n        <Grid item xs={1}>\n          {lock}\n        </Grid>\n        <Grid item xs={1}>\n          {visible}\n        </Grid>\n      </Grid>\n    </div>\n  )\n}\n\nconst RowHeader = () => {\n  return (\n    <RowLayout\n      header\n      highlighted={false}\n      order={<ReorderIcon className=\"icon\" />}\n      classification={<div style={{ paddingLeft: 10 }}>Class</div>}\n      area={<PieChartIcon className=\"icon\" />}\n      trash={<TrashIcon className=\"icon\" />}\n      lock={<LockIcon className=\"icon\" />}\n      visible={<VisibleIcon className=\"icon\" />}\n    />\n  )\n}\n\nconst MemoRowHeader = memo(RowHeader)\n\nconst Row = ({\n  region: r,\n  highlighted,\n  onSelectRegion,\n  onDeleteRegion,\n  onChangeRegion,\n  visible,\n  locked,\n  color,\n  cls,\n  index\n}) => {\n  return (\n    <RowLayout\n      header={false}\n      highlighted={highlighted}\n      onClick={() => onSelectRegion(r)}\n      order={`#${index + 1}`}\n      classification={<Chip text={cls || \"\"} color={color || \"#ddd\"} />}\n      area=\"\"\n      trash={<TrashIcon onClick={() => onDeleteRegion(r)} className=\"icon2\" />}\n      lock={\n        r.locked ? (\n          <LockIcon\n            onClick={() => onChangeRegion({ ...r, locked: false })}\n            className=\"icon2\"\n          />\n        ) : (\n          <UnlockIcon\n            onClick={() => onChangeRegion({ ...r, locked: true })}\n            className=\"icon2\"\n          />\n        )\n      }\n      visible={\n        r.visible || r.visible === undefined ? (\n          <VisibleIcon\n            onClick={() => onChangeRegion({ ...r, visible: false })}\n            className=\"icon2\"\n          />\n        ) : (\n          <VisibleOffIcon\n            onClick={() => onChangeRegion({ ...r, visible: true })}\n            className=\"icon2\"\n          />\n        )\n      }\n    />\n  )\n}\n\nconst MemoRow = memo(\n  Row,\n  (prevProps, nextProps) =>\n    prevProps.highlighted === nextProps.highlighted &&\n    prevProps.visible === nextProps.visible &&\n    prevProps.locked === nextProps.locked &&\n    prevProps.id === nextProps.id &&\n    prevProps.index === nextProps.index &&\n    prevProps.cls === nextProps.cls &&\n    prevProps.color === nextProps.color\n)\n\nexport const RegionSelectorSidebarBox = ({\n  regions,\n  onDeleteRegion,\n  onChangeRegion,\n  onSelectRegion\n}) => {\n  const classes = useStyles()\n  return (\n    <SidebarBoxContainer\n      title=\"Regions\"\n      subTitle=\"\"\n      icon={<RegionIcon style={{ color: grey[700] }} />}\n      expandedByDefault\n    >\n      <div className={classes.container}>\n        <MemoRowHeader />\n        <HeaderSep />\n        {regions.map((r, i) => (\n          <MemoRow\n            key={r.id}\n            {...r}\n            region={r}\n            index={i}\n            onSelectRegion={onSelectRegion}\n            onDeleteRegion={onDeleteRegion}\n            onChangeRegion={onChangeRegion}\n          />\n        ))}\n      </div>\n    </SidebarBoxContainer>\n  )\n}\n\nconst mapUsedRegionProperties = r => [\n  r.id,\n  r.color,\n  r.locked,\n  r.visible,\n  r.highlighted\n]\n\nexport default memo(RegionSelectorSidebarBox, (prevProps, nextProps) =>\n  isEqual(\n    prevProps.regions.map(mapUsedRegionProperties),\n    nextProps.regions.map(mapUsedRegionProperties)\n  )\n)\n","// @flow\n\nimport React, { setState, memo } from \"react\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport HistoryIcon from \"@material-ui/icons/History\"\nimport List from \"@material-ui/core/List\"\nimport ListItem from \"@material-ui/core/ListItem\"\nimport ListItemText from \"@material-ui/core/ListItemText\"\nimport IconButton from \"@material-ui/core/IconButton\"\nimport ListItemSecondaryAction from \"@material-ui/core/ListItemSecondaryAction\"\nimport UndoIcon from \"@material-ui/icons/Undo\"\nimport moment from \"moment\"\nimport { grey } from \"@material-ui/core/colors\"\nimport isEqual from \"lodash/isEqual\"\n\nconst useStyles = makeStyles({\n  emptyText: {\n    fontSize: 14,\n    fontWeight: \"bold\",\n    color: grey[500],\n    textAlign: \"center\",\n    padding: 20\n  }\n})\n\nexport const HistorySidebarBox = ({\n  history,\n  onRestoreHistory\n}: {\n  history: Array<{ name: string, time: Date }>\n}) => {\n  const classes = useStyles()\n\n  return (\n    <SidebarBoxContainer\n      title=\"History\"\n      icon={<HistoryIcon style={{ color: grey[700] }} />}\n      expandedByDefault\n    >\n      <List>\n        {history.length === 0 && (\n          <div className={classes.emptyText}>No History Yet</div>\n        )}\n        {history.map(({ name, time }, i) => (\n          <ListItem button dense key={i}>\n            <ListItemText\n              primary={name}\n              secondary={moment(time).format(\"LT\")}\n            />\n            {i === 0 && (\n              <ListItemSecondaryAction onClick={() => onRestoreHistory()}>\n                <IconButton>\n                  <UndoIcon />\n                </IconButton>\n              </ListItemSecondaryAction>\n            )}\n          </ListItem>\n        ))}\n      </List>\n    </SidebarBoxContainer>\n  )\n}\n\nexport default memo(HistorySidebarBox, (prevProps, nextProps) =>\n  isEqual(\n    prevProps.history.map(a => [a.name, a.time]),\n    nextProps.history.map(a => [a.name, a.time])\n  )\n)\n","// @flow\n\nimport React from \"react\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\n\nexport const DebugSidebarBox = ({ state, lastAction }: any) => {\n  const image = (state.images || []).find(\n    img => img.src === state.selectedImage\n  )\n  const region = image ? (image.regions || []).find(r => r.highlighted) : null\n\n  return (\n    <SidebarBoxContainer title=\"Debug\" icon={<span />} expandedByDefault>\n      <div style={{ padding: 4 }}>\n        <div>\n          <b>region</b>:\n        </div>\n        <pre>{JSON.stringify(region, null, \"  \")}</pre>\n        <div>\n          <b>lastAction</b>:\n        </div>\n        <pre>{JSON.stringify(lastAction, null, \"  \")}</pre>\n        <div>\n          <b>mode</b>:\n        </div>\n        <pre>{JSON.stringify(state.mode, null, \"  \")}</pre>\n        <div>\n          <b>frame:</b>\n        </div>\n        <pre>{JSON.stringify(state.selectedImageFrameTime, null, \"  \")}</pre>\n      </div>\n    </SidebarBoxContainer>\n  )\n}\n\nexport default DebugSidebarBox\n","// @flow\n\nimport React, { useMemo, memo } from \"react\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport StyleIcon from \"@material-ui/icons/Style\"\nimport { grey } from \"@material-ui/core/colors\"\nimport Select from \"react-select\"\nimport useEventCallback from \"use-event-callback\"\nimport { asMutable } from \"seamless-immutable\"\n\nconst useStyles = makeStyles({})\n\ntype Props = {\n  tags: Array<string>,\n  currentImage: { cls?: string, tags?: Array<string> },\n  imageClsList?: Array<string>,\n  imageTagList?: Array<string>,\n  onChangeImage: (Array<string>) => any\n}\n\nconst emptyArr = []\n\nexport const TagsSidebarBox = ({\n  currentImage,\n  imageClsList = emptyArr,\n  imageTagList = emptyArr,\n  onChangeImage\n}: Props) => {\n  if (!currentImage) return null\n  const { tags = [], cls = null } = currentImage\n  const onChangeClassification = useEventCallback(o =>\n    onChangeImage({ cls: o.value })\n  )\n  const onChangeTags = useEventCallback(o =>\n    onChangeImage({ tags: o.map(a => a.value) })\n  )\n  const selectValue = useMemo(() => (cls ? { value: cls, label: cls } : null), [\n    cls\n  ])\n  const memoImgClsList = useMemo(\n    () => asMutable(imageClsList.map(c => ({ value: c, label: c }))),\n    [imageClsList]\n  )\n  const memoImgTagList = useMemo(\n    () => asMutable(imageTagList.map(c => ({ value: c, label: c }))),\n    [imageTagList]\n  )\n  const memoCurrentTags = useMemo(\n    () => tags.map(r => ({ value: r, label: r })),\n    [tags]\n  )\n\n  return (\n    <SidebarBoxContainer\n      title=\"Image Tags\"\n      expandedByDefault\n      noScroll\n      icon={<StyleIcon style={{ color: grey[700] }} />}\n    >\n      {imageClsList.length > 0 && (\n        <div style={{ padding: 8 }}>\n          <Select\n            placeholder=\"Image Classification\"\n            onChange={onChangeClassification}\n            value={selectValue}\n            options={memoImgClsList}\n          />\n        </div>\n      )}\n      {imageTagList.length > 0 && (\n        <div style={{ padding: 8, paddingTop: 0 }}>\n          <Select\n            isMulti\n            placeholder=\"Image Tags\"\n            onChange={onChangeTags}\n            value={memoCurrentTags}\n            options={memoImgTagList}\n          />\n        </div>\n      )}\n    </SidebarBoxContainer>\n  )\n}\n\nexport default memo(\n  TagsSidebarBox,\n  (prevProps, nextProps) =>\n    prevProps.currentImage.cls === nextProps.currentImage.cls &&\n    prevProps.currentImage.tags === nextProps.currentImage.tags &&\n    prevProps.imageClsList === nextProps.imageClsList &&\n    prevProps.imageTagList === nextProps.imageTagList\n)\n","// @flow\n\nconst getTimeString = (ms, precision = 1) => {\n  if (ms < 1000) {\n    return ms + \"ms\"\n  } else {\n    const secs = ms / 1000\n    if (secs < 60) {\n      if (Number.isInteger(secs)) {\n        return secs + \"s\"\n      } else {\n        return secs.toFixed(precision) + \"s\"\n      }\n    } else {\n      const mins = secs / 60\n      if (Number.isInteger(mins)) {\n        return mins + \"m\"\n      } else {\n        return mins.toFixed(precision) + \"m\"\n      }\n    }\n  }\n}\n\nexport default getTimeString\n","// @flow weak\n\nimport React from \"react\"\nimport AddLocationIcon from \"@material-ui/icons/AddLocation\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport * as colors from \"@material-ui/core/colors\"\nimport getTimeString from \"../KeyframeTimeline/get-time-string.js\"\nimport TrashIcon from \"@material-ui/icons/Delete\"\nimport { styled } from \"@material-ui/core/styles\"\n\nconst KeyframeRow = styled(\"div\")({\n  cursor: \"pointer\",\n  display: \"flex\",\n  alignItems: \"center\",\n  padding: 8,\n  fontSize: 14,\n  color: colors.grey[700],\n  \"&.current\": {\n    backgroundColor: colors.blue[100]\n  },\n  \"&:hover\": {\n    backgroundColor: colors.grey[100]\n  },\n  \"& .time\": {\n    flexGrow: 1,\n    fontWeight: \"bold\",\n    \"& .regionCount\": {\n      marginLeft: 8,\n      fontWeight: \"normal\",\n      color: colors.grey[500]\n    }\n  },\n  \"& .trash\": {\n    \"& .icon\": {\n      fontSize: 18,\n      color: colors.grey[600],\n      transition: \"transform 80ms\",\n      \"&:hover\": {\n        color: colors.grey[800],\n        transform: \"scale(1.25,1.25)\"\n      }\n    }\n  }\n})\n\nconst KeyframesSelector = ({\n  currentVideoTime,\n  keyframes,\n  onChangeVideoTime,\n  onDeleteKeyframe\n}) => {\n  const keyframeTimes = Object.keys(keyframes).map(t => parseInt(t))\n  return (\n    <SidebarBoxContainer\n      title=\"Keyframes\"\n      subTitle=\"\"\n      icon={<AddLocationIcon style={{ color: colors.grey[700] }} />}\n      expandedByDefault\n    >\n      {keyframeTimes.map(t => (\n        <KeyframeRow\n          fullWidth\n          key={t}\n          className={currentVideoTime === t ? \"current\" : \"\"}\n          onClick={() => onChangeVideoTime(t)}\n        >\n          <div className=\"time\">\n            {getTimeString(t, 2)}\n            <span className=\"regionCount\">\n              ({(keyframes[t].regions || []).length})\n            </span>\n          </div>\n          <div className=\"trash\">\n            <TrashIcon\n              onClick={e => {\n                onDeleteKeyframe(t)\n                e.stopPropagation()\n              }}\n              className=\"icon\"\n            />\n          </div>\n        </KeyframeRow>\n      ))}\n    </SidebarBoxContainer>\n  )\n}\n\nexport default KeyframesSelector\n","// @flow\n\nimport React from \"react\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport TaskDescription from \"../TaskDescriptionSidebarBox\"\nimport ImageSelector from \"../ImageSelectorSidebarBox\"\nimport RegionSelector from \"../RegionSelectorSidebarBox\"\nimport History from \"../HistorySidebarBox\"\nimport DebugBox from \"../DebugSidebarBox\"\nimport TagsSidebarBox from \"../TagsSidebarBox\"\nimport KeyframesSelector from \"../KeyframesSelectorSidebarBox\"\nimport type { Region } from \"../ImageCanvas/region-tools.js\"\n\nconst useStyles = makeStyles({})\n\ntype Image = {\n  name: string,\n  src: string,\n  cls?: string,\n  tags?: Array<string>,\n  thumbnailSrc?: string,\n  regions?: Array<Region>\n}\n\ntype Props = {\n  debug: any,\n  taskDescription: string,\n  images?: Array<Image>,\n  regions: Array<Region>,\n  history: Array<{ state: Object, name: string, time: Date }>,\n\n  labelImages?: boolean,\n  currentImage?: Image,\n  imageClsList?: Array<string>,\n  imageTagList?: Array<string>,\n\n  onChangeImage: Image => any,\n  onSelectRegion: Region => any,\n  onSelectImage: Image => any,\n  onChangeRegion: Region => any,\n  onDeleteRegion: Region => any,\n  onRestoreHistory: () => any\n}\n\nconst emptyArr = []\n\nexport const Sidebar = ({\n  debug,\n  taskDescription,\n  keyframes,\n  images,\n  regions,\n  history,\n  labelImages,\n  currentImage,\n  currentVideoTime,\n  imageClsList,\n  imageTagList,\n  onChangeImage,\n  onSelectRegion,\n  onSelectImage,\n  onChangeRegion,\n  onDeleteRegion,\n  onRestoreHistory,\n  onChangeVideoTime,\n  onDeleteKeyframe\n}: Props) => {\n  const classes = useStyles()\n\n  if (!regions) regions = emptyArr\n\n  return (\n    <div>\n      {debug && <DebugBox state={debug} lastAction={debug.lastAction} />}\n      {(taskDescription || \"\").length > 1 && (\n        <TaskDescription description={taskDescription} />\n      )}\n      {labelImages && (\n        <TagsSidebarBox\n          currentImage={currentImage}\n          imageClsList={imageClsList}\n          imageTagList={imageTagList}\n          onChangeImage={onChangeImage}\n          expandedByDefault\n        />\n      )}\n      {images && images.length > 1 && (\n        <ImageSelector onSelect={onSelectImage} images={images} />\n      )}\n      <RegionSelector\n        regions={regions}\n        onSelectRegion={onSelectRegion}\n        onChangeRegion={onChangeRegion}\n        onDeleteRegion={onDeleteRegion}\n      />\n      {keyframes && (\n        <KeyframesSelector\n          currentVideoTime={currentVideoTime}\n          keyframes={keyframes}\n          onChangeVideoTime={onChangeVideoTime}\n          onDeleteKeyframe={onDeleteKeyframe}\n        />\n      )}\n      <History history={history} onRestoreHistory={onRestoreHistory} />\n    </div>\n  )\n}\n\nexport default Sidebar\n","// @flow\n\nimport React, { Fragment, useEffect, useState } from \"react\"\n\nexport const Crosshairs = ({\n  mousePosition,\n  x,\n  y\n}: {\n  mousePosition: { current: { x: number, y: number } },\n  x?: number,\n  y?: number\n}) => {\n  const [forceRenderState, changeForceRenderState] = useState()\n\n  if (mousePosition) {\n    x = mousePosition.current.x\n    y = mousePosition.current.y\n  }\n\n  useEffect(() => {\n    if (!mousePosition) return\n    const interval = setInterval(() => {\n      if (x !== mousePosition.current.x || y !== mousePosition.current.y) {\n        changeForceRenderState([\n          mousePosition.current.x,\n          mousePosition.current.y\n        ])\n      }\n    }, 10)\n    return () => clearInterval(interval)\n  })\n\n  return (\n    <Fragment>\n      <div\n        style={{\n          position: \"absolute\",\n          height: \"100%\",\n          width: 1,\n          zIndex: 10,\n          backgroundColor: \"#f00\",\n          left: x,\n          pointerEvents: \"none\",\n          top: 0\n        }}\n      />\n      <div\n        style={{\n          position: \"absolute\",\n          width: \"100%\",\n          zIndex: 10,\n          height: 1,\n          backgroundColor: \"#f00\",\n          top: y,\n          pointerEvents: \"none\",\n          left: 0\n        }}\n      />\n    </Fragment>\n  )\n}\n\nexport default Crosshairs\n","// @flow\n\nimport { grey } from \"@material-ui/core/colors\"\n\nexport default {\n  regionInfo: {\n    fontSize: 12,\n    cursor: \"default\",\n    transition: \"opacity 200ms\",\n    opacity: 0.7,\n    \"&:hover\": {\n      opacity: 0.9,\n      cursor: \"pointer\"\n    },\n    \"&.highlighted\": {\n      opacity: 0.9,\n      \"&:hover\": {\n        opacity: 1\n      }\n    },\n    // pointerEvents: \"none\",\n    fontWeight: 600,\n    color: grey[900],\n    padding: 8,\n    \"& .name\": {\n      display: \"flex\",\n      flexDirection: \"row\",\n      alignItems: \"center\",\n      \"& .circle\": {\n        marginRight: 4,\n        boxShadow: \"0px 0px 2px rgba(0,0,0,0.4)\",\n        width: 10,\n        height: 10,\n        borderRadius: 5\n      }\n    },\n    \"& .tags\": {\n      \"& .tag\": {\n        color: grey[700],\n        display: \"inline-block\",\n        margin: 1,\n        fontSize: 10,\n        textDecoration: \"underline\"\n      }\n    }\n  }\n}\n","// @flow\n\nimport React, { useState, memo } from \"react\"\nimport Paper from \"@material-ui/core/Paper\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport styles from \"./styles\"\nimport classnames from \"classnames\"\nimport type { Region } from \"../ImageCanvas/region-tools.js\"\nimport IconButton from \"@material-ui/core/IconButton\"\nimport Button from \"@material-ui/core/Button\"\nimport TrashIcon from \"@material-ui/icons/Delete\"\nimport CheckIcon from \"@material-ui/icons/Check\"\nimport UndoIcon from \"@material-ui/icons/Undo\"\nimport Select from \"react-select\"\nimport { asMutable } from \"seamless-immutable\"\n\nconst useStyles = makeStyles(styles)\n\ntype Props = {\n  region: Region,\n  editing?: boolean,\n  allowedClasses?: Array<string>,\n  allowedTags?: Array<string>,\n  cls?: string,\n  tags?: Array<string>,\n  onDelete: Region => null,\n  onChange: Region => null,\n  onClose: Region => null,\n  onOpen: Region => null\n}\n\nexport const RegionLabel = ({\n  region,\n  editing,\n  allowedClasses,\n  allowedTags,\n  onDelete,\n  onChange,\n  onClose,\n  onOpen\n}: Props) => {\n  const classes = useStyles()\n\n  return (\n    <Paper\n      onClick={() => (!editing ? onOpen(region) : null)}\n      className={classnames(classes.regionInfo, {\n        highlighted: region.highlighted\n      })}\n    >\n      {!editing ? (\n        <div>\n          {region.cls && (\n            <div className=\"name\">\n              <div\n                className=\"circle\"\n                style={{ backgroundColor: region.color }}\n              />\n              {region.cls}\n            </div>\n          )}\n          {region.tags && (\n            <div className=\"tags\">\n              {region.tags.map(t => (\n                <div key={t} className=\"tag\">\n                  {t}\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      ) : (\n        <div style={{ width: 200 }}>\n          <div style={{ display: \"flex\", flexDirection: \"row\" }}>\n            <div\n              style={{\n                display: \"flex\",\n                backgroundColor: region.color,\n                color: \"#fff\",\n                padding: 4,\n                paddingLeft: 8,\n                paddingRight: 8,\n                borderRadius: 4,\n                fontWeight: \"bold\",\n                textShadow: \"0px 0px 5px rgba(0,0,0,0.4)\"\n              }}\n            >\n              {region.type}\n            </div>\n            <div style={{ flexGrow: 1 }} />\n            <IconButton\n              onClick={() => onDelete(region)}\n              tabIndex={-1}\n              style={{ width: 22, height: 22 }}\n              size=\"small\"\n              variant=\"outlined\"\n            >\n              <TrashIcon style={{ marginTop: -8, width: 16, height: 16 }} />\n            </IconButton>\n          </div>\n          {(allowedClasses || []).length > 0 && (\n            <div style={{ marginTop: 6 }}>\n              <Select\n                placeholder=\"Classification\"\n                onChange={o =>\n                  onChange({\n                    ...(region: any),\n                    cls: o.value\n                  })\n                }\n                value={\n                  region.cls ? { label: region.cls, value: region.cls } : null\n                }\n                options={asMutable(\n                  allowedClasses.map(c => ({ value: c, label: c }))\n                )}\n              />\n            </div>\n          )}\n          {(allowedTags || []).length > 0 && (\n            <div style={{ marginTop: 4 }}>\n              <Select\n                onChange={newTags =>\n                  onChange({\n                    ...(region: any),\n                    tags: newTags.map(t => t.value)\n                  })\n                }\n                placeholder=\"Tags\"\n                value={(region.tags || []).map(c => ({ label: c, value: c }))}\n                isMulti\n                options={asMutable(\n                  allowedTags.map(c => ({ value: c, label: c }))\n                )}\n              />\n            </div>\n          )}\n          <div style={{ marginTop: 4, display: \"flex\" }}>\n            <div style={{ flexGrow: 1 }} />\n            <Button\n              onClick={() => onClose(region)}\n              size=\"small\"\n              variant=\"contained\"\n              color=\"primary\"\n            >\n              <CheckIcon />\n            </Button>\n          </div>\n        </div>\n      )}\n    </Paper>\n  )\n}\n\nexport default memo(\n  RegionLabel,\n  (prevProps, nextProps) =>\n    prevProps.editing === nextProps.editing &&\n    prevProps.region.x === nextProps.region.x &&\n    prevProps.region.y === nextProps.region.y &&\n    prevProps.region.tags === nextProps.region.tags &&\n    prevProps.region.cls === nextProps.region.cls &&\n    prevProps.region.color === nextProps.region.color &&\n    prevProps.region.highlighted === nextProps.region.highlighted\n)\n","// @flow\n\nimport React from \"react\"\nimport classnames from \"classnames\"\nimport { makeStyles } from \"@material-ui/core/styles\"\n\nconst useStyles = makeStyles({\n  \"@keyframes borderDance\": {\n    from: { strokeDashoffset: 0 },\n    to: { strokeDashoffset: 100 }\n  },\n  highlightBox: {\n    zIndex: 2,\n    transition: \"opacity 500ms\",\n    \"&.highlighted\": {\n      zIndex: 3\n    },\n    \"&:not(.highlighted)\": {\n      opacity: 0\n    },\n    \"&:not(.highlighted):hover\": {\n      opacity: 0.6\n    },\n    \"& path\": {\n      vectorEffect: \"non-scaling-stroke\",\n      strokeWidth: 2,\n      stroke: \"#FFF\",\n      fill: \"none\",\n      strokeDasharray: 5,\n      animationName: \"$borderDance\",\n      animationDuration: \"4s\",\n      animationTimingFunction: \"linear\",\n      animationIterationCount: \"infinite\",\n      animationPlayState: \"running\"\n    }\n  }\n})\n\nexport const HighlightBox = ({\n  mouseEvents,\n  dragWithPrimary,\n  zoomWithPrimary,\n  createWithPrimary,\n  onBeginMovePoint,\n  onSelectRegion,\n  region: r,\n  pbox\n}: {\n  mouseEvents: any,\n  dragWithPrimary: boolean,\n  zoomWithPrimary: boolean,\n  createWithPrimary: boolean,\n  onBeginMovePoint: Function,\n  onSelectRegion: Function,\n  region: any,\n  pbox: { x: number, y: number, w: number, h: number }\n}) => {\n  const classes = useStyles()\n  return (\n    <svg\n      key={r.id}\n      className={classnames(classes.highlightBox, {\n        highlighted: r.highlighted\n      })}\n      {...mouseEvents}\n      {...(!zoomWithPrimary && !dragWithPrimary\n        ? {\n            onMouseDown: e => {\n              if (\n                !r.locked &&\n                r.type === \"point\" &&\n                r.highlighted &&\n                e.button === 0\n              ) {\n                return onBeginMovePoint(r)\n              }\n              if (e.button === 0 && !createWithPrimary) return onSelectRegion(r)\n              mouseEvents.onMouseDown(e)\n            }\n          }\n        : {})}\n      style={{\n        ...(r.highlighted\n          ? {\n              pointerEvents: r.type !== \"point\" ? \"none\" : undefined,\n              cursor: \"grab\"\n            }\n          : {\n              cursor: !(zoomWithPrimary || dragWithPrimary || createWithPrimary)\n                ? \"pointer\"\n                : undefined,\n              pointerEvents:\n                zoomWithPrimary ||\n                dragWithPrimary ||\n                (createWithPrimary && !r.highlighted)\n                  ? \"none\"\n                  : undefined\n            }),\n        position: \"absolute\",\n        left: pbox.x - 5,\n        top: pbox.y - 5,\n        width: pbox.w + 10,\n        height: pbox.h + 10\n      }}\n    >\n      <path\n        d={`M5,5 L${pbox.w + 5},5 L${pbox.w + 5},${pbox.h + 5} L5,${pbox.h +\n          5} Z`}\n      />\n    </svg>\n  )\n}\n\nexport default HighlightBox\n","// @flow\n\nimport React, { useState } from \"react\"\nimport { RemoveScroll } from \"react-remove-scroll\"\nimport { styled } from \"@material-ui/core/styles\"\nimport useEventCallback from \"use-event-callback\"\n\nconst Container = styled(\"div\")({\n  \"& > div\": {\n    width: \"100%\",\n    height: \"100%\"\n  }\n})\n\nexport const PreventScrollToParents = ({ children, ...otherProps }) => {\n  const [mouseOver, changeMouseOver] = useState(false)\n  const onMouseMove = useEventCallback(e => {\n    if (!mouseOver) changeMouseOver(true)\n    if (otherProps.onMouseMove) {\n      otherProps.onMouseMove(e)\n    }\n  })\n  const onMouseLeave = useEventCallback(e => {\n    setTimeout(() => {\n      if (mouseOver) {\n        changeMouseOver(false)\n      }\n    }, 100)\n  })\n\n  return (\n    <Container\n      {...otherProps}\n      onMouseMove={onMouseMove}\n      onMouseLeave={onMouseLeave}\n    >\n      <RemoveScroll enabled={mouseOver} removeScrollBar={false}>\n        {children}\n      </RemoveScroll>\n    </Container>\n  )\n}\n\nexport default PreventScrollToParents\n","// @flow\n\nimport { useEffect } from \"react\"\n\nimport { useRafState, useInterval } from \"react-use\"\n\nconst useWindowSize = (initialWidth = Infinity, initialHeight = Infinity) => {\n  const isClient = typeof window !== \"undefined\"\n  const [state, setState] = useRafState({\n    width: isClient ? window.innerWidth : initialWidth,\n    height: isClient ? window.innerHeight : initialHeight\n  })\n\n  useEffect(() => {\n    if (!isClient) return\n    const handler = () => {\n      setState({\n        width: window.innerWidth,\n        height: window.innerHeight\n      })\n    }\n\n    window.addEventListener(\"resize\", handler)\n\n    return () => {\n      window.removeEventListener(\"resize\", handler)\n    }\n  }, [])\n\n  useInterval(() => {\n    if (!isClient) return\n    if (\n      window.innerWidth !== state.width ||\n      window.innerHeight !== state.height\n    ) {\n      setState({\n        width: window.innerWidth,\n        height: window.innerHeight\n      })\n    }\n  }, 100)\n\n  return state\n}\n\nexport default useWindowSize\n","// @flow weak\n\nimport { useRef } from \"react\"\nimport { Matrix } from \"transformation-matrix-js\"\n\nconst getDefaultMat = () => Matrix.from(1, 0, 0, 1, -10, -10)\n\nexport default ({\n  canvasEl,\n  changeMat,\n  changeDragging,\n  zoomStart,\n  zoomEnd,\n  changeZoomStart,\n  changeZoomEnd,\n  layoutParams,\n  zoomWithPrimary,\n  dragWithPrimary,\n  mat,\n  onMouseMove,\n  onMouseUp,\n  onMouseDown,\n  dragging\n}) => {\n  const mousePosition = useRef({ x: 0, y: 0 })\n  const prevMousePosition = useRef({ x: 0, y: 0 })\n\n  const zoomIn = (direction, point) => {\n    const [mx, my] = [point.x, point.y]\n    let scale =\n      typeof direction === \"object\" ? direction.to / mat.a : 1 + 0.2 * direction\n\n    // NOTE: We're mutating mat here\n    mat.translate(mx, my).scaleU(scale)\n    if (mat.a > 2) mat.scaleU(2 / mat.a)\n    if (mat.a < 0.1) mat.scaleU(0.1 / mat.a)\n    mat.translate(-mx, -my)\n\n    changeMat(mat.clone())\n  }\n\n  const mouseEvents = {\n    onMouseMove: e => {\n      const { left, top } = canvasEl.current.getBoundingClientRect()\n      prevMousePosition.current.x = mousePosition.current.x\n      prevMousePosition.current.y = mousePosition.current.y\n      mousePosition.current.x = e.clientX - left\n      mousePosition.current.y = e.clientY - top\n\n      const projMouse = mat.applyToPoint(\n        mousePosition.current.x,\n        mousePosition.current.y\n      )\n\n      if (zoomWithPrimary && zoomStart) {\n        changeZoomEnd(projMouse)\n      }\n\n      const { iw, ih } = layoutParams.current\n      onMouseMove({ x: projMouse.x / iw, y: projMouse.y / ih })\n\n      if (dragging) {\n        mat.translate(\n          prevMousePosition.current.x - mousePosition.current.x,\n          prevMousePosition.current.y - mousePosition.current.y\n        )\n\n        changeMat(mat.clone())\n      }\n      e.preventDefault()\n    },\n    onMouseDown: (e, specialEvent = {}) => {\n      e.preventDefault()\n\n      if (e.button === 1 || (e.button === 0 && dragWithPrimary))\n        return changeDragging(true)\n\n      const projMouse = mat.applyToPoint(\n        mousePosition.current.x,\n        mousePosition.current.y\n      )\n      if (zoomWithPrimary && e.button === 0) {\n        changeZoomStart(projMouse)\n        changeZoomEnd(projMouse)\n        return\n      }\n      if (e.button === 0) {\n        if (specialEvent.type === \"resize-box\") {\n          // onResizeBox()\n        }\n        if (specialEvent.type === \"move-region\") {\n          // onResizeBox()\n        }\n        const { iw, ih } = layoutParams.current\n        onMouseDown({ x: projMouse.x / iw, y: projMouse.y / ih })\n      }\n    },\n    onMouseUp: e => {\n      e.preventDefault()\n      const projMouse = mat.applyToPoint(\n        mousePosition.current.x,\n        mousePosition.current.y\n      )\n      if (zoomStart) {\n        const zoomEnd = projMouse\n        if (\n          Math.abs(zoomStart.x - zoomEnd.x) < 10 &&\n          Math.abs(zoomStart.y - zoomEnd.y) < 10\n        ) {\n          if (mat.a < 1) {\n            zoomIn({ to: 1 }, mousePosition.current)\n          } else {\n            zoomIn({ to: 0.25 }, mousePosition.current)\n          }\n        } else {\n          const { iw, ih } = layoutParams.current\n\n          if (zoomStart.x > zoomEnd.x) {\n            ;[zoomStart.x, zoomEnd.x] = [zoomEnd.x, zoomStart.x]\n          }\n          if (zoomStart.y > zoomEnd.y) {\n            ;[zoomStart.y, zoomEnd.y] = [zoomEnd.y, zoomStart.y]\n          }\n\n          // The region defined by zoomStart and zoomEnd should be the new transform\n          let scale = Math.min(\n            (zoomEnd.x - zoomStart.x) / iw,\n            (zoomEnd.y - zoomStart.y) / ih\n          )\n          if (scale < 0.1) scale = 0.1\n          if (scale > 10) scale = 10\n\n          const newMat = getDefaultMat()\n            .translate(zoomStart.x, zoomStart.y)\n            .scaleU(scale)\n\n          changeMat(newMat.clone())\n        }\n\n        changeZoomStart(null)\n        changeZoomEnd(null)\n      }\n      if (e.button === 1 || (e.button === 0 && dragWithPrimary))\n        return changeDragging(false)\n      if (e.button === 0) {\n        const { iw, ih } = layoutParams.current\n        onMouseUp({ x: projMouse.x / iw, y: projMouse.y / ih })\n      }\n    },\n    onWheel: e => {\n      const direction = e.deltaY > 0 ? 1 : e.deltaY < 0 ? -1 : 0\n      zoomIn(direction, mousePosition.current)\n      // e.preventDefault()\n    }\n  }\n  return { mouseEvents, mousePosition }\n}\n","// @flow weak\nimport useEventCallback from \"use-event-callback\"\nimport { getEnclosingBox } from \"./region-tools.js\"\n\nexport default ({ layoutParams, mat }) => {\n  return useEventCallback(r => {\n    const { iw, ih } = layoutParams.current\n    const bbox = getEnclosingBox(r)\n    const margin = r.type === \"point\" ? 15 : 2\n    const cbox = {\n      x: bbox.x * iw - margin,\n      y: bbox.y * ih - margin,\n      w: bbox.w * iw + margin * 2,\n      h: bbox.h * ih + margin * 2\n    }\n    const pbox = {\n      ...mat\n        .clone()\n        .inverse()\n        .applyToPoint(cbox.x, cbox.y),\n      w: cbox.w / mat.a,\n      h: cbox.h / mat.d\n    }\n    return pbox\n  })\n}\n","// @flow\n\nexport type BaseRegion = {\n  id: string | number,\n  cls?: string,\n  locked?: boolean,\n  visible?: boolean,\n  color: string,\n  editingLabels?: boolean,\n  highlighted?: boolean,\n  tags?: Array<string>\n}\n\nexport type Point = {|\n  ...$Exact<BaseRegion>,\n  type: \"point\",\n  x: number,\n  y: number\n|}\n\nexport type PixelRegion =\n  | {|\n      ...$Exact<BaseRegion>,\n      type: \"pixel\",\n      sx: number,\n      sy: number,\n      w: number,\n      h: number,\n      src: string\n    |}\n  | {|\n      ...$Exact<BaseRegion>,\n      type: \"pixel\",\n      points: Array<[number, number]>\n    |}\nexport type Box = {|\n  ...$Exact<BaseRegion>,\n  type: \"box\",\n  x: number,\n  y: number,\n  w: number,\n  h: number\n|}\nexport type Polygon = {|\n  ...$Exact<BaseRegion>,\n  type: \"polygon\",\n  open?: boolean,\n  points: Array<[number, number]>\n|}\n\nexport type Region = Point | PixelRegion | Box | Polygon\n\nexport const getEnclosingBox = (region: Region) => {\n  switch (region.type) {\n    case \"polygon\": {\n      const box = {\n        x: Math.min(...region.points.map(([x, y]) => x)),\n        y: Math.min(...region.points.map(([x, y]) => y)),\n        w: 0,\n        h: 0\n      }\n      box.w = Math.max(...region.points.map(([x, y]) => x)) - box.x\n      box.h = Math.max(...region.points.map(([x, y]) => y)) - box.y\n      return box\n    }\n    case \"box\": {\n      return { x: region.x, y: region.y, w: region.w, h: region.h }\n    }\n    case \"point\": {\n      return { x: region.x, y: region.y, w: 0, h: 0 }\n    }\n    case \"pixel\": {\n      if (\n        region.sx !== undefined &&\n        region.sy !== undefined &&\n        region.w &&\n        region.h\n      ) {\n        return { x: region.sx, y: region.sy, w: region.w, h: region.h }\n      }\n      if (region.points) {\n        const box = {\n          x: Math.min(...region.points.map(([x, y]) => x)),\n          y: Math.min(...region.points.map(([x, y]) => y)),\n          w: 0,\n          h: 0\n        }\n        box.w = Math.max(...region.points.map(([x, y]) => x)) - box.x\n        box.h = Math.max(...region.points.map(([x, y]) => y)) - box.y\n        return box\n      }\n    }\n  }\n  throw new Error(\"unknown region\")\n}\n\nexport const moveRegion = (region: Region, x: number, y: number) => {\n  switch (region.type) {\n    case \"point\": {\n      return { ...region, x, y }\n    }\n    case \"box\": {\n      return { ...region, x: x - region.w / 2, y: y - region.h / 2 }\n    }\n  }\n  return region\n}\n","// @flow weak\n\nimport React, { Fragment } from \"react\"\nimport { styled } from \"@material-ui/core/styles\"\n\nconst Svg = styled(\"svg\")({\n  pointerEvents: \"none\",\n  position: \"absolute\",\n  zIndex: 1,\n  left: 0,\n  top: 0,\n  width: \"100%\",\n  height: \"100%\",\n  \"& text\": {\n    fill: \"#fff\"\n  },\n  \"& path\": {\n    vectorEffect: \"non-scaling-stroke\",\n    strokeWidth: 2,\n    opacity: 0.5,\n    stroke: \"#FFF\",\n    fill: \"none\",\n    strokeDasharray: 5,\n    animationDuration: \"4s\",\n    animationTimingFunction: \"linear\",\n    animationIterationCount: \"infinite\",\n    animationPlayState: \"running\"\n  }\n})\n\nexport const PointDistances = ({\n  projectRegionBox,\n  regions,\n  pointDistancePrecision,\n  realSize\n}) => {\n  return (\n    <Svg>\n      {regions\n        .filter(r1 => r1.type === \"point\")\n        .flatMap((r1, i1) =>\n          regions\n            .filter((r2, i2) => i2 > i1)\n            .filter(r2 => r2.type === \"point\")\n            .map(r2 => {\n              const pr1 = projectRegionBox(r1)\n              const pr2 = projectRegionBox(r2)\n              const prm = {\n                x: (pr1.x + pr1.w / 2 + pr2.x + pr2.w / 2) / 2,\n                y: (pr1.y + pr1.h / 2 + pr2.y + pr2.h / 2) / 2\n              }\n              let displayDistance\n              if (realSize) {\n                const { w, h, unitName } = realSize\n                displayDistance =\n                  Math.sqrt(\n                    Math.pow(r1.x * w - r2.x * w, 2) +\n                      Math.pow(r1.y * h - r2.y * h, 2)\n                  ).toFixed(pointDistancePrecision) + unitName\n              } else {\n                displayDistance =\n                  (\n                    Math.sqrt(\n                      Math.pow(r1.x - r2.x, 2) + Math.pow(r1.y - r2.y, 2)\n                    ) * 100\n                  ).toFixed(pointDistancePrecision) + \"%\"\n              }\n              return (\n                <Fragment>\n                  <path\n                    d={`M${pr1.x + pr1.w / 2},${pr1.y + pr1.h / 2} L${pr2.x +\n                      pr2.w / 2},${pr2.y + pr2.h / 2}`}\n                  />\n                  <text x={prm.x} y={prm.y}>\n                    {displayDistance}\n                  </text>\n                </Fragment>\n              )\n            })\n        )}\n    </Svg>\n  )\n}\n\nexport default PointDistances\n","// @flow weak\n\nimport React from \"react\"\nimport Paper from \"@material-ui/core/Paper\"\nimport RegionLabel from \"../RegionLabel\"\nimport LockIcon from \"@material-ui/icons/Lock\"\n\nconst copyWithout = (obj, ...args) => {\n  const newObj = { ...obj }\n  for (const arg of args) {\n    delete newObj[arg]\n  }\n  return newObj\n}\n\nexport const RegionTags = ({\n  regions,\n  projectRegionBox,\n  mouseEvents,\n  regionClsList,\n  regionTagList,\n  onBeginRegionEdit,\n  onChangeRegion,\n  onCloseRegionEdit,\n  onDeleteRegion,\n  layoutParams\n}) => {\n  return regions\n    .filter(r => r.visible || r.visible === undefined)\n    .map(region => {\n      const pbox = projectRegionBox(region)\n      const { iw, ih } = layoutParams.current\n      let margin = 8\n      if (region.highlighted && region.type === \"box\") margin += 6\n      const labelBoxHeight =\n        region.editingLabels && !region.locked ? 170 : region.tags ? 60 : 50\n      const displayOnTop = pbox.y > labelBoxHeight\n\n      const coords = displayOnTop\n        ? {\n            left: pbox.x,\n            top: pbox.y - margin / 2\n          }\n        : { left: pbox.x, top: pbox.y + pbox.h + margin / 2 }\n      if (region.locked) {\n        return (\n          <div\n            key={region.id}\n            style={{\n              position: \"absolute\",\n              ...coords,\n              zIndex: 10 + (region.editingLabels ? 5 : 0)\n            }}\n          >\n            <Paper\n              style={{\n                position: \"absolute\",\n                left: 0,\n                ...(displayOnTop ? { bottom: 0 } : { top: 0 }),\n                zIndex: 10,\n                backgroundColor: \"#fff\",\n                borderRadius: 4,\n                padding: 2,\n                paddingBottom: 0,\n                opacity: 0.5,\n                pointerEvents: \"none\"\n              }}\n            >\n              <LockIcon style={{ width: 16, height: 16, color: \"#333\" }} />\n            </Paper>\n          </div>\n        )\n      }\n      return (\n        <div\n          key={region.id}\n          style={{\n            position: \"absolute\",\n            ...coords,\n            zIndex: 10 + (region.editingLabels ? 5 : 0),\n            width: 200\n          }}\n          onMouseDown={e => e.preventDefault()}\n          onMouseUp={e => e.preventDefault()}\n          onMouseEnter={e => {\n            if (region.editingLabels) {\n              mouseEvents.onMouseUp(e)\n              e.button = 1\n              mouseEvents.onMouseUp(e)\n            }\n          }}\n        >\n          <div\n            style={{\n              position: \"absolute\",\n              left: 0,\n              ...(displayOnTop ? { bottom: 0 } : { top: 0 })\n            }}\n            {...(!region.editingLabels\n              ? copyWithout(mouseEvents, \"onMouseDown\", \"onMouseUp\")\n              : {})}\n          >\n            <RegionLabel\n              allowedClasses={regionClsList}\n              allowedTags={regionTagList}\n              onOpen={onBeginRegionEdit}\n              onChange={onChangeRegion}\n              onClose={onCloseRegionEdit}\n              onDelete={onDeleteRegion}\n              editing={region.editingLabels}\n              region={region}\n            />\n          </div>\n        </div>\n      )\n    })\n}\n\nexport default RegionTags\n","// @flow weak\n\nimport React, { Fragment } from \"react\"\nimport HighlightBox from \"../HighlightBox\"\nimport { styled } from \"@material-ui/core/styles\"\nimport PreventScrollToParents from \"../PreventScrollToParents\"\n\nconst TransformGrabber = styled(\"div\")({\n  width: 8,\n  height: 8,\n  zIndex: 2,\n  border: \"2px solid #FFF\",\n  position: \"absolute\"\n})\n\nconst boxCursorMap = [\n  [\"nw-resize\", \"n-resize\", \"ne-resize\"],\n  [\"w-resize\", \"grab\", \"e-resize\"],\n  [\"sw-resize\", \"s-resize\", \"se-resize\"]\n]\n\nexport const RegionSelectAndTransformBoxes = ({\n  regions,\n  mouseEvents,\n  projectRegionBox,\n  dragWithPrimary,\n  createWithPrimary,\n  zoomWithPrimary,\n  onBeginMovePoint,\n  onSelectRegion,\n  layoutParams,\n  mat,\n  onBeginBoxTransform,\n  onBeginMovePolygonPoint,\n  onAddPolygonPoint\n}) => {\n  return regions\n    .filter(r => r.visible || r.visible === undefined)\n    .filter(r => !r.locked)\n    .map((r, i) => {\n      const pbox = projectRegionBox(r)\n      const { iw, ih } = layoutParams.current\n      return (\n        <Fragment key={r.id}>\n          <PreventScrollToParents>\n            <HighlightBox\n              region={r}\n              mouseEvents={mouseEvents}\n              dragWithPrimary={dragWithPrimary}\n              createWithPrimary={createWithPrimary}\n              zoomWithPrimary={zoomWithPrimary}\n              onBeginMovePoint={onBeginMovePoint}\n              onSelectRegion={onSelectRegion}\n              pbox={pbox}\n            />\n            {r.type === \"box\" &&\n              !dragWithPrimary &&\n              !zoomWithPrimary &&\n              !r.locked &&\n              r.highlighted &&\n              mat.a < 1.2 &&\n              [\n                [0, 0],\n                [0.5, 0],\n                [1, 0],\n                [1, 0.5],\n                [1, 1],\n                [0.5, 1],\n                [0, 1],\n                [0, 0.5],\n                [0.5, 0.5]\n              ].map(([px, py], i) => (\n                <TransformGrabber\n                  key={i}\n                  {...mouseEvents}\n                  onMouseDown={e => {\n                    if (e.button === 0)\n                      return onBeginBoxTransform(r, [px * 2 - 1, py * 2 - 1])\n                    mouseEvents.onMouseDown(e)\n                  }}\n                  style={{\n                    left: pbox.x - 4 - 2 + pbox.w * px,\n                    top: pbox.y - 4 - 2 + pbox.h * py,\n                    cursor: boxCursorMap[py * 2][px * 2],\n                    borderRadius: px === 0.5 && py === 0.5 ? 4 : undefined\n                  }}\n                />\n              ))}\n            {r.type === \"polygon\" &&\n              !dragWithPrimary &&\n              !zoomWithPrimary &&\n              !r.locked &&\n              r.highlighted &&\n              r.points.map(([px, py], i) => {\n                const proj = mat\n                  .clone()\n                  .inverse()\n                  .applyToPoint(px * iw, py * ih)\n                return (\n                  <TransformGrabber\n                    key={i}\n                    {...mouseEvents}\n                    onMouseDown={e => {\n                      if (e.button === 0 && (!r.open || i === 0))\n                        return onBeginMovePolygonPoint(r, i)\n                      mouseEvents.onMouseDown(e)\n                    }}\n                    style={{\n                      cursor: !r.open\n                        ? \"move\"\n                        : i === 0\n                        ? \"pointer\"\n                        : undefined,\n                      pointerEvents:\n                        r.open && i === r.points.length - 1\n                          ? \"none\"\n                          : undefined,\n                      left: proj.x - 4,\n                      top: proj.y - 4\n                    }}\n                  />\n                )\n              })}\n            {r.type === \"polygon\" &&\n              r.highlighted &&\n              !dragWithPrimary &&\n              !zoomWithPrimary &&\n              !r.locked &&\n              !r.open &&\n              r.points.length > 1 &&\n              r.points\n                .map((p1, i) => [p1, r.points[(i + 1) % r.points.length]])\n                .map(([p1, p2]) => [(p1[0] + p2[0]) / 2, (p1[1] + p2[1]) / 2])\n                .map((pa, i) => {\n                  const proj = mat\n                    .clone()\n                    .inverse()\n                    .applyToPoint(pa[0] * iw, pa[1] * ih)\n                  return (\n                    <TransformGrabber\n                      key={i}\n                      {...mouseEvents}\n                      onMouseDown={e => {\n                        if (e.button === 0)\n                          return onAddPolygonPoint(r, pa, i + 1)\n                        mouseEvents.onMouseDown(e)\n                      }}\n                      style={{\n                        cursor: \"copy\",\n                        left: proj.x - 4,\n                        top: proj.y - 4,\n                        border: \"2px dotted #fff\",\n                        opacity: 0.5\n                      }}\n                    />\n                  )\n                })}\n          </PreventScrollToParents>\n        </Fragment>\n      )\n    })\n}\n\nexport default RegionSelectAndTransformBoxes\n","// @flow\n\nimport React, { createContext, useContext, useState } from \"react\"\n\nconst defaultSettings = {\n  showCrosshairs: false\n}\n\nexport const SettingsContext = createContext(defaultSettings)\n\nconst pullSettingsFromLocalStorage = () => {\n  if (!window || !window.localStorage) return {}\n  let settings = {}\n  for (let i = 0; i < window.localStorage.length; i++) {\n    const key = window.localStorage.key(i)\n    if (key.startsWith(\"settings_\")) {\n      try {\n        settings[key.replace(\"settings_\", \"\")] = JSON.parse(\n          window.localStorage.getItem(key)\n        )\n      } catch (e) {}\n    }\n  }\n  return settings\n}\n\nexport const useSettings = () => useContext(SettingsContext)\n\nexport const SettingsProvider = ({ children }) => {\n  const [state, changeState] = useState(() => pullSettingsFromLocalStorage())\n  const changeSetting = (setting: string, value: any) => {\n    changeState({ ...state, [setting]: value })\n    window.localStorage.setItem(`settings_${setting}`, JSON.stringify(value))\n  }\n  return (\n    <SettingsContext.Provider value={{ ...state, changeSetting }}>\n      {children}\n    </SettingsContext.Provider>\n  )\n}\n\nexport default SettingsProvider\n","// @flow weak\n\nimport React, { useRef, useEffect, useMemo } from \"react\"\nimport { styled } from \"@material-ui/core/styles\"\nimport useEventCallback from \"use-event-callback\"\nimport { useSettings } from \"../SettingsProvider\"\n\nconst Video = styled(\"video\")({\n  zIndex: 0,\n  position: \"absolute\"\n})\n\nconst StyledImage = styled(\"img\")({\n  zIndex: 0,\n  position: \"absolute\"\n})\n\nexport default ({\n  imagePosition,\n  mouseEvents,\n  videoTime = 0,\n  videoSrc,\n  imageSrc,\n  onLoad,\n  videoPlaying,\n  onChangeVideoTime,\n  onChangeVideoPlaying\n}) => {\n  const settings = useSettings()\n  const videoRef = useRef()\n  const imageRef = useRef()\n\n  useEffect(() => {\n    if (!videoPlaying && videoRef.current) {\n      videoRef.current.currentTime = videoTime / 1000\n    }\n  }, [videoTime])\n\n  useEffect(() => {\n    let renderLoopRunning = false\n    if (videoRef.current) {\n      if (videoPlaying) {\n        videoRef.current.play()\n        renderLoopRunning = true\n        if (settings.videoPlaybackSpeed) {\n          videoRef.current.playbackRate = parseFloat(\n            settings.videoPlaybackSpeed\n          )\n        }\n      } else {\n        videoRef.current.pause()\n      }\n    }\n\n    function checkForNewFrame() {\n      if (!renderLoopRunning) return\n      if (!videoRef.current) return\n      const newVideoTime = Math.floor(videoRef.current.currentTime * 1000)\n      if (videoTime !== newVideoTime) {\n        onChangeVideoTime(newVideoTime)\n      }\n      if (videoRef.current.paused) {\n        renderLoopRunning = false\n        onChangeVideoPlaying(false)\n      }\n      requestAnimationFrame(checkForNewFrame)\n    }\n    checkForNewFrame()\n\n    return () => {\n      renderLoopRunning = false\n    }\n  }, [videoPlaying])\n\n  const onLoadedVideoMetadata = useEventCallback(event => {\n    const videoElm = event.currentTarget\n    videoElm.currentTime = videoTime / 1000\n    if (onLoad)\n      onLoad({\n        naturalWidth: videoElm.videoWidth,\n        naturalHeight: videoElm.videoHeight,\n        videoElm: videoElm,\n        duration: videoElm.duration\n      })\n  })\n  const onImageLoaded = useEventCallback(event => {\n    const imageElm = event.currentTarget\n    if (onLoad)\n      onLoad({\n        naturalWidth: imageElm.naturalWidth,\n        naturalHeight: imageElm.naturalHeight,\n        imageElm\n      })\n  })\n\n  const stylePosition = useMemo(() => {\n    let width = imagePosition.bottomRight.x - imagePosition.topLeft.x\n    let height = imagePosition.bottomRight.y - imagePosition.topLeft.y\n    return {\n      left: imagePosition.topLeft.x,\n      top: imagePosition.topLeft.y,\n      width: isNaN(width) ? 0 : width,\n      height: isNaN(height) ? 0 : height\n    }\n  }, [\n    imagePosition.topLeft.x,\n    imagePosition.topLeft.y,\n    imagePosition.bottomRight.x,\n    imagePosition.bottomRight.y\n  ])\n\n  if (!videoSrc && !imageSrc) return \"No imageSrc or videoSrc provided\"\n\n  return imageSrc && videoTime === undefined ? (\n    <StyledImage\n      {...mouseEvents}\n      src={imageSrc}\n      ref={imageRef}\n      style={stylePosition}\n      onLoad={onImageLoaded}\n    />\n  ) : (\n    <Video\n      {...mouseEvents}\n      ref={videoRef}\n      style={stylePosition}\n      onLoadedMetadata={onLoadedVideoMetadata}\n      src={videoSrc || imageSrc}\n    />\n  )\n}\n","// @flow weak\n\nimport React, {\n  Fragment,\n  useRef,\n  useState,\n  useLayoutEffect,\n  useEffect\n} from \"react\"\nimport { Matrix } from \"transformation-matrix-js\"\nimport getImageData from \"get-image-data\"\nimport Crosshairs from \"../Crosshairs\"\nimport type {\n  Region,\n  PixelRegion,\n  Point,\n  Polygon,\n  Box\n} from \"./region-tools.js\"\nimport { getEnclosingBox } from \"./region-tools.js\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport styles from \"./styles\"\nimport classnames from \"classnames\"\nimport RegionLabel from \"../RegionLabel\"\nimport LockIcon from \"@material-ui/icons/Lock\"\nimport Paper from \"@material-ui/core/Paper\"\nimport HighlightBox from \"../HighlightBox\"\nimport PreventScrollToParents from \"../PreventScrollToParents\"\nimport useWindowSize from \"../hooks/use-window-size.js\"\nimport useMouse from \"./use-mouse\"\nimport useProjectRegionBox from \"./use-project-box\"\nimport useLoadImage from \"../hooks/use-load-image\"\nimport useExcludePattern from \"../hooks/use-exclude-pattern\"\nimport { useRafState } from \"react-use\"\nimport PointDistances from \"../PointDistances\"\nimport RegionTags from \"../RegionTags\"\nimport RegionSelectAndTransformBoxes from \"../RegionSelectAndTransformBoxes\"\nimport VideoOrImageCanvasBackground from \"../VideoOrImageCanvasBackground\"\nimport useEventCallback from \"use-event-callback\"\n\nconst useStyles = makeStyles(styles)\n\ntype Props = {\n  regions: Array<Region>,\n  imageSrc?: string,\n  videoSrc?: string,\n  videoTime?: number,\n  onMouseMove?: ({ x: number, y: number }) => any,\n  onMouseDown?: ({ x: number, y: number }) => any,\n  onMouseUp?: ({ x: number, y: number }) => any,\n  dragWithPrimary?: boolean,\n  zoomWithPrimary?: boolean,\n  createWithPrimary?: boolean,\n  showTags?: boolean,\n  realSize?: { width: number, height: number, unitName: string },\n  showCrosshairs?: boolean,\n  showPointDistances?: boolean,\n  pointDistancePrecision?: number,\n  regionClsList?: Array<string>,\n  regionTagList?: Array<string>,\n  allowedArea?: { x: number, y: number, w: number, h: number },\n  videoPlaying?: boolean,\n\n  onChangeRegion: Region => any,\n  onBeginRegionEdit: Region => any,\n  onCloseRegionEdit: Region => any,\n  onDeleteRegion: Region => any,\n  onBeginBoxTransform: (Box, [number, number]) => any,\n  onBeginMovePolygonPoint: (Polygon, index: number) => any,\n  onAddPolygonPoint: (Polygon, point: [number, number], index: number) => any,\n  onSelectRegion: Region => any,\n  onBeginMovePoint: Point => any,\n  onImageOrVideoLoaded: ({\n    naturalWidth: number,\n    naturalHeight: number,\n    duration?: number\n  }) => any,\n  onChangeVideoTime: number => any\n}\n\nconst getDefaultMat = () => Matrix.from(1, 0, 0, 1, -10, -10)\n\nexport default ({\n  regions,\n  imageSrc,\n  videoSrc,\n  videoTime,\n  realSize,\n  showTags,\n  onMouseMove = p => null,\n  onMouseDown = p => null,\n  onMouseUp = p => null,\n  dragWithPrimary = false,\n  zoomWithPrimary = false,\n  createWithPrimary = false,\n  pointDistancePrecision = 0,\n  regionClsList,\n  regionTagList,\n  showCrosshairs,\n  showPointDistances,\n  allowedArea,\n  videoPlaying = false,\n\n  onImageOrVideoLoaded,\n  onChangeRegion,\n  onBeginRegionEdit,\n  onCloseRegionEdit,\n  onBeginBoxTransform,\n  onBeginMovePolygonPoint,\n  onAddPolygonPoint,\n  onSelectRegion,\n  onBeginMovePoint,\n  onDeleteRegion,\n  onChangeVideoTime,\n  onChangeVideoPlaying\n}: Props) => {\n  const classes = useStyles()\n\n  const canvasEl = useRef(null)\n  const layoutParams = useRef({})\n  const [dragging, changeDragging] = useRafState(false)\n  const [maskImagesLoaded, changeMaskImagesLoaded] = useRafState(0)\n  const [zoomStart, changeZoomStart] = useRafState(null)\n  const [zoomEnd, changeZoomEnd] = useRafState(null)\n  const [mat, changeMat] = useRafState(getDefaultMat())\n  const maskImages = useRef({})\n  const windowSize = useWindowSize()\n\n  const { mouseEvents, mousePosition } = useMouse({\n    canvasEl,\n    dragging,\n    mat,\n    layoutParams,\n    changeMat,\n    zoomStart,\n    zoomEnd,\n    changeZoomStart,\n    changeZoomEnd,\n    changeDragging,\n    zoomWithPrimary,\n    dragWithPrimary,\n    onMouseMove,\n    onMouseDown,\n    onMouseUp\n  })\n\n  useLayoutEffect(() => changeMat(mat.clone()), [windowSize])\n\n  const innerMousePos = mat.applyToPoint(\n    mousePosition.current.x,\n    mousePosition.current.y\n  )\n\n  const projectRegionBox = useProjectRegionBox({ layoutParams, mat })\n\n  const [imageDimensions, changeImageDimensions] = useState()\n  const imageLoaded = Boolean(imageDimensions && imageDimensions.naturalWidth)\n  const onVideoOrImageLoaded = useEventCallback(\n    ({ naturalWidth, naturalHeight, duration }) => {\n      const dims = { naturalWidth, naturalHeight, duration }\n      if (onImageOrVideoLoaded) onImageOrVideoLoaded(dims)\n      changeImageDimensions(dims)\n      // Redundant update to fix rerendering issues\n      setTimeout(() => changeImageDimensions(dims), 10)\n    }\n  )\n\n  const excludePattern = useExcludePattern()\n\n  const canvas = canvasEl.current\n  if (canvas && imageLoaded) {\n    const { clientWidth, clientHeight } = canvas\n\n    const fitScale = Math.max(\n      imageDimensions.naturalWidth / (clientWidth - 20),\n      imageDimensions.naturalHeight / (clientHeight - 20)\n    )\n\n    const [iw, ih] = [\n      imageDimensions.naturalWidth / fitScale,\n      imageDimensions.naturalHeight / fitScale\n    ]\n\n    layoutParams.current = {\n      iw,\n      ih,\n      fitScale,\n      canvasWidth: clientWidth,\n      canvasHeight: clientHeight\n    }\n  }\n\n  useLayoutEffect(() => {\n    if (!imageDimensions) return\n    const { clientWidth, clientHeight } = canvas\n    canvas.width = clientWidth\n    canvas.height = clientHeight\n    const context = canvas.getContext(\"2d\")\n\n    context.save()\n    context.transform(\n      ...mat\n        .clone()\n        .inverse()\n        .toArray()\n    )\n\n    const { iw, ih } = layoutParams.current\n\n    if (allowedArea) {\n      // Pattern to indicate the NOT allowed areas\n      const { x, y, w, h } = allowedArea\n      context.save()\n      context.globalAlpha = 0.25\n      const outer = [[0, 0], [iw, 0], [iw, ih], [0, ih]]\n      const inner = [\n        [x * iw, y * ih],\n        [x * iw + w * iw, y * ih],\n        [x * iw + w * iw, y * ih + h * ih],\n        [x * iw, y * ih + h * ih]\n      ]\n      context.moveTo(...outer[0])\n      outer.forEach(p => context.lineTo(...p))\n      context.lineTo(...outer[0])\n      context.closePath()\n\n      inner.reverse()\n      context.moveTo(...inner[0])\n      inner.forEach(p => context.lineTo(...p))\n      context.lineTo(...inner[0])\n\n      context.fillStyle = excludePattern || \"#f00\"\n      context.fill()\n\n      context.restore()\n    }\n\n    context.save()\n    context.globalAlpha = mat.a * 0.5 + 0.5\n    context.lineWidth = mat.a * 1 + 1\n    if (context.globalAlpha > 0.6) {\n      context.shadowColor = \"black\"\n      context.shadowBlur = 4\n    }\n    for (const region of regions.filter(\n      r => r.visible || r.visible === undefined\n    )) {\n      switch (region.type) {\n        case \"point\": {\n          context.save()\n\n          context.beginPath()\n          context.strokeStyle = region.color\n          context.moveTo(region.x * iw - 10, region.y * ih)\n          context.lineTo(region.x * iw - 2, region.y * ih)\n          context.moveTo(region.x * iw + 10, region.y * ih)\n          context.lineTo(region.x * iw + 2, region.y * ih)\n          context.moveTo(region.x * iw, region.y * ih - 10)\n          context.lineTo(region.x * iw, region.y * ih - 2)\n          context.moveTo(region.x * iw, region.y * ih + 10)\n          context.lineTo(region.x * iw, region.y * ih + 2)\n          context.moveTo(region.x * iw + 5, region.y * ih)\n          context.arc(region.x * iw, region.y * ih, 5, 0, 2 * Math.PI)\n          context.stroke()\n          context.restore()\n          break\n        }\n        case \"box\": {\n          context.save()\n\n          context.shadowColor = \"black\"\n          context.shadowBlur = 4\n          context.strokeStyle = region.color\n          context.strokeRect(\n            region.x * iw,\n            region.y * ih,\n            region.w * iw,\n            region.h * ih\n          )\n\n          context.restore()\n          break\n        }\n        case \"polygon\": {\n          context.save()\n\n          context.shadowColor = \"black\"\n          context.shadowBlur = 4\n          context.strokeStyle = region.color\n\n          context.beginPath()\n          context.moveTo(region.points[0][0] * iw, region.points[0][1] * ih)\n          for (const point of region.points) {\n            context.lineTo(point[0] * iw, point[1] * ih)\n          }\n          if (!region.open) context.closePath()\n          context.stroke()\n          context.restore()\n          break\n        }\n        case \"pixel\": {\n          context.save()\n\n          if (maskImages.current[region.src]) {\n            if (maskImages.current[region.src].nodeName === \"CANVAS\") {\n              context.globalAlpha = 0.6\n              context.drawImage(\n                maskImages.current[region.src],\n                region.sx * iw,\n                region.sy * ih,\n                region.w * iw,\n                region.h * ih\n              )\n            }\n          } else {\n            maskImages.current[region.src] = new Image()\n            maskImages.current[region.src].onload = () => {\n              const img = maskImages.current[region.src]\n              const newCanvas = document.createElement(\"canvas\")\n              newCanvas.width = img.naturalWidth\n              newCanvas.height = img.naturalHeight\n              const ctx = newCanvas.getContext(\"2d\")\n              ctx.drawImage(img, 0, 0)\n              const imgData = ctx.getImageData(\n                0,\n                0,\n                img.naturalWidth,\n                img.naturalHeight\n              )\n              for (let i = 0; i < imgData.data.length; i += 4) {\n                const [r, g, b, a] = imgData.data.slice(i, i + 4)\n                const black = r < 10 && g < 10 && b < 10\n                imgData.data[i] = 0\n                imgData.data[i + 1] = 0\n                imgData.data[i + 2] = black ? 255 : 0\n                imgData.data[i + 3] = black ? 255 : 0\n              }\n              ctx.clearRect(0, 0, img.naturalWidth, img.naturalHeight)\n              ctx.putImageData(imgData, 0, 0)\n              maskImages.current[region.src] = newCanvas\n              changeMaskImagesLoaded(maskImagesLoaded + 1)\n            }\n            maskImages.current[region.src].src = region.src\n          }\n\n          context.restore()\n          break\n        }\n      }\n    }\n    context.restore()\n    context.restore()\n  })\n\n  const { iw, ih } = layoutParams.current\n\n  let zoomBox =\n    !zoomStart || !zoomEnd\n      ? null\n      : {\n          ...mat\n            .clone()\n            .inverse()\n            .applyToPoint(zoomStart.x, zoomStart.y),\n          w: (zoomEnd.x - zoomStart.x) / mat.a,\n          h: (zoomEnd.y - zoomStart.y) / mat.d\n        }\n  if (zoomBox) {\n    if (zoomBox.w < 0) {\n      zoomBox.x += zoomBox.w\n      zoomBox.w *= -1\n    }\n    if (zoomBox.h < 0) {\n      zoomBox.y += zoomBox.h\n      zoomBox.h *= -1\n    }\n  }\n\n  const imagePosition = {\n    topLeft: mat\n      .clone()\n      .inverse()\n      .applyToPoint(0, 0),\n    bottomRight: mat\n      .clone()\n      .inverse()\n      .applyToPoint(iw, ih)\n  }\n\n  return (\n    <div\n      style={{\n        width: \"100%\",\n        height: \"100%\",\n        maxHeight: \"calc(100vh - 68px)\",\n        position: \"relative\",\n        overflow: \"hidden\",\n        cursor: createWithPrimary\n          ? \"crosshair\"\n          : dragging\n          ? \"grabbing\"\n          : dragWithPrimary\n          ? \"grab\"\n          : zoomWithPrimary\n          ? mat.a < 1\n            ? \"zoom-out\"\n            : \"zoom-in\"\n          : undefined\n      }}\n    >\n      {showCrosshairs && (\n        <Crosshairs key=\"crossHairs\" mousePosition={mousePosition} />\n      )}\n      {imageLoaded && (\n        <RegionSelectAndTransformBoxes\n          key=\"regionSelectAndTransformBoxes\"\n          regions={regions}\n          mouseEvents={mouseEvents}\n          projectRegionBox={projectRegionBox}\n          dragWithPrimary={dragWithPrimary}\n          createWithPrimary={createWithPrimary}\n          zoomWithPrimary={zoomWithPrimary}\n          onBeginMovePoint={onBeginMovePoint}\n          onSelectRegion={onSelectRegion}\n          layoutParams={layoutParams}\n          mat={mat}\n          onBeginBoxTransform={onBeginBoxTransform}\n          onBeginMovePolygonPoint={onBeginMovePolygonPoint}\n          onAddPolygonPoint={onAddPolygonPoint}\n        />\n      )}\n      {imageLoaded && showTags && (\n        <PreventScrollToParents key=\"regionTags\">\n          <RegionTags\n            regions={regions}\n            projectRegionBox={projectRegionBox}\n            mouseEvents={mouseEvents}\n            regionClsList={regionClsList}\n            regionTagList={regionTagList}\n            onBeginRegionEdit={onBeginRegionEdit}\n            onChangeRegion={onChangeRegion}\n            onCloseRegionEdit={onCloseRegionEdit}\n            onDeleteRegion={onDeleteRegion}\n            layoutParams={layoutParams}\n          />\n        </PreventScrollToParents>\n      )}\n      {zoomWithPrimary && zoomBox !== null && (\n        <div\n          key=\"zoomBox\"\n          style={{\n            position: \"absolute\",\n            zIndex: 1,\n            border: \"1px solid #fff\",\n            pointerEvents: \"none\",\n            left: zoomBox.x,\n            top: zoomBox.y,\n            width: zoomBox.w,\n            height: zoomBox.h\n          }}\n        />\n      )}\n      {showPointDistances && (\n        <PointDistances\n          key=\"pointDistances\"\n          regions={regions}\n          realSize={realSize}\n          projectRegionBox={projectRegionBox}\n          pointDistancePrecision={pointDistancePrecision}\n        />\n      )}\n      <PreventScrollToParents\n        style={{ width: \"100%\", height: \"100%\" }}\n        {...mouseEvents}\n      >\n        <>\n          <canvas className={classes.canvas} ref={canvasEl} />\n          <VideoOrImageCanvasBackground\n            videoPlaying={videoPlaying}\n            imagePosition={imagePosition}\n            mouseEvents={mouseEvents}\n            onLoad={onVideoOrImageLoaded}\n            videoTime={videoTime}\n            videoSrc={videoSrc}\n            imageSrc={imageSrc}\n            onChangeVideoTime={onChangeVideoTime}\n            onChangeVideoPlaying={onChangeVideoPlaying}\n          />\n        </>\n      </PreventScrollToParents>\n      <div className={classes.zoomIndicator}>\n        {((1 / mat.a) * 100).toFixed(0)}%\n      </div>\n    </div>\n  )\n}\n","import { grey } from \"@material-ui/core/colors\"\n\nexport default {\n  canvas: { width: \"100%\", height: \"100%\", position: \"relative\", zIndex: 1 },\n  zoomIndicator: {\n    position: \"absolute\",\n    bottom: 16,\n    right: 0,\n    backgroundColor: \"rgba(0,0,0,0.4)\",\n    color: \"#fff\",\n    opacity: 0.5,\n    fontWeight: \"bolder\",\n    fontSize: 14,\n    padding: 4\n  }\n}\n","// @flow weak\n\nimport { useRef } from \"react\"\nimport excludePatternSrc from \"./xpattern.js\"\n\nexport default () => {\n  const excludePattern = useRef(null)\n  if (excludePattern.current === null) {\n    excludePattern.current = {\n      image: new Image(),\n      pattern: null\n    }\n    const canvas = document.createElement(\"canvas\")\n    canvas.width = 100\n    canvas.height = 100\n    const context = canvas.getContext(\"2d\")\n\n    excludePattern.current.image.onload = () => {\n      excludePattern.current.pattern = context.createPattern(\n        excludePattern.current.image,\n        \"repeat\"\n      )\n    }\n    excludePattern.current.image.src = excludePatternSrc\n  }\n  return excludePattern.current.pattern\n}\n","export default `data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4wMSAxY5oG+lzgAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAAcSURBVAjXY/jPwPCfAQnA+TAGugLcAhhakRUAAK3lEe8m9qZhAAAAAElFTkSuQmCC`\n","// @flow\n\nimport React, { memo, createContext, useContext } from \"react\"\nimport { styled } from \"@material-ui/core/styles\"\nimport Button from \"@material-ui/core/Button\"\nimport useEventCallback from \"use-event-callback\"\n\nconst StyledButton = styled(Button)({\n  width: 80,\n  margin: 2\n})\n\nconst IconName = styled(\"div\")({\n  fontWeight: \"bold\"\n})\n\nexport const HeaderButtonContext = createContext()\n\nconst MemoizedHeaderButton = memo(\n  ({ name, disabled, Icon, onClick }) => (\n    <StyledButton disabled={disabled} onClick={onClick}>\n      <div>\n        <Icon />\n        <IconName>{name}</IconName>\n      </div>\n    </StyledButton>\n  ),\n  (prevProps, nextProps) =>\n    prevProps.name === nextProps.name &&\n    prevProps.disabled === nextProps.disabled\n)\n\nexport const HeaderButton = ({\n  name,\n  disabled,\n  Icon\n}: {\n  name: string,\n  disabled?: boolean,\n  Icon: any\n}) => {\n  const { onHeaderButtonClick } = useContext(HeaderButtonContext)\n  const onClick = useEventCallback(() => onHeaderButtonClick(name))\n  return (\n    <MemoizedHeaderButton\n      name={name}\n      disabled={disabled}\n      Icon={Icon}\n      onClick={onClick}\n    />\n  )\n}\n\nexport default HeaderButton\n","import { grey } from \"@material-ui/core/colors\"\n\nexport default {\n  header: {\n    display: \"flex\",\n    position: \"relative\",\n    flexDirection: \"row\",\n    flexShrink: 0,\n    zIndex: 10,\n    boxShadow: \"0px 3px 8px rgba(0,0,0,.1)\"\n  },\n  fileInfo: {\n    alignItems: \"center\",\n    flexGrow: 1,\n    \"&.videoMode\": {\n      flexMode: 0.1\n    },\n    display: \"flex\",\n    fontWeight: \"bold\",\n    color: grey[800],\n    marginRight: 16,\n    fontSize: 24,\n    paddingLeft: 16\n  }\n}\n","// @flow weak\n\nimport React, { useMemo, useState, useEffect } from \"react\"\nimport { styled } from \"@material-ui/core/styles\"\nimport range from \"lodash/range\"\nimport * as colors from \"@material-ui/core/colors\"\nimport useMeasure from \"react-use-measure\"\nimport useEventCallback from \"use-event-callback\"\nimport { useRafState } from \"react-use\"\nimport getTimeString from \"./get-time-string\"\n\nconst Container = styled(\"div\")({\n  position: \"relative\",\n  display: \"flex\",\n  flexGrow: 1,\n  minWidth: 240,\n  marginLeft: 16,\n  marginRight: 16\n})\n\nconst Tick = styled(\"div\")({\n  position: \"absolute\",\n  width: 2,\n  marginLeft: -1,\n  height: \"100%\",\n  backgroundColor: colors.grey[300],\n  bottom: 0\n})\nconst TickText = styled(\"div\")({\n  position: \"absolute\",\n  userSelect: \"none\",\n  fontSize: 10,\n  color: colors.grey[600],\n  fontWeight: \"bold\",\n  bottom: 0\n})\n\nconst PositionCursor = styled(\"div\")({\n  position: \"absolute\",\n  bottom: \"calc(50% + 6px)\",\n  fontSize: 10,\n  fontWeight: \"bold\",\n  color: \"#fff\",\n  display: \"grid\",\n  placeItems: \"center\",\n  width: 48,\n  marginLeft: -24,\n  borderRadius: 2,\n  height: 24,\n  backgroundColor: colors.blue[500],\n  userSelect: \"none\",\n  fontVariantNumeric: \"tabular-nums\",\n\n  \"&::before\": {\n    position: \"absolute\",\n    bottom: -6,\n    left: 24 - 8,\n    content: '\"\"',\n    width: 0,\n    height: 0,\n    borderTop: `8px solid ${colors.blue[500]}`,\n    borderLeft: \"8px solid transparent\",\n    borderRight: \"8px solid transparent\"\n  }\n})\n\nconst KeyframeMarker = styled(\"div\")({\n  position: \"absolute\",\n  bottom: 8,\n  cursor: \"pointer\",\n  opacity: 0.75,\n  fontSize: 10,\n  fontWeight: \"bold\",\n  color: \"#fff\",\n  display: \"grid\",\n  placeItems: \"center\",\n  width: 16,\n  marginLeft: 0,\n  borderTopLeftRadius: 2,\n  borderTopRightRadius: 2,\n  height: 12,\n  marginLeft: -8,\n  backgroundColor: colors.red[500],\n  userSelect: \"none\",\n  fontVariantNumeric: \"tabular-nums\",\n\n  \"&::before\": {\n    position: \"absolute\",\n    bottom: -8,\n    left: 0,\n    content: '\"\"',\n    width: 0,\n    height: 0,\n    borderTop: `8px solid ${colors.red[500]}`,\n    borderLeft: \"8px solid transparent\",\n    borderRight: \"8px solid transparent\"\n  }\n})\n\nconst min = 60000\nconst displayIntervalPairs = [\n  [50, 250],\n  [100, 500],\n  [250, 1000],\n  [1000, 5000],\n  [5000, 30000],\n  [10000, min],\n  [30000, min * 2],\n  [min, min * 5],\n  [min * 5, min * 30],\n  [min * 10, min * 60],\n  [min * 30, min * 60 * 3],\n  [min * 60, min * 60 * 5]\n]\n\nconst getMajorInterval = duration => {\n  for (const [minor, major] of displayIntervalPairs) {\n    if (duration / major < 6 && duration / major > 2) {\n      return [minor, major]\n    }\n  }\n  return [duration / 4, duration]\n}\n\nexport default ({\n  currentTime = 0,\n  duration,\n  onChangeCurrentTime,\n  keyframes\n}) => {\n  const [ref, bounds] = useMeasure()\n  const [instantCurrentTime, changeInstantCurrentTime] = useState(currentTime)\n  const [draggingTime, changeDraggingTime] = useRafState(false)\n  const keyframeTimes = Object.keys(keyframes || {})\n    .map(t => parseInt(t))\n    .filter(t => !isNaN(t))\n    .sort((a, b) => a - b)\n\n  useEffect(() => {\n    if (currentTime !== instantCurrentTime) {\n      changeInstantCurrentTime(currentTime)\n    }\n  }, [currentTime])\n\n  const [minorInterval, majorInterval] = useMemo(\n    () => getMajorInterval(duration),\n    [duration]\n  )\n\n  const onMouseMove = useEventCallback(e => {\n    if (draggingTime) {\n      const px = (e.clientX - bounds.left) / bounds.width\n      changeInstantCurrentTime(\n        Math.min(duration, Math.max(0, Math.floor(px * duration)))\n      )\n    }\n  })\n\n  const onMouseUp = useEventCallback(e => {\n    changeDraggingTime(false)\n    const px = (e.clientX - bounds.left) / bounds.width\n    const newTime = Math.min(duration, Math.max(0, Math.floor(px * duration)))\n    changeInstantCurrentTime(newTime)\n    onChangeCurrentTime(newTime)\n  })\n\n  // TODO skeleton\n  if (!duration) return null\n\n  return (\n    <Container onMouseMove={onMouseMove} onMouseUp={onMouseUp} ref={ref}>\n      {range(0, duration, majorInterval).map(a => (\n        <>\n          <Tick\n            key={a}\n            style={{ left: (a / duration) * bounds.width, height: \"50%\" }}\n          />\n          <TickText\n            style={{\n              left: (a / duration) * bounds.width + 8,\n              bottom: \"calc(50% - 12px)\"\n            }}\n          >\n            {getTimeString(a)}\n          </TickText>\n        </>\n      ))}\n      {range(0, duration, minorInterval)\n        .filter(a => !Number.isInteger(a / majorInterval))\n        .map(a => (\n          <Tick\n            key={a}\n            style={{\n              left: (a / duration) * bounds.width,\n              height: \"25%\"\n            }}\n          />\n        ))}\n      {keyframeTimes.map(kt => (\n        <KeyframeMarker\n          onClick={() => onChangeCurrentTime(kt)}\n          key={kt}\n          style={{ left: (kt / duration) * bounds.width }}\n        />\n      ))}\n      <PositionCursor\n        onMouseDown={e => changeDraggingTime(true)}\n        style={{\n          cursor: draggingTime ? \"grabbing\" : \"grab\",\n          left: (instantCurrentTime / duration) * bounds.width\n        }}\n      >\n        {getTimeString(instantCurrentTime)}\n      </PositionCursor>\n    </Container>\n  )\n}\n","// @flow\n\nimport React from \"react\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport HeaderButton, { HeaderButtonContext } from \"../HeaderButton\"\nimport BackIcon from \"@material-ui/icons/KeyboardArrowLeft\"\nimport NextIcon from \"@material-ui/icons/KeyboardArrowRight\"\nimport PlayIcon from \"@material-ui/icons/PlayArrow\"\nimport PauseIcon from \"@material-ui/icons/Pause\"\nimport SettingsIcon from \"@material-ui/icons/Settings\"\nimport HelpIcon from \"@material-ui/icons/Help\"\nimport FullscreenIcon from \"@material-ui/icons/Fullscreen\"\nimport ExitIcon from \"@material-ui/icons/ExitToApp\"\nimport QueuePlayNextIcon from \"@material-ui/icons/QueuePlayNext\"\nimport HotkeysIcon from \"@material-ui/icons/Keyboard\"\nimport styles from \"./styles\"\nimport KeyframeTimeline from \"../KeyframeTimeline\"\nimport classnames from \"classnames\"\n\nconst useStyles = makeStyles(styles)\n\ntype Props = {\n  onHeaderButtonClick: string => any,\n  title: string,\n  inFullScreen?: boolean,\n  multipleImages?: boolean,\n  isAVideoFrame?: boolean,\n  nextVideoFrameHasRegions?: boolean,\n  videoDuration?: number,\n  videoPlaying?: boolean,\n\n  onChangeCurrentTime?: (newTime: number) => any,\n  onPlayVideo?: Function,\n  onPauseVideo?: Function\n}\n\nexport const Header = ({\n  onHeaderButtonClick,\n  title,\n  inFullScreen,\n  videoMode,\n  isAVideoFrame = false,\n  nextVideoFrameHasRegions = false,\n  videoDuration,\n  currentVideoTime,\n  multipleImages,\n  videoPlaying,\n  onChangeCurrentTime,\n  keyframes\n}: Props) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.header}>\n      <div className={classnames(classes.fileInfo, videoMode && \"videoMode\")}>\n        {title}\n      </div>\n      {videoMode && (\n        <KeyframeTimeline\n          key=\"keyframeTimeline\"\n          currentTime={currentVideoTime}\n          duration={videoDuration}\n          onChangeCurrentTime={onChangeCurrentTime}\n          keyframes={keyframes}\n        />\n      )}\n      <div className={classes.headerActions}>\n        <HeaderButtonContext.Provider value={{ onHeaderButtonClick }}>\n          {multipleImages && (\n            <>\n              <HeaderButton name=\"Prev\" Icon={BackIcon} />\n              <HeaderButton name=\"Next\" Icon={NextIcon} />\n              <HeaderButton\n                name=\"Clone\"\n                disabled={nextVideoFrameHasRegions}\n                Icon={QueuePlayNextIcon}\n              />\n            </>\n          )}\n          {videoMode && (\n            <>\n              {!videoPlaying ? (\n                <HeaderButton key=\"play\" name=\"Play\" Icon={PlayIcon} />\n              ) : (\n                <HeaderButton key=\"pause\" name=\"Pause\" Icon={PauseIcon} />\n              )}\n            </>\n          )}\n          <HeaderButton name=\"Settings\" Icon={SettingsIcon} />\n          {/* <HeaderButton name=\"Help\" Icon={HelpIcon} /> */}\n          {inFullScreen ? (\n            <HeaderButton name=\"Window\" Icon={FullscreenIcon} />\n          ) : (\n            <HeaderButton name=\"Fullscreen\" Icon={FullscreenIcon} />\n          )}\n          {/* <HeaderButton name=\"Hotkeys\" Icon={HotkeysIcon} /> */}\n          <HeaderButton name=\"Save\" Icon={ExitIcon} />\n        </HeaderButtonContext.Provider>\n      </div>\n    </div>\n  )\n}\n\nexport default Header\n","// @flow\n\nimport React, { createContext, useContext, memo } from \"react\"\nimport IconButton from \"@material-ui/core/IconButton\"\nimport Tooltip from \"@material-ui/core/Tooltip\"\nimport { blue } from \"@material-ui/core/colors\"\n\nexport const SelectedTool = createContext()\n\nexport const SmallToolButton = ({\n  id,\n  name,\n  icon,\n  selected,\n  togglable,\n  alwaysShowing = false\n}: {\n  id: string,\n  name: string,\n  icon: any,\n  alwaysShowing?: boolean,\n  selected?: boolean,\n  togglable?: boolean\n}) => {\n  const { enabledTools, selectedTool, onClickTool } = useContext(SelectedTool)\n  if (!enabledTools.includes(id) && !alwaysShowing) return null\n  selected = selected || selectedTool === id\n  return (\n    <Tooltip placement=\"right\" title={name}>\n      <div>\n        <IconButton\n          disabled={!togglable ? selected : undefined}\n          aria-label={name}\n          onClick={() => onClickTool(id)}\n          size=\"small\"\n          style={{\n            width: 50,\n            height: 50,\n            margin: 1,\n            color: selected ? blue[500] : undefined\n          }}\n        >\n          {icon}\n        </IconButton>\n      </div>\n    </Tooltip>\n  )\n}\n\nexport default memo(\n  SmallToolButton,\n  (prevProps, nextProps) =>\n    prevProps.togglable === nextProps.togglable &&\n    prevProps.selected === nextProps.selected &&\n    prevProps.name === nextProps.name &&\n    prevProps.id === nextProps.id\n)\n","// @flow\n\nimport React, { useMemo } from \"react\"\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport {\n  faArrowsAlt,\n  faMousePointer,\n  faExpandArrowsAlt,\n  faTag,\n  faPaintBrush,\n  faCrosshairs,\n  faDrawPolygon,\n  faVectorSquare,\n  faHandPaper,\n  faSearch\n} from \"@fortawesome/free-solid-svg-icons\"\nimport SmallToolButton, { SelectedTool } from \"../SmallToolButton\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport { grey } from \"@material-ui/core/colors\"\n\nconst useStyles = makeStyles({\n  iconTools: {\n    display: \"flex\",\n    padding: 4,\n    flexDirection: \"column\",\n    zIndex: 9,\n    boxShadow: \"0px 0px 5px rgba(0,0,0,0.1)\",\n    borderRight: `1px solid ${grey[300]}`,\n    backgroundColor: grey[100]\n  }\n})\n\ntype Props = {\n  showTags?: boolean,\n  enabledTools?: Array<string>,\n  selectedTool: string,\n  onClickTool: string => any\n}\n\nconst defaultTools = [\"select\", \"create-point\", \"create-box\", \"create-polygon\"]\n\nexport const IconTools = ({\n  showTags,\n  selectedTool,\n  onClickTool,\n  enabledTools = defaultTools\n}: Props) => {\n  const classes = useStyles()\n  const selectedToolContextValue = useMemo(\n    () => ({ enabledTools, selectedTool, onClickTool }),\n    [enabledTools, selectedTool]\n  )\n  return (\n    <div className={classes.iconTools}>\n      <SelectedTool.Provider value={selectedToolContextValue}>\n        <SmallToolButton\n          id=\"select\"\n          name=\"Select Region\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faMousePointer} />}\n        />\n        <SmallToolButton\n          alwaysShowing\n          id=\"pan\"\n          name=\"Drag/Pan\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faHandPaper} />}\n        />\n        <SmallToolButton\n          alwaysShowing\n          id=\"zoom\"\n          name=\"Zoom In/Out\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faSearch} />}\n        />\n        {/* <SmallToolButton\n          name=\"Move Region\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faArrowsAlt} />}\n        />\n        <SmallToolButton\n          name=\"Resize Region\"\n          icon={\n            <FontAwesomeIcon size=\"xs\" fixedWidth icon={faExpandArrowsAlt} />\n          }\n        /> */}\n        <SmallToolButton\n          alwaysShowing\n          togglable\n          id=\"show-tags\"\n          selected={showTags}\n          name=\"Show Tags\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faTag} />}\n        />\n        <SmallToolButton\n          id=\"create-point\"\n          name=\"Add Point\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faCrosshairs} />}\n        />\n        <SmallToolButton\n          id=\"create-box\"\n          name=\"Add Bounding Box\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faVectorSquare} />}\n        />\n        <SmallToolButton\n          id=\"create-polygon\"\n          name=\"Add Polygon\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faDrawPolygon} />}\n        />\n        {/* <SmallToolButton\n          id=\"create-pixel\"\n          name=\"Add Pixel Region\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faPaintBrush} />}\n        /> */}\n      </SelectedTool.Provider>\n    </div>\n  )\n}\n\nexport default IconTools\n","import { grey } from \"@material-ui/core/colors\"\n\nexport default {\n  container: {\n    display: \"flex\",\n    flexGrow: 1,\n    flexDirection: \"column\",\n    height: \"100%\",\n    maxHeight: \"100vh\",\n    backgroundColor: \"#fff\",\n    overflow: \"hidden\",\n    \"&.fullscreen\": {\n      position: \"absolute\",\n      zIndex: 99999,\n      left: 0,\n      right: 0,\n      top: 0,\n      bottom: 0\n    }\n  },\n  workspace: {\n    backgroundColor: grey[200],\n    flexGrow: 1,\n    display: \"flex\",\n    flexDirection: \"row\",\n    height: \"100%\",\n    overflow: \"hidden\"\n  },\n  iconToolsContainer: { display: \"flex\" },\n  imageCanvasContainer: {\n    display: \"flex\",\n    flexGrow: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  },\n  noImageSelected: {\n    fontWeight: \"bold\",\n    fontSize: 32,\n    color: grey[500]\n  },\n  sidebarContainer: {\n    width: 300,\n    flexShrink: 0,\n    overflowY: \"auto\",\n    backgroundColor: grey[100],\n    borderLeft: `1px solid ${grey[300]}`,\n    zIndex: 9,\n    height: \"100%\",\n    boxShadow: \"0px 0px 5px rgba(0,0,0,0.1)\"\n  }\n}\n","// @flow\n\nimport React from \"react\"\nimport Dialog from \"@material-ui/core/Dialog\"\nimport DialogTitle from \"@material-ui/core/DialogTitle\"\nimport DialogContent from \"@material-ui/core/DialogContent\"\nimport DialogActions from \"@material-ui/core/DialogActions\"\nimport Button from \"@material-ui/core/Button\"\nimport Survey from \"material-survey/components/Survey\"\nimport { useSettings } from \"../SettingsProvider\"\n\nexport const SettingsDialog = ({ open, onClose }) => {\n  const settings = useSettings()\n  return (\n    <Dialog open={open || false} onClose={onClose}>\n      <DialogTitle>Settings</DialogTitle>\n      <DialogContent style={{ minWidth: 400 }}>\n        <Survey\n          variant=\"flat\"\n          noActions\n          defaultAnswers={settings}\n          onQuestionChange={(q, a, answers) => settings.changeSetting(q, a)}\n          form={{\n            questions: [\n              {\n                type: \"boolean\",\n                title: \"Show Crosshairs\",\n                name: \"showCrosshairs\"\n              },\n              {\n                type: \"dropdown\",\n                title: \"Video Playback Speed\",\n                name: \"videoPlaybackSpeed\",\n                defaultValue: \"1x\",\n                choices: [\"0.25x\", \"0.5x\", \"1x\", \"2x\"]\n              }\n            ]\n          }}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onClose}>Close</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nexport default SettingsDialog\n","// @flow\n\nimport React from \"react\"\nimport ReactFullscreen from \"react-full-screen\"\n\nexport const Fullscreen = props => {\n  if (!props.enabled) return props.children\n  return <ReactFullscreen {...props}>{props.children}</ReactFullscreen>\n}\n\nexport default Fullscreen\n","import { getIn } from \"seamless-immutable\"\n\nexport default state => {\n  let currentImageIndex = null,\n    pathToActiveImage,\n    activeImage\n  if (state.annotationType === \"image\") {\n    currentImageIndex = state.images.findIndex(\n      img =>\n        img.src === state.selectedImage &&\n        (state.selectedImageFrameTime === undefined ||\n          img.frameTime === state.selectedImageFrameTime)\n    )\n    if (currentImageIndex === -1) {\n      currentImageIndex = null\n      activeImage = null\n    } else {\n      pathToActiveImage = [\"images\", currentImageIndex]\n      activeImage = getIn(state, pathToActiveImage)\n    }\n  } else if (state.annotationType === \"video\") {\n    pathToActiveImage = [\"keyframes\", state.currentVideoTime || 0]\n    activeImage = getIn(state, pathToActiveImage) || null\n  }\n  return { currentImageIndex, pathToActiveImage, activeImage }\n}\n","// @flow\n\nimport type { Region } from \"../../ImageCanvas/region-tools.js\"\n\nconst emptyArr = []\n\nexport default (\n  keyframes: { [string | number]: { regions: Array<Region> } },\n  time: number\n) => {\n  if (keyframes[time || 0]) {\n    return keyframes[time || 0].regions\n  }\n  // Get surrounding video keyframes\n  const keyframeTimes = Object.keys(keyframes)\n    .map(a => parseInt(a))\n    .filter(a => !isNaN(a))\n  if (keyframeTimes.length === 0) return emptyArr\n  keyframeTimes.sort((a, b) => a - b)\n  let nextKeyframeTimeIndex = keyframeTimes.findIndex(kt => kt >= time)\n  if (nextKeyframeTimeIndex === -1) {\n    return (\n      keyframes[keyframeTimes[keyframeTimes.length - 1]].regions || emptyArr\n    )\n  } else if (nextKeyframeTimeIndex === 0) {\n    return emptyArr\n  }\n\n  const t1 = keyframeTimes[nextKeyframeTimeIndex - 1]\n  const prevKeyframe = keyframes[t1]\n  const t2 = keyframeTimes[nextKeyframeTimeIndex]\n  const nextKeyframe = keyframes[t2]\n\n  const [prevRegionMap, nextRegionMap] = [{}, {}]\n  for (const region of prevKeyframe.regions) prevRegionMap[region.id] = region\n  for (const region of nextKeyframe.regions) nextRegionMap[region.id] = region\n\n  const impliedRegions = []\n\n  // Weighted time coefficients for linear transition\n  const w1 = (t2 - time) / (t2 - t1)\n  const w2 = 1 - w1\n\n  for (const regionId in prevRegionMap) {\n    const [prev, next] = [prevRegionMap[regionId], nextRegionMap[regionId]]\n    if (!next) {\n      impliedRegions.push({\n        ...prev,\n        highlighted: false,\n        editingLabels: false\n      })\n      continue\n    }\n    switch (prev.type) {\n      case \"point\": {\n        impliedRegions.push({\n          ...prev,\n          highlighted: false,\n          editingLabels: false,\n          x: prev.x * w1 + next.x * w2,\n          y: prev.y * w1 + next.y * w2\n        })\n        break\n      }\n      case \"box\": {\n        impliedRegions.push({\n          ...prev,\n          highlighted: false,\n          editingLabels: false,\n          x: prev.x * w1 + next.x * w2,\n          y: prev.y * w1 + next.y * w2,\n          w: prev.w * w1 + next.w * w2,\n          h: prev.h * w1 + next.h * w2\n        })\n        break\n      }\n      case \"polygon\": {\n        if (next.points.length === prev.points.length) {\n          impliedRegions.push({\n            ...prev,\n            highlighted: false,\n            editingLabels: false,\n            points: prev.points.map((pp, i) => [\n              pp[0] * w1 + next.points[i][0] * w2,\n              pp[1] * w1 + next.points[i][1] * w2\n            ])\n          })\n        } else {\n          impliedRegions.push(prev)\n        }\n        break\n      }\n    }\n  }\n\n  return impliedRegions\n}\n","// @flow\n\nimport { useMemo } from \"react\"\nimport type { MainLayoutVideoAnnotationState } from \"../Annotator/types\"\nimport getImpliedVideoRegions from \"../Annotator/reducers/get-implied-video-regions.js\"\n\nconst emptyArr = []\n\nexport default (state: MainLayoutVideoAnnotationState) => {\n  if (state.annotationType !== \"video\") return emptyArr\n  const { keyframes, currentVideoTime = 0 } = state\n  // TODO memoize\n  return useMemo(() => getImpliedVideoRegions(keyframes, currentVideoTime), [\n    keyframes,\n    currentVideoTime\n  ])\n}\n","// @flow\n\nimport React, { useState, useRef } from \"react\"\nimport Grid from \"@material-ui/core/Grid\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport Sidebar from \"../Sidebar\"\nimport ImageCanvas from \"../ImageCanvas\"\nimport Header from \"../Header\"\nimport IconTools from \"../IconTools\"\nimport styles from \"./styles\"\nimport type { MainLayoutState, Action } from \"./types\"\nimport useKey from \"use-key-hook\"\nimport classnames from \"classnames\"\nimport { useSettings } from \"../SettingsProvider\"\nimport SettingsDialog from \"../SettingsDialog\"\nimport Fullscreen from \"../Fullscreen\"\nimport getActiveImage from \"../Annotator/reducers/get-active-image\"\nimport useImpliedVideoRegions from \"./use-implied-video-regions\"\n\nconst useStyles = makeStyles(styles)\n\ntype Props = {\n  state: MainLayoutState,\n  dispatch: Action => any\n}\n\nexport const MainLayout = ({ state, dispatch }: Props) => {\n  const classes = useStyles()\n  const settings = useSettings()\n\n  const memoizedActionFns = useRef({})\n  const action = (type: string, ...params: Array<string>) => {\n    const fnKey = `${type}(${params.join(\",\")})`\n    if (memoizedActionFns.current[fnKey])\n      return memoizedActionFns.current[fnKey]\n\n    const fn = (...args: any) =>\n      params.length > 0\n        ? dispatch(\n            ({\n              type,\n              ...params.reduce((acc, p, i) => ((acc[p] = args[i]), acc), {})\n            }: any)\n          )\n        : dispatch({ type, ...args[0] })\n    memoizedActionFns.current[fnKey] = fn\n    return fn\n  }\n\n  const { currentImageIndex, activeImage } = getActiveImage(state)\n  let nextImage\n  if (currentImageIndex !== null) {\n    nextImage = state.images[currentImageIndex + 1]\n  }\n\n  useKey(() => dispatch({ type: \"CANCEL\" }), {\n    detectKeys: [27]\n  })\n\n  const isAVideoFrame = activeImage && activeImage.frameTime !== undefined\n\n  let impliedVideoRegions = useImpliedVideoRegions(state)\n\n  return (\n    <Fullscreen\n      enabled={state.fullScreen}\n      onChange={open => {\n        if (!open) {\n          action(\"HEADER_BUTTON_CLICKED\", \"buttonName\")(\"Exit Fullscreen\")\n        }\n      }}\n    >\n      <div\n        className={classnames(\n          classes.container,\n          state.fullScreen && \"Fullscreen\"\n        )}\n      >\n        <div className={classes.headerContainer}>\n          <Header\n            onHeaderButtonClick={action(\"HEADER_BUTTON_CLICKED\", \"buttonName\")}\n            videoMode={state.annotationType === \"video\"}\n            inFullScreen={state.fullScreen}\n            isAVideoFrame={isAVideoFrame}\n            nextVideoFrameHasRegions={\n              !nextImage || (nextImage.regions && nextImage.regions.length > 0)\n            }\n            videoDuration={state.videoDuration}\n            multipleImages={state.images && state.images.length > 1}\n            title={\n              state.annotationType === \"image\"\n                ? activeImage\n                  ? activeImage.name\n                  : \"No Image Selected\"\n                : state.videoName || \"\"\n            }\n            onChangeCurrentTime={action(\"CHANGE_VIDEO_TIME\", \"newTime\")}\n            videoPlaying={state.videoPlaying}\n            currentVideoTime={state.currentVideoTime}\n            keyframes={state.keyframes}\n          />\n        </div>\n        <div className={classes.workspace}>\n          <div className={classes.iconToolsContainer}>\n            <IconTools\n              enabledTools={state.enabledTools}\n              showTags={state.showTags}\n              selectedTool={state.selectedTool}\n              onClickTool={action(\"SELECT_TOOL\", \"selectedTool\")}\n            />\n          </div>\n          <div className={classes.imageCanvasContainer}>\n            {state.annotationType === \"image\" && !state.selectedImage ? (\n              <div className={classes.noImageSelected}>No Image Selected</div>\n            ) : (\n              <div style={{ height: \"100%\", width: \"100%\" }}>\n                <ImageCanvas\n                  {...settings}\n                  key={state.selectedImage}\n                  showTags={state.showTags}\n                  allowedArea={state.allowedArea}\n                  regionClsList={state.regionClsList}\n                  regionTagList={state.regionTagList}\n                  regions={\n                    state.annotationType === \"image\"\n                      ? activeImage.regions || []\n                      : impliedVideoRegions\n                  }\n                  realSize={activeImage ? activeImage.realSize : undefined}\n                  videoPlaying={state.videoPlaying}\n                  imageSrc={\n                    state.annotationType === \"image\"\n                      ? state.selectedImage\n                      : null\n                  }\n                  videoSrc={\n                    state.annotationType === \"video\" ? state.videoSrc : null\n                  }\n                  pointDistancePrecision={state.pointDistancePrecision}\n                  createWithPrimary={state.selectedTool.includes(\"create\")}\n                  dragWithPrimary={state.selectedTool === \"pan\"}\n                  zoomWithPrimary={state.selectedTool === \"zoom\"}\n                  showPointDistances={state.showPointDistances}\n                  pointDistancePrecision={state.pointDistancePrecision}\n                  videoTime={\n                    state.annotationType === \"image\"\n                      ? state.selectedImageFrameTime\n                      : state.currentVideoTime\n                  }\n                  onMouseMove={action(\"MOUSE_MOVE\")}\n                  onMouseDown={action(\"MOUSE_DOWN\")}\n                  onMouseUp={action(\"MOUSE_UP\")}\n                  onChangeRegion={action(\"CHANGE_REGION\", \"region\")}\n                  onBeginRegionEdit={action(\"OPEN_REGION_EDITOR\", \"region\")}\n                  onCloseRegionEdit={action(\"CLOSE_REGION_EDITOR\", \"region\")}\n                  onDeleteRegion={action(\"DELETE_REGION\", \"region\")}\n                  onBeginBoxTransform={action(\n                    \"BEGIN_BOX_TRANSFORM\",\n                    \"box\",\n                    \"directions\"\n                  )}\n                  onBeginMovePolygonPoint={action(\n                    \"BEGIN_MOVE_POLYGON_POINT\",\n                    \"polygon\",\n                    \"pointIndex\"\n                  )}\n                  onAddPolygonPoint={action(\n                    \"ADD_POLYGON_POINT\",\n                    \"polygon\",\n                    \"point\",\n                    \"pointIndex\"\n                  )}\n                  onSelectRegion={action(\"SELECT_REGION\", \"region\")}\n                  onBeginMovePoint={action(\"BEGIN_MOVE_POINT\", \"point\")}\n                  onImageOrVideoLoaded={action(\n                    \"IMAGE_OR_VIDEO_LOADED\",\n                    \"metadata\"\n                  )}\n                  onChangeVideoTime={action(\"CHANGE_VIDEO_TIME\", \"newTime\")}\n                  onChangeVideoPlaying={action(\n                    \"CHANGE_VIDEO_PLAYING\",\n                    \"isPlaying\"\n                  )}\n                />\n              </div>\n            )}\n          </div>\n          <div className={classes.sidebarContainer}>\n            <Sidebar\n              debug={window.localStorage.$ANNOTATE_DEBUG_MODE && state}\n              taskDescription={state.taskDescription}\n              images={state.images}\n              regions={activeImage ? activeImage.regions : null}\n              history={state.history}\n              currentImage={activeImage}\n              labelImages={state.labelImages}\n              imageClsList={state.imageClsList}\n              imageTagList={state.imageTagList}\n              keyframes={state.keyframes}\n              currentVideoTime={state.currentVideoTime}\n              onChangeImage={action(\"CHANGE_IMAGE\", \"delta\")}\n              onSelectRegion={action(\"SELECT_REGION\", \"region\")}\n              onDeleteRegion={action(\"DELETE_REGION\", \"region\")}\n              onSelectImage={action(\"SELECT_IMAGE\", \"image\")}\n              onChangeRegion={action(\"CHANGE_REGION\", \"region\")}\n              onRestoreHistory={action(\"RESTORE_HISTORY\")}\n              onChangeVideoTime={action(\"CHANGE_VIDEO_TIME\", \"newTime\")}\n              onDeleteKeyframe={action(\"DELETE_KEYFRAME\", \"time\")}\n            />\n          </div>\n        </div>\n        <SettingsDialog\n          open={state.settingsOpen}\n          onClose={() =>\n            dispatch({\n              type: \"HEADER_BUTTON_CLICKED\",\n              buttonName: \"Settings\"\n            })\n          }\n        />\n      </div>\n    </Fullscreen>\n  )\n}\n\nexport default MainLayout\n","// @flow\n\nimport type { MainLayoutState, Action } from \"../../MainLayout/types\"\nimport { setIn, updateIn, asMutable, without } from \"seamless-immutable\"\nimport moment from \"moment\"\n\nconst typesToSaveWithHistory = {\n  BEGIN_BOX_TRANSFORM: \"Transform/Move Box\",\n  BEGIN_MOVE_POINT: \"Move Point\",\n  DELETE_REGION: \"Delete Region\"\n}\n\nexport const saveToHistory = (state: MainLayoutState, name: string) =>\n  updateIn(state, [\"history\"], h =>\n    [\n      {\n        time: moment().toDate(),\n        state: without(state, \"history\"),\n        name\n      }\n    ].concat((h || []).slice(0, 9))\n  )\n\nexport default reducer => {\n  return (state: MainLayoutState, action: Action) => {\n    const prevState = state\n    const nextState = reducer(state, action)\n\n    if (action.type === \"RESTORE_HISTORY\") {\n      if (state.history.length > 0) {\n        return setIn(\n          nextState.history[0].state,\n          [\"history\"],\n          nextState.history.slice(1)\n        )\n      }\n    } else {\n      if (\n        prevState !== nextState &&\n        Object.keys(typesToSaveWithHistory).includes(action.type)\n      ) {\n        return setIn(\n          nextState,\n          [\"history\"],\n          [\n            {\n              time: moment().toDate(),\n              state: without(prevState, \"history\"),\n              name: typesToSaveWithHistory[action.type] || action.type\n            }\n          ]\n            .concat(nextState.history || [])\n            .slice(0, 9)\n        )\n      }\n    }\n\n    return nextState\n  }\n}\n","// @flow\n\nimport type { MainLayoutState, Action } from \"../../MainLayout/types\"\nimport { moveRegion } from \"../../ImageCanvas/region-tools.js\"\nimport { getIn, setIn, updateIn } from \"seamless-immutable\"\nimport moment from \"moment\"\nimport isEqual from \"lodash/isEqual\"\nimport getActiveImage from \"./get-active-image\"\nimport { saveToHistory } from \"./history-handler.js\"\n\nconst getRandomId = () =>\n  Math.random()\n    .toString()\n    .split(\".\")[1]\n\nconst getRandomInt = (min, max) => {\n  return Math.floor(Math.random() * (max - min + 1)) + min\n}\n\nconst getRandomColor = () => {\n  const h = getRandomInt(0, 360)\n  const s = 100\n  const l = 50\n  return `hsl(${h},${s}%,${l}%)`\n}\n\nexport default (state: MainLayoutState, action: Action) => {\n  // Throttle certain actions\n  if (action.type === \"MOUSE_MOVE\") {\n    if (Date.now() - ((state: any).lastMouseMoveCall || 0) < 16) return state\n    state = setIn(state, [\"lastMouseMoveCall\"], Date.now())\n  }\n  if (!action.type.includes(\"MOUSE\")) {\n    state = setIn(state, [\"lastAction\"], action)\n  }\n\n  const { currentImageIndex, pathToActiveImage, activeImage } = getActiveImage(\n    state\n  )\n\n  const getRegionIndex = region => {\n    const regionId = typeof region === \"string\" ? region : region.id\n    if (!activeImage) return null\n    const regionIndex = (activeImage.regions || []).findIndex(\n      r => r.id === regionId\n    )\n    return regionIndex === -1 ? null : regionIndex\n  }\n  const getRegion = regionId => {\n    if (!activeImage) return null\n    const regionIndex = getRegionIndex(regionId)\n    if (regionIndex === null) return [null, null]\n    const region = activeImage.regions[regionIndex]\n    return [region, regionIndex]\n  }\n  const modifyRegion = (regionId, obj) => {\n    const [region, regionIndex] = getRegion(regionId)\n    if (!region) return state\n    if (obj !== null) {\n      return setIn(state, [...pathToActiveImage, \"regions\", regionIndex], {\n        ...region,\n        ...obj\n      })\n    } else {\n      // delete region\n      const regions = activeImage.regions\n      return setIn(\n        state,\n        [...pathToActiveImage, \"regions\"],\n        (regions || []).filter(r => r.id !== region.id)\n      )\n    }\n  }\n  const unselectRegions = (state: MainLayoutState) => {\n    if (!activeImage) return state\n    return setIn(\n      state,\n      [...pathToActiveImage, \"regions\"],\n      (activeImage.regions || []).map(r => ({\n        ...r,\n        highlighted: false\n      }))\n    )\n  }\n\n  const closeEditors = (state: MainLayoutState) => {\n    if (currentImageIndex === null) return state\n    return setIn(\n      state,\n      [...pathToActiveImage, \"regions\"],\n      (activeImage.regions || []).map(r => ({\n        ...r,\n        editingLabels: false\n      }))\n    )\n  }\n\n  const setNewImage = (img: string | Object) => {\n    let { src, frameTime } = typeof img === \"object\" ? img : { src: img }\n    return setIn(\n      setIn(state, [\"selectedImage\"], src),\n      [\"selectedImageFrameTime\"],\n      frameTime\n    )\n  }\n\n  switch (action.type) {\n    case \"@@INIT\": {\n      return state\n    }\n    case \"SELECT_IMAGE\": {\n      return setNewImage(action.image)\n    }\n    case \"CHANGE_REGION\": {\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      const oldRegion = activeImage.regions[regionIndex]\n      if (oldRegion.cls !== action.region.cls) {\n        state = saveToHistory(state, \"Change Region Classification\")\n      }\n      if (!isEqual(oldRegion.tags, action.region.tags)) {\n        state = saveToHistory(state, \"Change Region Tags\")\n      }\n      return setIn(\n        state,\n        [...pathToActiveImage, \"regions\", regionIndex],\n        action.region\n      )\n    }\n    case \"CHANGE_IMAGE\": {\n      if (!activeImage) return state\n      const { delta } = action\n      for (const key of Object.keys(delta)) {\n        if (key === \"cls\") saveToHistory(state, \"Change Image Class\")\n        if (key === \"tags\") saveToHistory(state, \"Change Image Tags\")\n        state = setIn(state, [...pathToActiveImage, key], delta[key])\n      }\n      return state\n    }\n    case \"SELECT_REGION\": {\n      const { region } = action\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      const regions = [...(activeImage.regions || [])].map(r => ({\n        ...r,\n        highlighted: r.id === region.id,\n        editingLabels: r.id === region.id\n      }))\n      return setIn(state, [...pathToActiveImage, \"regions\"], regions)\n    }\n    case \"BEGIN_MOVE_POINT\": {\n      state = closeEditors(state)\n      return setIn(state, [\"mode\"], {\n        mode: \"MOVE_REGION\",\n        regionId: action.point.id\n      })\n    }\n    case \"BEGIN_BOX_TRANSFORM\": {\n      const { box, directions } = action\n      state = closeEditors(state)\n      if (directions[0] === 0 && directions[1] === 0) {\n        return setIn(state, [\"mode\"], { mode: \"MOVE_REGION\", regionId: box.id })\n      } else {\n        return setIn(state, [\"mode\"], {\n          mode: \"RESIZE_BOX\",\n          regionId: box.id,\n          freedom: directions,\n          original: { x: box.x, y: box.y, w: box.w, h: box.h }\n        })\n      }\n    }\n    case \"BEGIN_MOVE_POLYGON_POINT\": {\n      const { polygon, pointIndex } = action\n      state = closeEditors(state)\n      if (\n        state.mode &&\n        state.mode.mode === \"DRAW_POLYGON\" &&\n        pointIndex === 0\n      ) {\n        return setIn(\n          modifyRegion(polygon, {\n            points: polygon.points.slice(0, -1),\n            open: false\n          }),\n          [\"mode\"],\n          null\n        )\n      } else {\n        state = saveToHistory(state, \"Move Polygon Point\")\n      }\n      return setIn(state, [\"mode\"], {\n        mode: \"MOVE_POLYGON_POINT\",\n        regionId: polygon.id,\n        pointIndex\n      })\n    }\n    case \"ADD_POLYGON_POINT\": {\n      const { polygon, point, pointIndex } = action\n      const regionIndex = getRegionIndex(polygon)\n      if (regionIndex === null) return state\n      const points = [...polygon.points]\n      points.splice(pointIndex, 0, point)\n      return setIn(state, [...pathToActiveImage, \"regions\", regionIndex], {\n        ...polygon,\n        points\n      })\n    }\n    case \"MOUSE_MOVE\": {\n      const { x, y } = action\n      if (!state.mode) return state\n      if (!activeImage) return state\n      switch (state.mode.mode) {\n        case \"MOVE_POLYGON_POINT\": {\n          const { pointIndex, regionId } = state.mode\n          const regionIndex = getRegionIndex(regionId)\n          if (regionIndex === null) return state\n          return setIn(\n            state,\n            [\n              ...pathToActiveImage,\n              \"regions\",\n              regionIndex,\n              \"points\",\n              pointIndex\n            ],\n            [x, y]\n          )\n        }\n        case \"MOVE_REGION\": {\n          const { regionId } = state.mode\n          const regionIndex = getRegionIndex(regionId)\n          if (regionIndex === null) return state\n          return setIn(\n            state,\n            [...pathToActiveImage, \"regions\", regionIndex],\n            moveRegion(activeImage.regions[regionIndex], x, y)\n          )\n        }\n        case \"RESIZE_BOX\": {\n          const {\n            regionId,\n            freedom: [xFree, yFree],\n            original: { x: ox, y: oy, w: ow, h: oh }\n          } = state.mode\n          const regionIndex = getRegionIndex(regionId)\n          if (regionIndex === null) return state\n          const box = activeImage.regions[regionIndex]\n\n          const dx = xFree === 0 ? ox : xFree === -1 ? Math.min(ox + ow, x) : ox\n          const dw =\n            xFree === 0\n              ? ow\n              : xFree === -1\n              ? ow + (ox - dx)\n              : Math.max(0, ow + (x - ox - ow))\n          const dy = yFree === 0 ? oy : yFree === -1 ? Math.min(oy + oh, y) : oy\n          const dh =\n            yFree === 0\n              ? oh\n              : yFree === -1\n              ? oh + (oy - dy)\n              : Math.max(0, oh + (y - oy - oh))\n\n          // determine if we should switch the freedom\n          if (dw <= 0.001) {\n            state = setIn(state, [\"mode\", \"freedom\"], [xFree * -1, yFree])\n          }\n          if (dh <= 0.001) {\n            state = setIn(state, [\"mode\", \"freedom\"], [xFree, yFree * -1])\n          }\n\n          return setIn(state, [...pathToActiveImage, \"regions\", regionIndex], {\n            ...box,\n            x: dx,\n            w: dw,\n            y: dy,\n            h: dh\n          })\n        }\n        case \"DRAW_POLYGON\": {\n          const { regionId } = state.mode\n          const [region, regionIndex] = getRegion(regionId)\n          if (!region) return setIn(state, [\"mode\"], null)\n          return setIn(\n            state,\n            [\n              ...pathToActiveImage,\n              \"regions\",\n              regionIndex,\n              \"points\",\n              (region: any).points.length - 1\n            ],\n            [x, y]\n          )\n        }\n      }\n      return state\n    }\n    case \"MOUSE_DOWN\": {\n      if (!activeImage) return state\n      const { x, y } = action\n\n      let newRegion\n      if (state.allowedArea) {\n        const aa = state.allowedArea\n        if (x < aa.x || x > aa.x + aa.w || y < aa.y || y > aa.y + aa.h) {\n          return state\n        }\n      }\n\n      switch (state.selectedTool) {\n        case \"create-point\": {\n          state = saveToHistory(state, \"Create Point\")\n          newRegion = {\n            type: \"point\",\n            x,\n            y,\n            highlighted: true,\n            editingLabels: true,\n            color: getRandomColor(),\n            id: getRandomId()\n          }\n          break\n        }\n        case \"create-box\": {\n          state = saveToHistory(state, \"Create Box\")\n          newRegion = {\n            type: \"box\",\n            x: x,\n            y: y,\n            w: 0.01,\n            h: 0.01,\n            highlighted: true,\n            editingLabels: false,\n            color: getRandomColor(),\n            id: getRandomId()\n          }\n          state = unselectRegions(state)\n          state = setIn(state, [\"mode\"], {\n            mode: \"RESIZE_BOX\",\n            editLabelEditorAfter: true,\n            regionId: newRegion.id,\n            freedom: [1, 1],\n            original: { x, y, w: newRegion.w, h: newRegion.h },\n            isNew: true\n          })\n          break\n        }\n        case \"create-polygon\": {\n          if (state.mode && state.mode.mode === \"DRAW_POLYGON\") break\n          state = saveToHistory(state, \"Create Polygon\")\n          newRegion = {\n            type: \"polygon\",\n            points: [[x, y], [x, y]],\n            open: true,\n            highlighted: true,\n            color: getRandomColor(),\n            id: getRandomId()\n          }\n          state = setIn(state, [\"mode\"], {\n            mode: \"DRAW_POLYGON\",\n            regionId: newRegion.id\n          })\n          break\n        }\n      }\n\n      if (newRegion) {\n        state = unselectRegions(state)\n      }\n\n      if (state.mode) {\n        switch (state.mode.mode) {\n          case \"DRAW_POLYGON\": {\n            const [polygon, regionIndex] = getRegion(state.mode.regionId)\n            if (!polygon) break\n            return setIn(\n              state,\n              [...pathToActiveImage, \"regions\", regionIndex],\n              { ...polygon, points: polygon.points.concat([[x, y]]) }\n            )\n          }\n        }\n      }\n\n      const regions = [...(activeImage.regions || [])]\n        .map(r => ({\n          ...r,\n          editingLabels: false\n        }))\n        .concat(newRegion ? [newRegion] : [])\n\n      return setIn(state, [...pathToActiveImage, \"regions\"], regions)\n    }\n    case \"MOUSE_UP\": {\n      const { x, y } = action\n      if (!state.mode) return state\n      switch (state.mode.mode) {\n        case \"RESIZE_BOX\": {\n          if (state.mode.isNew) {\n            if (\n              Math.abs(state.mode.original.x - x) < 0.01 &&\n              Math.abs(state.mode.original.y - y) < 0.01\n            ) {\n              return setIn(\n                modifyRegion(state.mode.regionId, null),\n                [\"mode\"],\n                null\n              )\n            }\n          }\n          if (state.mode.editLabelEditorAfter) {\n            return {\n              ...modifyRegion(state.mode.regionId, { editingLabels: true }),\n              mode: null\n            }\n          }\n        }\n        case \"MOVE_REGION\":\n        case \"MOVE_POLYGON_POINT\": {\n          return { ...state, mode: null }\n        }\n      }\n      return state\n    }\n    case \"CHANGE_REGION\": {\n      const { region } = action\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      return setIn(\n        state,\n        [...pathToActiveImage, \"regions\", regionIndex],\n        region\n      )\n    }\n    case \"OPEN_REGION_EDITOR\": {\n      const { region } = action\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      const newRegions = setIn(\n        activeImage.regions.map(r => ({\n          ...r,\n          highlighted: false,\n          editingLabels: false\n        })),\n        [regionIndex],\n        {\n          ...(activeImage.regions || [])[regionIndex],\n          highlighted: true,\n          editingLabels: true\n        }\n      )\n      return setIn(state, [...pathToActiveImage, \"regions\"], newRegions)\n    }\n    case \"CLOSE_REGION_EDITOR\": {\n      const { region } = action\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      return setIn(state, [...pathToActiveImage, \"regions\", regionIndex], {\n        ...(activeImage.regions || [])[regionIndex],\n        editingLabels: false\n      })\n    }\n    case \"DELETE_REGION\": {\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      return setIn(\n        state,\n        [...pathToActiveImage, \"regions\"],\n        (activeImage.regions || []).filter(r => r.id !== action.region.id)\n      )\n    }\n    case \"HEADER_BUTTON_CLICKED\": {\n      const buttonName = action.buttonName.toLowerCase()\n      switch (buttonName) {\n        case \"prev\": {\n          if (currentImageIndex === null) return state\n          if (currentImageIndex === 0) return state\n          return setNewImage(state.images[currentImageIndex - 1])\n        }\n        case \"next\": {\n          if (currentImageIndex === null) return state\n          if (currentImageIndex === state.images.length - 1) return state\n          return setNewImage(state.images[currentImageIndex + 1])\n        }\n        case \"clone\": {\n          if (currentImageIndex === null) return state\n          if (currentImageIndex === state.images.length - 1) return state\n          return setIn(\n            setNewImage(state.images[currentImageIndex + 1]),\n            [\"images\", currentImageIndex + 1, \"regions\"],\n            activeImage.regions\n          )\n        }\n        case \"settings\": {\n          return setIn(state, [\"settingsOpen\"], !state.settingsOpen)\n        }\n        case \"help\": {\n          return state\n        }\n        case \"fullscreen\": {\n          return setIn(state, [\"fullScreen\"], true)\n        }\n        case \"exit fullscreen\":\n        case \"window\": {\n          return setIn(state, [\"fullScreen\"], false)\n        }\n        case \"hotkeys\": {\n          return state\n        }\n        case \"exit\":\n        case \"done\": {\n          return state\n        }\n      }\n      return state\n    }\n    case \"SELECT_TOOL\": {\n      state = setIn(state, [\"mode\"], null)\n      if (action.selectedTool === \"show-tags\") {\n        return setIn(state, [\"showTags\"], !state.showTags)\n      }\n      return setIn(state, [\"selectedTool\"], action.selectedTool)\n    }\n    case \"CANCEL\": {\n      const { mode } = state\n      if (mode) {\n        switch (mode.mode) {\n          case \"DRAW_POLYGON\": {\n            const { regionId } = mode\n            return modifyRegion(regionId, null)\n          }\n          case \"MOVE_POLYGON_POINT\":\n          case \"RESIZE_BOX\":\n          case \"MOVE_REGION\": {\n            return setIn(state, [\"mode\"], null)\n          }\n        }\n      }\n      // Close any open boxes\n      const regions: any = activeImage.regions\n      if (regions.some(r => r.editingLabels)) {\n        return setIn(\n          state,\n          [...pathToActiveImage, \"regions\"],\n          regions.map(r => ({\n            ...r,\n            editingLabels: false\n          }))\n        )\n      } else {\n        return setIn(\n          state,\n          [...pathToActiveImage, \"regions\"],\n          regions.map(r => ({\n            ...r,\n            highlighted: false\n          }))\n        )\n      }\n    }\n  }\n  return state\n}\n","// @flow\n\nimport type {\n  MainLayoutImageAnnotationState,\n  Action\n} from \"../../MainLayout/types\"\nimport { setIn } from \"seamless-immutable\"\nimport getActiveImage from \"./get-active-image\"\n\nexport default (state: MainLayoutImageAnnotationState, action: Action) => {\n  const { currentImageIndex, pathToActiveImage, activeImage } = getActiveImage(\n    state\n  )\n\n  switch (action.type) {\n    case \"IMAGE_LOADED\": {\n      return setIn(state, [\"images\", currentImageIndex, \"pixelSize\"], {\n        w: action.image.width,\n        h: action.image.height\n      })\n    }\n  }\n  return state\n}\n","// @flow\n\nimport type {\n  MainLayoutVideoAnnotationState,\n  Action\n} from \"../../MainLayout/types\"\nimport { setIn, without } from \"seamless-immutable\"\nimport getImpliedVideoRegions from \"./get-implied-video-regions\"\nimport { saveToHistory } from \"./history-handler.js\"\n\nexport default (state: MainLayoutVideoAnnotationState, action: Action) => {\n  const copyImpliedRegions = () => {\n    return setIn(\n      saveToHistory(state, \"Add Keyframe\"),\n      [\"keyframes\", state.currentVideoTime],\n      {\n        regions: getImpliedVideoRegions(state.keyframes, state.currentVideoTime)\n      }\n    )\n  }\n\n  switch (action.type) {\n    case \"IMAGE_OR_VIDEO_LOADED\": {\n      const { duration } = action.metadata\n      if (typeof duration === \"number\") {\n        return setIn(state, [\"videoDuration\"], duration * 1000)\n      }\n    }\n    case \"HEADER_BUTTON_CLICKED\": {\n      switch (action.buttonName.toLowerCase()) {\n        case \"play\":\n          return setIn(state, [\"videoPlaying\"], true)\n        case \"pause\":\n          return setIn(state, [\"videoPlaying\"], false)\n      }\n    }\n    case \"CHANGE_VIDEO_TIME\": {\n      return setIn(state, [\"currentVideoTime\"], action.newTime)\n    }\n    case \"CHANGE_VIDEO_PLAYING\": {\n      return setIn(state, [\"videoPlaying\"], action.isPlaying)\n    }\n    case \"DELETE_KEYFRAME\": {\n      return setIn(state, [\"keyframes\"], without(state.keyframes, action.time))\n    }\n  }\n\n  // Before the user modifies regions, copy the interpolated regions over to a\n  // new keyframe\n  if (!state.keyframes[state.currentVideoTime]) {\n    switch (action.type) {\n      case \"BEGIN_BOX_TRANSFORM\":\n      case \"BEGIN_MOVE_POINT\":\n      case \"BEGIN_MOVE_POLYGON_POINT\":\n      case \"BEGIN_BOX_TRANSFORM\":\n      case \"BEGIN_MOVE_POLYGON_POINT\":\n      case \"ADD_POLYGON_POINT\":\n      case \"SELECT_REGION\":\n      case \"CHANGE_REGION\":\n      case \"DELETE_REGION\":\n      case \"OPEN_REGION_EDITOR\":\n        return copyImpliedRegions()\n      case \"MOUSE_DOWN\": {\n        switch (state.selectedTool) {\n          case \"create-point\":\n          case \"create-polygon\":\n          case \"create-box\":\n            return copyImpliedRegions()\n        }\n      }\n    }\n  }\n\n  return state\n}\n","// @flow\n\nimport React, { useReducer } from \"react\"\nimport MainLayout from \"../MainLayout\"\nimport type {\n  ToolEnum,\n  Image,\n  Mode,\n  MainLayoutState,\n  Action\n} from \"../MainLayout/types\"\nimport SettingsProvider from \"../SettingsProvider\"\n\nimport combineReducers from \"./reducers/combine-reducers.js\"\nimport generalReducer from \"./reducers/general-reducer.js\"\nimport imageReducer from \"./reducers/image-reducer.js\"\nimport videoReducer from \"./reducers/video-reducer.js\"\nimport historyHandler from \"./reducers/history-handler.js\"\nimport useEventCallback from \"use-event-callback\"\n\nimport makeImmutable, { without } from \"seamless-immutable\"\n\ntype Props = {\n  taskDescription: string,\n  allowedArea?: { x: number, y: number, w: number, h: number },\n  regionTagList?: Array<string>,\n  regionClsList?: Array<string>,\n  imageTagList?: Array<string>,\n  imageClsList?: Array<string>,\n  enabledTools?: Array<string>,\n  showTags?: boolean,\n  selectedImage?: string,\n  images?: Array<Image>,\n  showPointDistances?: boolean,\n  pointDistancePrecision?: number,\n  onExit: MainLayoutState => any,\n  videoTime?: number,\n  videoSrc?: string,\n  keyframes?: Object,\n  videoName?: string\n}\n\nexport const Annotator = ({\n  images,\n  allowedArea,\n  selectedImage = images && images.length > 0 ? images[0].src : undefined,\n  showPointDistances,\n  pointDistancePrecision,\n  showTags = true,\n  enabledTools = [\"select\", \"create-point\", \"create-box\", \"create-polygon\"],\n  regionTagList = [],\n  regionClsList = [],\n  imageTagList = [],\n  imageClsList = [],\n  keyframes = {},\n  taskDescription,\n  videoSrc,\n  videoTime = 0,\n  videoName,\n  onExit\n}: Props) => {\n  if (!images && !videoSrc)\n    return 'Missing required prop \"images\" or \"videoSrc\"'\n  const annotationType = images ? \"image\" : \"video\"\n  const [state, dispatchToReducer] = useReducer(\n    historyHandler(\n      combineReducers(\n        annotationType === \"image\" ? imageReducer : videoReducer,\n        generalReducer\n      )\n    ),\n    makeImmutable({\n      annotationType,\n      showTags,\n      allowedArea,\n      showPointDistances,\n      pointDistancePrecision,\n      selectedTool: \"select\",\n      mode: null,\n      taskDescription,\n      labelImages: imageClsList.length > 0 || imageTagList.length > 0,\n      regionClsList,\n      regionTagList,\n      imageClsList,\n      imageTagList,\n      currentVideoTime: videoTime,\n      enabledTools,\n      history: [],\n      videoName,\n      ...(annotationType === \"image\"\n        ? {\n            selectedImage,\n            images,\n            selectedImageFrameTime:\n              images && images.length > 0 ? images[0].frameTime : undefined\n          }\n        : {\n            videoSrc,\n            keyframes\n          })\n    })\n  )\n\n  const dispatch = useEventCallback((action: Action) => {\n    if (\n      action.type === \"HEADER_BUTTON_CLICKED\" &&\n      [\"Exit\", \"Done\", \"Save\", \"Complete\"].includes(action.buttonName)\n    ) {\n      onExit(without(state, \"history\"))\n    } else {\n      dispatchToReducer(action)\n    }\n  })\n\n  return (\n    <SettingsProvider>\n      <MainLayout state={state} dispatch={dispatch} />\n    </SettingsProvider>\n  )\n}\n\nexport default Annotator\n","export default (...reducers) => (state, action) => {\n  for (const reducer of reducers) {\n    state = reducer(state, action)\n  }\n  return state\n}\n","// @flow\n\nimport React, { Component } from \"react\"\nimport Dialog from \"@material-ui/core/Dialog\"\nimport Button from \"@material-ui/core/Button\"\nimport DialogTitle from \"@material-ui/core/DialogTitle\"\nimport DialogContent from \"@material-ui/core/DialogContent\"\nimport DialogActions from \"@material-ui/core/DialogActions\"\n\nexport default class ErrorBoundaryDialog extends Component {\n  state = { hasError: false, err: \"\" }\n  componentDidCatch(err, info) {\n    this.setState({\n      hasError: true,\n      err: err.toString() + \"\\n\\n\" + info.componentStack\n    })\n  }\n  render() {\n    if (this.state.hasError) {\n      return (\n        <Dialog open={this.state.hasError} onClose={this.props.onClose}>\n          <DialogTitle>Error Loading Annotator</DialogTitle>\n          <DialogContent>\n            <pre>{this.state.err}</pre>\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={this.props.onClose}>Close</Button>\n          </DialogActions>\n        </Dialog>\n      )\n    }\n    return this.props.children\n  }\n}\n","// @flow\nimport React, { useState } from \"react\"\nimport ReactDOM from \"react-dom\"\nimport Editor, { examples } from \"./Editor\"\nimport Annotator from \"../Annotator\"\nimport ErrorBoundaryDialog from \"./ErrorBoundaryDialog.js\"\n\nexport default () => {\n  const [annotatorOpen, changeAnnotatorOpen] = useState(false)\n  const [annotatorProps, changeAnnotatorProps] = useState(examples[\"Custom\"]())\n  const [lastOutput, changeLastOutput] = useState()\n\n  return (\n    <div>\n      {annotatorOpen ? (\n        <ErrorBoundaryDialog\n          onClose={() => {\n            changeAnnotatorOpen(false)\n          }}\n        >\n          <Annotator\n            {...(annotatorProps: any)}\n            onExit={output => {\n              delete (output: any)[\"lastAction\"]\n              changeLastOutput(output)\n              changeAnnotatorOpen(false)\n            }}\n          />\n        </ErrorBoundaryDialog>\n      ) : (\n        <Editor\n          lastOutput={lastOutput}\n          onOpenAnnotator={props => {\n            changeAnnotatorProps(props)\n            changeAnnotatorOpen(true)\n          }}\n        />\n      )}\n    </div>\n  )\n}\n","// @flow\n\nimport React from \"react\"\nimport Button from \"@material-ui/core/Button\"\nimport { styled } from \"@material-ui/core/styles\"\nimport * as colors from \"@material-ui/core/colors\"\nimport Grid from \"@material-ui/core/Grid\"\nimport Markdown from \"react-markdown\"\nimport GitHubButton from \"react-github-btn\"\nimport \"./github-markdown.css\"\nimport raw from \"raw.macro\"\nimport { Prism as SyntaxHighlighter } from \"react-syntax-highlighter\"\nimport { docco } from \"react-syntax-highlighter/dist/cjs/languages/hljs/javascript\"\n\nconst contentMd = raw(\"./content.md\")\n\nconst RootContainer = styled(\"div\")({\n  display: \"flex\",\n  flexDirection: \"column\",\n  alignItems: \"center\"\n})\nconst ContentContainer = styled(\"div\")({\n  width: \"100%\",\n  boxSizing: \"border-box\",\n  display: \"flex\",\n  flexDirection: \"column\",\n  maxWidth: 1200\n})\nconst Header = styled(\"div\")({\n  width: \"100%\",\n  display: \"flex\",\n  justifyContent: \"center\",\n  backgroundColor: colors.blue[600],\n  padding: 8,\n  boxSizing: \"border-box\"\n})\nconst HeaderButton = styled(Button)({\n  color: \"white\",\n  margin: 8,\n  padding: 16,\n  paddingLeft: 24,\n  paddingRight: 24\n})\nconst Hero = styled(\"div\")({\n  display: \"flex\",\n  justifyContent: \"center\",\n  width: \"100%\",\n  backgroundColor: colors.blue[500],\n  padding: 16,\n  color: \"white\",\n  boxSizing: \"border-box\"\n})\nconst HeroMain = styled(\"div\")({\n  fontSize: 48,\n  fontWeight: \"bold\",\n  paddingTop: 64,\n  textShadow: \"0px 1px 5px rgba(0,0,0,0.3)\"\n})\nconst HeroSub = styled(\"div\")({\n  paddingTop: 32,\n  lineHeight: 1.5,\n  fontSize: 24,\n  textShadow: \"0px 1px 3px rgba(0,0,0,0.2)\"\n})\nconst HeroButtons = styled(\"div\")({\n  paddingTop: 32,\n  paddingBottom: 48\n})\nconst Section = styled(\"div\")({\n  display: \"flex\",\n  padding: 16,\n  paddingTop: 32,\n  flexDirection: \"column\"\n})\n\nconst CodeBlock = ({ language, value }) => {\n  return (\n    <SyntaxHighlighter language={language} style={docco}>\n      {value}\n    </SyntaxHighlighter>\n  )\n}\n\nfunction flatten(text, child) {\n  return typeof child === \"string\"\n    ? text + child\n    : React.Children.toArray(child.props.children).reduce(flatten, text)\n}\n\nfunction HeadingRenderer(props) {\n  var children = React.Children.toArray(props.children)\n  var text = children.reduce(flatten, \"\")\n  var slug = text.toLowerCase().replace(/\\W/g, \"-\")\n  return React.createElement(\"h\" + props.level, { id: slug }, props.children)\n}\n\nconst LandingPage = () => {\n  return (\n    <RootContainer>\n      <Header id=\"about\">\n        <ContentContainer style={{ flexDirection: \"row\", flexGrow: 1 }}>\n          <HeaderButton href=\"#features\">Features</HeaderButton>\n          <HeaderButton href=\"#usage\">Usage</HeaderButton>\n          <HeaderButton href=\"#props\">Props</HeaderButton>\n          <HeaderButton href=\"./demo\">Demo Playground</HeaderButton>\n        </ContentContainer>\n      </Header>\n      <Hero>\n        <ContentContainer>\n          <HeroMain>React Image Annotate</HeroMain>\n          <HeroSub>\n            Powerful React component for image annotations with bounding boxes,\n            tagging, classification, multiple images and polygon segmentation.\n          </HeroSub>\n          <HeroButtons>\n            <GitHubButton\n              href=\"https://github.com/waoai/react-image-annotate\"\n              data-size=\"large\"\n              data-show-count=\"true\"\n              aria-label=\"Star waoai/react-image-annotate on GitHub\"\n            >\n              Star\n            </GitHubButton>\n          </HeroButtons>\n        </ContentContainer>\n      </Hero>\n      <ContentContainer className=\"markdown-body\">\n        <Section className=\"markdown-body\">\n          <Markdown\n            escapeHtml={false}\n            source={contentMd}\n            renderers={{\n              code: CodeBlock,\n              heading: HeadingRenderer\n            }}\n          />\n        </Section>\n      </ContentContainer>\n    </RootContainer>\n  )\n}\n\nexport default LandingPage\n","// @flow\n\nimport React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport Theme from \"./Theme\"\nimport DemoSite from \"./DemoSite\"\nimport LandingPage from \"./LandingPage\"\nimport \"./site.css\"\n\nconst Site = () => {\n  const path = window.location.pathname\n    .replace(/\\/$/, \"\")\n    .split(\"/\")\n    .slice(-1)[0]\n  return <Theme>{path === \"demo\" ? <DemoSite /> : <LandingPage />}</Theme>\n}\n\nReactDOM.render(<Site />, document.getElementById(\"root\"))\n"],"sourceRoot":""}
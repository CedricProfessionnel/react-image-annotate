{"version":3,"sources":["Theme/index.js","DemoSite/Editor.js","SidebarBoxContainer/index.js","TaskDescriptionSidebarBox/index.js","ImageSelectorSidebarBox/index.js","RegionSelectorSidebarBox/styles.js","RegionSelectorSidebarBox/index.js","HistorySidebarBox/index.js","DebugSidebarBox/index.js","TagsSidebarBox/index.js","Sidebar/index.js","Crosshairs/index.js","RegionLabel/styles.js","RegionLabel/index.js","ImageCanvas/index.js","ImageCanvas/styles.js","ImageCanvas/region-tools.js","ImageCanvas/xpattern.js","HeaderButton/index.js","Header/styles.js","Header/index.js","SmallToolButton/index.js","IconTools/index.js","MainLayout/styles.js","SettingsProvider/index.js","SettingsDialog/index.js","MainLayout/index.js","Annotator/reducer.js","Annotator/index.js","DemoSite/ErrorBoundaryDialog.js","index.js","DemoSite/index.js"],"names":["useStyles","makeStyles","container","fontFamily","theme","createMuiTheme","typography","overrides","MuiButton","root","textTransform","editBar","padding","borderBottom","backgroundColor","display","alignItems","& .button","margin","select","width","fontSize","contentArea","specificationArea","loadSavedInput","JSON","parse","window","localStorage","getItem","e","examples","Simple Bounding Box","taskDescription","regionTagList","regionClsList","enabledTools","images","src","name","Custom","Editor","_ref","onOpenAnnotator","lastOutput","c","_useState","useState","_useState2","Object","slicedToArray","selectedExample","changeSelectedExample","_useState3","_useState4","outputDialogOpen","changeOutputOpen","_useState5","stringify","_useState6","currentJSONValue","changeCurrentJSONValue","react_default","a","createElement","className","style","flexGrow","react_select_esm","value","label","options","keys","map","s","onChange","selectedOption","Button_default","disabled","onClick","variant","lib_default","language","code","setItem","height","default_highlight","Dialog_default","fullScreen","open","DialogTitle_default","DialogContent_default","minWidth","DialogActions_default","header","flexDirection","paddingLeft","paddingRight","title","fontWeight","color","grey","& span","expandButton","& .icon","marginTop","transition","&.expanded","transform","expandedContent","maxHeight","overflowY","&.noScroll","overflow","SidebarBoxContainer","icon","subTitle","children","_ref$noScroll","noScroll","_ref$expandedByDefaul","expandedByDefault","classes","content","classnames","expanded","changeExpanded","Paper_default","IconButton_default","ExpandMore_default","Collapse_default","in","markdownContainer","& h1","& h2","& h3","& h4","& h5","& h6","& p","& a","& img","TaskDescriptionSidebarBox","description","Description_default","react_markdown_default","source","img","borderRadius","ImageSelectorSidebarBox","onSelect","concat","length","Collections_default","List_default","i","ListItem_default","button","dense","key","ListItemText_default","primary","secondary","regions","styles","& .icon2","opacity","&:hover","cursor","row","&.header:hover","&.highlighted","blue","chip","& .color","marginRight","& .text","Chip","text","Row","_ref2","highlighted","order","classification","area","trash","tags","lock","visible","changeMouseOver","onMouseEnter","onMouseLeave","Grid_default","item","xs","textAlign","RegionSelectorSidebarBox","_ref3","onDeleteRegion","onChangeRegion","onSelectRegion","PictureInPicture_default","RegionSelectorSidebarBox_Row","SwapVert_default","PieChart_default","Delete_default","Lock_default","Visibility_default","borderTop","marginBottom","r","id","RegionSelectorSidebarBox_Chip","cls","locked","objectSpread","LockOpen_default","undefined","VisibilityOff_default","emptyText","HistorySidebarBox","history","onRestoreHistory","History_default","time","moment","format","ListItemSecondaryAction_default","Undo_default","DebugSidebarBox","state","lastAction","image","find","selectedImage","region","mode","TagsSidebarBox","currentImage","_ref$imageClsList","imageClsList","_ref$imageTagList","imageTagList","onChangeImage","_currentImage$tags","_currentImage$cls","Style_default","placeholder","o","paddingTop","isMulti","Sidebar","debug","labelImages","onSelectImage","Crosshairs","mousePosition","x","y","changeForceRenderState","current","useEffect","interval","setInterval","clearInterval","react","position","left","pointerEvents","top","RegionLabel_styles","regionInfo","& .name","& .circle","boxShadow","& .tags","& .tag","textDecoration","RegionLabel","editing","_ref$allowedClasses","allowedClasses","_ref$allowedTags","allowedTags","onDelete","onClose","onOpen","textShadow","type","tabIndex","size","newTags","t","Check_default","@keyframes borderDance","from","strokeDashoffset","to","highlightBox","&:not(.highlighted)","&:not(.highlighted):hover","& path","vectorEffect","strokeWidth","stroke","fill","strokeDasharray","animationName","animationDuration","animationTimingFunction","animationIterationCount","animationPlayState","canvas","transformGrabber","border","zoomIndicator","bottom","right","boxCursorMap","getDefaultMat","Matrix","ImageCanvas","imageSrc","showTags","_ref$onMouseMove","onMouseMove","p","_ref$onMouseDown","onMouseDown","_ref$onMouseUp","onMouseUp","_ref$dragWithPrimary","dragWithPrimary","_ref$zoomWithPrimary","zoomWithPrimary","_ref$createWithPrimar","createWithPrimary","showCrosshairs","allowedArea","onBeginRegionEdit","onCloseRegionEdit","onBeginBoxTransform","onBeginMovePolygonPoint","onAddPolygonPoint","onBeginMovePoint","canvasEl","useRef","layoutParams","excludePattern","changeImageLoaded","dragging","changeDragging","maskImagesLoaded","changeMaskImagesLoaded","_useState7","_useState8","zoomStart","changeZoomStart","_useState9","_useState10","zoomEnd","changeZoomEnd","prevMousePosition","_useState11","_useState12","mat","changeMat","maskImages","projectRegionBox","applyToPoint","_layoutParams$current","iw","ih","bbox","box","Math","min","apply","toConsumableArray","points","_ref4","w","h","max","_ref5","_ref6","_ref7","_ref8","sx","sy","_ref9","_ref10","_ref11","_ref12","_ref13","_ref14","_ref15","_ref16","Error","getEnclosingBox","cbox","clone","inverse","d","useLayoutEffect","Image","onload","clientWidth","clientHeight","context","getContext","pattern","createPattern","save","toArray","fitScale","naturalWidth","naturalHeight","canvasWidth","canvasHeight","drawImage","globalAlpha","outer","inner","moveTo","forEach","lineTo","closePath","reverse","fillStyle","restore","lineWidth","shadowColor","shadowBlur","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_loop","beginPath","strokeStyle","arc","PI","strokeRect","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","Symbol","iterator","next","done","point","err","return","nodeName","newCanvas","document","ctx","imgData","getImageData","data","_imgData$data$slice","slice","_imgData$data$slice2","g","b","black","clearRect","putImageData","_iterator","filter","zoomIn","direction","mx","my","scale","translate","scaleU","mouseEvents","_canvasEl$current$get","getBoundingClientRect","clientX","clientY","projMouse","_layoutParams$current2","preventDefault","specialEvent","arguments","_layoutParams$current3","abs","_layoutParams$current4","newMat","_layoutParams$current5","onWheel","deltaY","_layoutParams$current6","zoomBox","pbox","_layoutParams$current7","assign","px","py","proj","p1","p2","pa","_layoutParams$current8","labelBoxHeight","editingLabels","coords","zIndex","paddingBottom","ref","toFixed","HeaderButtonContext","createContext","HeaderButton","Icon","Consumer","onHeaderButtonClick","Header_styles","flexShrink","fileInfo","Header","inFullScreen","headerActions","Provider","BackIcon","NextIcon","SettingsIcon","FullscreenIcon","ExitIcon","SelectedTool","SmallToolButton","selected","togglable","_ref$alwaysShowing","alwaysShowing","_useContext","useContext","selectedTool","onClickTool","includes","Tooltip_default","placement","aria-label","iconTools","borderRight","IconTools","_ref$enabledTools","react_fontawesome_index_es","fixedWidth","faMousePointer","faHandPaper","faSearch","faTag","faCrosshairs","faVectorSquare","faDrawPolygon","MainLayout_styles","minHeight","&.fullscreen","workspace","iconToolsContainer","imageCanvasContainer","justifyContent","noImageSelected","sidebarContainer","borderLeft","SettingsContext","useSettings","SettingsDialog","settings","Survey","noActions","defaultAnswers","onQuestionChange","q","answers","changeSetting","form","questions","MainLayout","dispatch","action","_len","params","Array","_key","_len2","args","_key2","reduce","acc","useKey","detectKeys","dist_default","enabled","headerContainer","$ANNOTATE_DEBUG_MODE","settingsOpen","buttonName","getRandomId","random","toString","split","getRandomColor","floor","typesToSaveWithHistory","BEGIN_BOX_TRANSFORM","BEGIN_MOVE_POINT","DELETE_REGION","reducer","setIn","currentImageIndex","findIndex","getRegionIndex","regionId","regionIndex","getRegion","modifyRegion","obj","_getRegion","_getRegion2","unselectRegions","saveToHistory","updateIn","toDate","closeEditors","setNewImage","newImage","oldRegion","isEqual","delta","_arr","_i","directions","freedom","original","polygon","pointIndex","splice","_state$mode","moveRegion","_state$mode2","_state$mode2$freedom","xFree","yFree","_state$mode2$original","ox","oy","ow","oh","dx","dw","dy","dh","_getRegion3","_getRegion4","newRegion","aa","editLabelEditorAfter","_getRegion5","_getRegion6","newRegions","toLowerCase","some","Annotator","_ref$selectedImage","_ref$showTags","_ref$regionTagList","_ref$regionClsList","onExit","_useReducer","useReducer","_useReducer2","dispatchToReducer","ErrorBoundaryDialog","hasError","info","this","setState","componentStack","props","Component","ReactDOM","render","MuiThemeProvider_default","annotatorOpen","changeAnnotatorOpen","annotatorProps","changeAnnotatorProps","changeLastOutput","ErrorBoundaryDialog_ErrorBoundaryDialog","output","DemoSite_Editor","getElementById"],"mappings":"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","file":"static/js/main.a18cb20e.chunk.js","sourcesContent":["// @flow\n\nimport React from \"react\"\nimport { makeStyles } from \"@material-ui/styles\"\nimport createMuiTheme from \"@material-ui/core/styles/createMuiTheme\"\nimport MuiThemeProvider from \"@material-ui/core/styles/MuiThemeProvider\"\nimport \"./theme.css\"\n\nconst useStyles = makeStyles({\n  container: {\n    fontFamily: '\"Inter UI\", sans-serif'\n  }\n})\n\nconst theme = createMuiTheme({\n  typography: {\n    fontFamily: '\"Inter UI\", \"Roboto\", sans-serif'\n  },\n  overrides: {\n    MuiButton: {\n      root: {\n        textTransform: \"none\"\n      }\n    }\n  }\n})\n\nexport default ({ children }: any) => {\n  const classes = useStyles()\n  return (\n    <MuiThemeProvider theme={theme}>\n      <div className={classes.container}>{children}</div>\n    </MuiThemeProvider>\n  )\n}\n","// @flow\n\nimport React, { useState } from \"react\"\nimport Button from \"@material-ui/core/Button\"\nimport { makeStyles } from \"@material-ui/styles\"\nimport Select from \"react-select\"\nimport Code from \"react-syntax-highlighter\"\nimport Dialog from \"@material-ui/core/Dialog\"\nimport DialogTitle from \"@material-ui/core/DialogTitle\"\nimport DialogContent from \"@material-ui/core/DialogContent\"\nimport DialogActions from \"@material-ui/core/DialogActions\"\nimport MonacoEditor from \"react-monaco-editor\"\n\nconst useStyles = makeStyles({\n  editBar: {\n    padding: 10,\n    borderBottom: \"1px solid #ccc\",\n    backgroundColor: \"#f8f8f8\",\n    display: \"flex\",\n    alignItems: \"center\",\n    \"& .button\": { margin: 5 }\n  },\n  select: { width: 240, fontSize: 14 },\n  contentArea: {\n    padding: 10\n  },\n  specificationArea: {\n    padding: 10\n  }\n})\n\nconst loadSavedInput = () => {\n  try {\n    return JSON.parse(window.localStorage.getItem(\"customInput\") || \"{}\")\n  } catch (e) {\n    return {}\n  }\n}\n\nexport const examples = {\n  \"Simple Bounding Box\": () => ({\n    taskDescription:\n      \"Annotate each image according to this _markdown_ specification.\",\n    // regionTagList: [],\n    // regionClsList: [\"hotdog\"],\n    regionTagList: [\"has-bun\"],\n    regionClsList: [\"hotdog\", \"not-hotdog\"],\n    enabledTools: [\"select\", \"create-box\"],\n    // showTags: true,\n    images: [\n      {\n        src:\n          \"https://images.unsplash.com/photo-1496905583330-eb54c7e5915a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=634&q=80\",\n        name: \"hot-dogs-1\"\n      }\n    ]\n  }),\n  Custom: () => loadSavedInput()\n}\n\nconst Editor = ({ onOpenAnnotator, lastOutput }: any) => {\n  const c = useStyles()\n  const [selectedExample, changeSelectedExample] = useState(\n    window.localStorage.getItem(\"customInput\")\n      ? \"Custom\"\n      : \"Simple Bounding Box\"\n  )\n  const [outputDialogOpen, changeOutputOpen] = useState(false)\n  const [currentJSONValue, changeCurrentJSONValue] = useState(\n    JSON.stringify(examples[selectedExample](), null, \"  \")\n  )\n  return (\n    <div>\n      <div className={c.editBar}>\n        <h3>React Image Annotate</h3>\n        <div style={{ flexGrow: 1 }} />\n        <div>\n          <div style={{ display: \"inline-flex\" }}>\n            <Select\n              className={c.select}\n              value={{ label: selectedExample, value: selectedExample }}\n              options={Object.keys(examples).map(s => ({\n                label: s,\n                value: s\n              }))}\n              onChange={selectedOption => {\n                changeSelectedExample(selectedOption.value)\n                changeCurrentJSONValue(\n                  JSON.stringify(\n                    selectedOption.value === \"Custom\"\n                      ? loadSavedInput()\n                      : examples[selectedOption.value],\n                    null,\n                    \"  \"\n                  )\n                )\n              }}\n            />\n          </div>\n          <Button\n            className=\"button\"\n            disabled={!lastOutput}\n            onClick={() => changeOutputOpen(true)}\n          >\n            View Output\n          </Button>\n          <Button\n            className=\"button\"\n            variant=\"outlined\"\n            onClick={() =>\n              onOpenAnnotator(\n                selectedExample === \"Custom\"\n                  ? loadSavedInput()\n                  : examples[selectedExample]\n              )\n            }\n          >\n            Open Annotator\n          </Button>\n        </div>\n      </div>\n      <div className={c.contentArea}>\n        <div>\n          <MonacoEditor\n            value={currentJSONValue}\n            language=\"javascript\"\n            onChange={code => {\n              try {\n                window.localStorage.setItem(\n                  \"customInput\",\n                  JSON.stringify(JSON.parse(code))\n                )\n              } catch (e) {}\n              changeCurrentJSONValue(code)\n            }}\n            width=\"100%\"\n            height=\"550px\"\n          />\n        </div>\n      </div>\n      <div className={c.specificationArea}>\n        <h2>React Image Annotate Format</h2>\n        <Code language=\"javascript\">{`\n{\n  taskDescription?: string, // markdown\n  regionTagList?: Array<string>,\n  regionClsList?: Array<string>,\n  imageTagList?: Array<string>,\n  imageClsList?: Array<string>,\n  // all tools are enabled by default\n  enabledTools?: Array< \"select\" | \"create-point\" | \"create-box\" | \"create-polygon\">,\n  selectedImage?: string, // initial selected image\n  images: Array<{\n    src: string,\n    thumbnailSrc?: string, // use this if you are using high-res images\n    name: string,\n    regions?: Array<{\n      id: string | number,\n      cls?: string,\n      color?: string,\n      tags?: Array<string>,\n\n      // Point\n      type: \"point\",\n      x: number, // [0-1] % of image width\n      y: number, // [0-1] % of image height\n\n      // Bounding Box\n      type: \"box\",\n      x: number, // [0-1] % of image width\n      y: number, // [0-1] % of image height\n      w: number, // [0-1] % of image width\n      h: number, // [0-1] % of image height\n\n      // Polygon\n      type: \"polygon\",\n      open?: boolean, // should last and first points be connected, default: true\n      points: Array<[number, number]> // [0-1] % of image width/height\n    }>\n  }>,\n}\n`}</Code>\n      </div>\n      <Dialog fullScreen open={outputDialogOpen}>\n        <DialogTitle>React Image Annotate Output</DialogTitle>\n        <DialogContent style={{ minWidth: 400 }}>\n          <MonacoEditor\n            value={JSON.stringify(lastOutput, null, \"  \")}\n            language=\"javascript\"\n            width=\"100%\"\n            height=\"550px\"\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => changeOutputOpen(false)}>Close</Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  )\n}\n\nexport default Editor\n","// @flow\n\nimport React, { useState } from \"react\"\nimport Paper from \"@material-ui/core/Paper\"\nimport { makeStyles } from \"@material-ui/styles\"\nimport ExpandIcon from \"@material-ui/icons/ExpandMore\"\nimport IconButton from \"@material-ui/core/IconButton\"\nimport Collapse from \"@material-ui/core/Collapse\"\nimport { grey } from \"@material-ui/core/colors\"\nimport classnames from \"classnames\"\n\nconst useStyles = makeStyles({\n  container: { margin: 8 },\n  header: {\n    display: \"flex\",\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: 8,\n    paddingLeft: 16,\n    paddingRight: 16\n  },\n  title: {\n    fontSize: 14,\n    fontWeight: \"bold\",\n    flexGrow: 1,\n    paddingLeft: 8,\n    color: grey[800],\n    \"& span\": {\n      color: grey[600],\n      fontSize: 12\n    }\n  },\n  expandButton: {\n    padding: 0,\n    width: 30,\n    height: 30,\n    \"& .icon\": {\n      marginTop: -6,\n      width: 20,\n      height: 20,\n      transition: \"500ms transform\",\n      \"&.expanded\": {\n        transform: \"rotate(180deg)\"\n      }\n    }\n  },\n  expandedContent: {\n    maxHeight: 300,\n    overflowY: \"auto\",\n    \"&.noScroll\": {\n      overflowY: \"visible\",\n      overflow: \"visible\"\n    }\n  }\n})\n\nexport default ({\n  icon,\n  title,\n  subTitle,\n  children,\n  noScroll = false,\n  expandedByDefault = false\n}) => {\n  const classes = useStyles()\n  const content = (\n    <div\n      className={classnames(classes.expandedContent, noScroll && \"noScroll\")}\n    >\n      {children}\n    </div>\n  )\n\n  const [expanded, changeExpanded] = useState(expandedByDefault)\n  return (\n    <Paper className={classes.container}>\n      <div className={classes.header}>\n        {icon}\n        <div className={classes.title}>\n          {title} <span>{subTitle}</span>\n        </div>\n        <IconButton\n          onClick={() => changeExpanded(!expanded)}\n          className={classes.expandButton}\n        >\n          <ExpandIcon className={classnames(\"icon\", expanded && \"expanded\")} />\n        </IconButton>\n      </div>\n      {noScroll ? (\n        expanded ? (\n          content\n        ) : null\n      ) : (\n        <Collapse in={expanded}>{content}</Collapse>\n      )}\n    </Paper>\n  )\n}\n","// @flow\n\nimport React from \"react\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport DescriptionIcon from \"@material-ui/icons/Description\"\nimport { makeStyles } from \"@material-ui/styles\"\nimport { grey } from \"@material-ui/core/colors\"\nimport Markdown from \"react-markdown\"\n\nconst useStyles = makeStyles({\n  markdownContainer: {\n    paddingLeft: 16,\n    paddingRight: 16,\n    fontSize: 12,\n    \"& h1\": { fontSize: 18 },\n    \"& h2\": { fontSize: 14 },\n    \"& h3\": { fontSize: 12 },\n    \"& h4\": { fontSize: 12 },\n    \"& h5\": { fontSize: 12 },\n    \"& h6\": { fontSize: 12 },\n    \"& p\": { fontSize: 12 },\n    \"& a\": {},\n    \"& img\": { width: \"100%\" }\n  }\n})\n\nexport default ({ description }) => {\n  const classes = useStyles()\n\n  return (\n    <SidebarBoxContainer\n      title=\"Task Description\"\n      icon={<DescriptionIcon style={{ color: grey[700] }} />}\n      expandedByDefault\n    >\n      <div className={classes.markdownContainer}>\n        <Markdown source={description} />\n      </div>\n    </SidebarBoxContainer>\n  )\n}\n","// @flow\n\nimport React from \"react\"\nimport { makeStyles } from \"@material-ui/styles\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport CollectionsIcon from \"@material-ui/icons/Collections\"\nimport { grey } from \"@material-ui/core/colors\"\nimport List from \"@material-ui/core/List\"\nimport ListItem from \"@material-ui/core/ListItem\"\nimport ListItemText from \"@material-ui/core/ListItemText\"\nimport Avatar from \"@material-ui/core/Avatar\"\n\nconst useStyles = makeStyles({\n  img: { width: 40, height: 40, borderRadius: 8 }\n})\n\nexport default ({ images, onSelect }) => {\n  const classes = useStyles()\n  return (\n    <SidebarBoxContainer\n      title=\"Images\"\n      subTitle={`(${images.length})`}\n      icon={<CollectionsIcon style={{ color: grey[700] }} />}\n    >\n      <div>\n        <List>\n          {images.map((img, i) => (\n            <ListItem button onClick={() => onSelect(img)} dense key={i}>\n              <img className={classes.img} src={img.src} />\n              <ListItemText\n                primary={img.name}\n                secondary={`${(img.regions || []).length} Labels`}\n              />\n            </ListItem>\n          ))}\n        </List>\n      </div>\n    </SidebarBoxContainer>\n  )\n}\n","import { grey, blue, orange, purple } from \"@material-ui/core/colors\"\n\nexport default {\n  container: {\n    fontSize: 11,\n    fontWeight: \"bold\",\n    color: grey[700],\n    \"& .icon\": {\n      marginTop: 4,\n      width: 16,\n      height: 16\n    },\n    \"& .icon2\": {\n      opacity: 0.5,\n      width: 16,\n      height: 16,\n      transition: \"200ms opacity\",\n      \"&:hover\": {\n        cursor: \"pointer\",\n        opacity: 1\n      }\n    }\n  },\n  row: {\n    padding: 4,\n    cursor: \"pointer\",\n    \"&.header:hover\": {\n      backgroundColor: \"#fff\"\n    },\n    \"&.highlighted\": {\n      backgroundColor: blue[100]\n    },\n    \"&:hover\": {\n      backgroundColor: blue[50],\n      color: grey[800]\n    }\n  },\n  chip: {\n    display: \"flex\",\n    flexDirection: \"row\",\n    padding: 2,\n    borderRadius: 2,\n    paddingLeft: 4,\n    paddingRight: 4,\n    alignItems: \"center\",\n    \"& .color\": {\n      borderRadius: 5,\n      width: 10,\n      height: 10,\n      marginRight: 4\n    },\n    \"& .text\": {}\n  }\n}\n","// @flow\n\nimport React, { Fragment, useState } from \"react\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport { makeStyles } from \"@material-ui/styles\"\nimport { grey } from \"@material-ui/core/colors\"\nimport RegionIcon from \"@material-ui/icons/PictureInPicture\"\nimport Grid from \"@material-ui/core/Grid\"\nimport ReorderIcon from \"@material-ui/icons/SwapVert\"\nimport PieChartIcon from \"@material-ui/icons/PieChart\"\nimport TrashIcon from \"@material-ui/icons/Delete\"\nimport LockIcon from \"@material-ui/icons/Lock\"\nimport UnlockIcon from \"@material-ui/icons/LockOpen\"\nimport VisibleIcon from \"@material-ui/icons/Visibility\"\nimport VisibleOffIcon from \"@material-ui/icons/VisibilityOff\"\nimport styles from \"./styles\"\nimport classnames from \"classnames\"\n\nconst useStyles = makeStyles(styles)\n\nconst Chip = ({ color, text }) => {\n  const classes = useStyles()\n  return (\n    <span className={classes.chip}>\n      <div className=\"color\" style={{ backgroundColor: color }} />\n      <div className=\"text\">{text}</div>\n    </span>\n  )\n}\n\nconst Row = ({\n  header,\n  highlighted,\n  order,\n  classification,\n  area,\n  tags,\n  trash,\n  lock,\n  visible,\n  onClick\n}) => {\n  const classes = useStyles()\n  const [mouseOver, changeMouseOver] = useState(false)\n  return (\n    <div\n      onClick={onClick}\n      onMouseEnter={() => changeMouseOver(true)}\n      onMouseLeave={() => changeMouseOver(false)}\n      className={classnames(classes.row, { header, highlighted })}\n    >\n      <Grid container alignItems=\"center\">\n        <Grid item xs={2}>\n          <div style={{ textAlign: \"right\", paddingRight: 10 }}>{order}</div>\n        </Grid>\n        <Grid item xs={5}>\n          {classification}\n        </Grid>\n        <Grid item xs={2}>\n          <div style={{ textAlign: \"right\", paddingRight: 6 }}>{area}</div>\n        </Grid>\n        <Grid item xs={1}>\n          {trash}\n        </Grid>\n        <Grid item xs={1}>\n          {lock}\n        </Grid>\n        <Grid item xs={1}>\n          {visible}\n        </Grid>\n      </Grid>\n    </div>\n  )\n}\n\nexport default ({\n  regions,\n  onDeleteRegion,\n  onChangeRegion,\n  onSelectRegion\n}) => {\n  const classes = useStyles()\n  return (\n    <SidebarBoxContainer\n      title=\"Regions\"\n      subTitle=\"\"\n      icon={<RegionIcon style={{ color: grey[700] }} />}\n      expandedByDefault\n    >\n      <div className={classes.container}>\n        <Row\n          header\n          highlighted={false}\n          order={<ReorderIcon className=\"icon\" />}\n          classification={<div style={{ paddingLeft: 10 }}>Class</div>}\n          area={<PieChartIcon className=\"icon\" />}\n          trash={<TrashIcon className=\"icon\" />}\n          lock={<LockIcon className=\"icon\" />}\n          visible={<VisibleIcon className=\"icon\" />}\n        />\n        <div\n          style={{\n            borderTop: `1px solid ${grey[200]}`,\n            marginTop: 2,\n            marginBottom: 2\n          }}\n        />\n        {regions.map((r, i) => (\n          <Row\n            header={false}\n            highlighted={r.highlighted}\n            onClick={() => onSelectRegion(r)}\n            key={r.id}\n            order={`#${i + 1}`}\n            classification={\n              <Chip text={r.cls || \"\"} color={r.color || \"#ddd\"} />\n            }\n            area=\"\"\n            trash={\n              <TrashIcon onClick={() => onDeleteRegion(r)} className=\"icon2\" />\n            }\n            lock={\n              r.locked ? (\n                <LockIcon\n                  onClick={() => onChangeRegion({ ...r, locked: false })}\n                  className=\"icon2\"\n                />\n              ) : (\n                <UnlockIcon\n                  onClick={() => onChangeRegion({ ...r, locked: true })}\n                  className=\"icon2\"\n                />\n              )\n            }\n            visible={\n              r.visible || r.visible === undefined ? (\n                <VisibleIcon\n                  onClick={() => onChangeRegion({ ...r, visible: false })}\n                  className=\"icon2\"\n                />\n              ) : (\n                <VisibleOffIcon\n                  onClick={() => onChangeRegion({ ...r, visible: true })}\n                  className=\"icon2\"\n                />\n              )\n            }\n          />\n        ))}\n      </div>\n    </SidebarBoxContainer>\n  )\n}\n","// @flow\n\nimport React, { setState } from \"react\"\nimport { makeStyles } from \"@material-ui/styles\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport HistoryIcon from \"@material-ui/icons/History\"\nimport List from \"@material-ui/core/List\"\nimport ListItem from \"@material-ui/core/ListItem\"\nimport ListItemText from \"@material-ui/core/ListItemText\"\nimport IconButton from \"@material-ui/core/IconButton\"\nimport ListItemSecondaryAction from \"@material-ui/core/ListItemSecondaryAction\"\nimport UndoIcon from \"@material-ui/icons/Undo\"\nimport moment from \"moment\"\nimport { grey } from \"@material-ui/core/colors\"\n\nconst useStyles = makeStyles({\n  emptyText: {\n    fontSize: 14,\n    fontWeight: \"bold\",\n    color: grey[500],\n    textAlign: \"center\",\n    padding: 20\n  }\n})\n\nexport default ({\n  history,\n  onRestoreHistory\n}: {\n  history: Array<{ name: string, time: Date }>\n}) => {\n  const classes = useStyles()\n\n  return (\n    <SidebarBoxContainer\n      title=\"History\"\n      icon={<HistoryIcon style={{ color: grey[700] }} />}\n      expandedByDefault\n    >\n      <List>\n        {history.length === 0 && (\n          <div className={classes.emptyText}>No History Yet</div>\n        )}\n        {history.map(({ name, time }, i) => (\n          <ListItem button dense key={i}>\n            <ListItemText\n              primary={name}\n              secondary={moment(time).format(\"LT\")}\n            />\n            {i === 0 && (\n              <ListItemSecondaryAction onClick={onRestoreHistory}>\n                <IconButton>\n                  <UndoIcon />\n                </IconButton>\n              </ListItemSecondaryAction>\n            )}\n          </ListItem>\n        ))}\n      </List>\n    </SidebarBoxContainer>\n  )\n}\n","// @flow\n\nimport React from \"react\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\n\nexport default ({ state, lastAction }: any) => {\n  const image = (state.images || []).find(\n    img => img.src === state.selectedImage\n  )\n  const region = image ? (image.regions || []).find(r => r.highlighted) : null\n\n  return (\n    <SidebarBoxContainer title=\"Debug\" icon={<span />} expandedByDefault>\n      <div style={{ padding: 4 }}>\n        <div>\n          <b>region</b>:\n        </div>\n        <pre>{JSON.stringify(region, null, \"  \")}</pre>\n        <div>\n          <b>lastAction</b>:\n        </div>\n        <pre>{JSON.stringify(lastAction, null, \"  \")}</pre>\n        <div>\n          <b>mode</b>:\n        </div>\n        <pre>{JSON.stringify(state.mode, null, \"  \")}</pre>\n      </div>\n    </SidebarBoxContainer>\n  )\n}\n","// @flow\n\nimport React from \"react\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport { makeStyles } from \"@material-ui/styles\"\nimport StyleIcon from \"@material-ui/icons/Style\"\nimport { grey } from \"@material-ui/core/colors\"\nimport Select from \"react-select\"\n\nconst useStyles = makeStyles({})\n\ntype Props = {\n  tags: Array<string>,\n  currentImage: { cls?: string, tags?: Array<string> },\n  imageClsList?: Array<string>,\n  imageTagList?: Array<string>,\n  onChangeImage: (Array<string>) => any\n}\n\nexport default ({\n  currentImage,\n  imageClsList = [],\n  imageTagList = [],\n  onChangeImage\n}: Props) => {\n  const { tags = [], cls = null } = currentImage\n  return (\n    <SidebarBoxContainer\n      title=\"Image Tags\"\n      expandedByDefault\n      noScroll\n      icon={<StyleIcon style={{ color: grey[700] }} />}\n    >\n      {imageClsList.length > 0 && (\n        <div style={{ padding: 8 }}>\n          <Select\n            placeholder=\"Image Classification\"\n            onChange={o => onChangeImage({ cls: o.value })}\n            value={cls ? { value: cls, label: cls } : cls}\n            options={imageClsList.map(c => ({ value: c, label: c }))}\n          />\n        </div>\n      )}\n      {imageTagList.length > 0 && (\n        <div style={{ padding: 8, paddingTop: 0 }}>\n          <Select\n            isMulti\n            placeholder=\"Image Tags\"\n            onChange={o => onChangeImage({ tags: o.map(a => a.value) })}\n            value={tags.map(r => ({ value: r, label: r }))}\n            options={imageTagList.map(c => ({ value: c, label: c }))}\n          />\n        </div>\n      )}\n    </SidebarBoxContainer>\n  )\n}\n","// @flow\n\nimport React from \"react\"\nimport { makeStyles } from \"@material-ui/styles\"\nimport TaskDescription from \"../TaskDescriptionSidebarBox\"\nimport ImageSelector from \"../ImageSelectorSidebarBox\"\nimport RegionSelector from \"../RegionSelectorSidebarBox\"\nimport History from \"../HistorySidebarBox\"\nimport DebugBox from \"../DebugSidebarBox\"\nimport TagsSidebarBox from \"../TagsSidebarBox\"\nimport type { Region } from \"../ImageCanvas/region-tools.js\"\n\nconst useStyles = makeStyles({})\n\ntype Image = {\n  name: string,\n  src: string,\n  cls?: string,\n  tags?: Array<string>,\n  thumbnailSrc?: string,\n  regions?: Array<Region>\n}\n\ntype Props = {\n  debug: any,\n  taskDescription: string,\n  images: Array<Image>,\n  regions: Array<Region>,\n  history: Array<{ state: Object, name: string, time: Date }>,\n\n  labelImages?: boolean,\n  currentImage?: Image,\n  imageClsList?: Array<string>,\n  imageTagList?: Array<string>,\n\n  onChangeImage: Image => any,\n  onSelectRegion: Region => any,\n  onSelectImage: Image => any,\n  onChangeRegion: Region => any,\n  onDeleteRegion: Region => any,\n  onRestoreHistory: () => any\n}\n\nexport default ({\n  debug,\n  taskDescription,\n  images,\n  regions,\n  history,\n  labelImages,\n  currentImage,\n  imageClsList,\n  imageTagList,\n  onChangeImage,\n  onSelectRegion,\n  onSelectImage,\n  onChangeRegion,\n  onDeleteRegion,\n  onRestoreHistory\n}: Props) => {\n  const classes = useStyles()\n\n  return (\n    <div>\n      {debug && <DebugBox state={debug} lastAction={debug.lastAction} />}\n      <TaskDescription description={taskDescription} />\n      {labelImages && (\n        <TagsSidebarBox\n          currentImage={currentImage}\n          imageClsList={imageClsList}\n          imageTagList={imageTagList}\n          onChangeImage={onChangeImage}\n          expandedByDefault\n        />\n      )}\n      <ImageSelector onSelect={onSelectImage} images={images} />\n      <RegionSelector\n        regions={regions}\n        onSelectRegion={onSelectRegion}\n        onChangeRegion={onChangeRegion}\n        onDeleteRegion={onDeleteRegion}\n      />\n      <History history={history} onRestoreHistory={() => onRestoreHistory()} />\n    </div>\n  )\n}\n","// @flow\n\nimport React, { Fragment, useEffect, useState } from \"react\"\n\nexport default ({\n  mousePosition,\n  x,\n  y\n}: {\n  mousePosition: { current: { x: number, y: number } },\n  x?: number,\n  y?: number\n}) => {\n  const [forceRenderState, changeForceRenderState] = useState()\n\n  if (mousePosition) {\n    x = mousePosition.current.x\n    y = mousePosition.current.y\n  }\n\n  useEffect(() => {\n    if (!mousePosition) return\n    const interval = setInterval(() => {\n      if (x !== mousePosition.current.x || y !== mousePosition.current.y) {\n        changeForceRenderState([\n          mousePosition.current.x,\n          mousePosition.current.y\n        ])\n      }\n    }, 10)\n    return () => clearInterval(interval)\n  })\n\n  return (\n    <Fragment>\n      <div\n        style={{\n          position: \"absolute\",\n          height: \"100%\",\n          width: 1,\n          backgroundColor: \"#f00\",\n          left: x,\n          pointerEvents: \"none\",\n          top: 0\n        }}\n      />\n      <div\n        style={{\n          position: \"absolute\",\n          width: \"100%\",\n          height: 1,\n          backgroundColor: \"#f00\",\n          top: y,\n          pointerEvents: \"none\",\n          left: 0\n        }}\n      />\n    </Fragment>\n  )\n}\n","// @flow\n\nimport { grey } from \"@material-ui/core/colors\"\n\nexport default {\n  regionInfo: {\n    fontSize: 12,\n    cursor: \"default\",\n    transition: \"opacity 200ms\",\n    opacity: 0.7,\n    \"&:hover\": {\n      opacity: 0.9,\n      cursor: \"pointer\"\n    },\n    \"&.highlighted\": {\n      opacity: 0.9,\n      \"&:hover\": {\n        opacity: 1\n      }\n    },\n    // pointerEvents: \"none\",\n    fontWeight: 600,\n    color: grey[900],\n    padding: 8,\n    \"& .name\": {\n      display: \"flex\",\n      flexDirection: \"row\",\n      alignItems: \"center\",\n      \"& .circle\": {\n        marginRight: 4,\n        boxShadow: \"0px 0px 2px rgba(0,0,0,0.4)\",\n        width: 10,\n        height: 10,\n        borderRadius: 5\n      }\n    },\n    \"& .tags\": {\n      \"& .tag\": {\n        color: grey[700],\n        display: \"inline-block\",\n        margin: 1,\n        fontSize: 10,\n        textDecoration: \"underline\"\n      }\n    }\n  }\n}\n","// @flow\n\nimport React, { useState } from \"react\"\nimport Paper from \"@material-ui/core/Paper\"\nimport { makeStyles } from \"@material-ui/styles\"\nimport styles from \"./styles\"\nimport classnames from \"classnames\"\nimport type { Region } from \"../ImageCanvas/region-tools.js\"\nimport IconButton from \"@material-ui/core/IconButton\"\nimport Button from \"@material-ui/core/Button\"\nimport TrashIcon from \"@material-ui/icons/Delete\"\nimport CheckIcon from \"@material-ui/icons/Check\"\nimport UndoIcon from \"@material-ui/icons/Undo\"\nimport Select from \"react-select\"\n\nconst useStyles = makeStyles(styles)\n\ntype Props = {\n  region: Region,\n  editing?: boolean,\n  allowedClasses?: Array<string>,\n  allowedTags?: Array<string>,\n  cls?: string,\n  tags?: Array<string>,\n  onDelete: Region => null,\n  onChange: Region => null,\n  onClose: Region => null,\n  onOpen: Region => null\n}\n\nexport default ({\n  region,\n  editing,\n  allowedClasses = [\"Laptop\", \"Mouse\", \"Compuda\"],\n  allowedTags = [\"Dog\", \"Cat\", \"Woof\", \"Electronic Device\"],\n  onDelete,\n  onChange,\n  onClose,\n  onOpen\n}: Props) => {\n  const classes = useStyles()\n\n  return (\n    <Paper\n      onClick={() => (!editing ? onOpen(region) : null)}\n      className={classnames(classes.regionInfo, {\n        highlighted: region.highlighted\n      })}\n    >\n      {!editing ? (\n        <div>\n          {region.cls && (\n            <div className=\"name\">\n              <div\n                className=\"circle\"\n                style={{ backgroundColor: region.color }}\n              />\n              {region.cls}\n            </div>\n          )}\n          {region.tags && (\n            <div className=\"tags\">\n              {region.tags.map(t => (\n                <div key={t} className=\"tag\">\n                  {t}\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      ) : (\n        <div style={{ width: 200 }}>\n          <div style={{ display: \"flex\", flexDirection: \"row\" }}>\n            <div\n              style={{\n                display: \"flex\",\n                backgroundColor: region.color,\n                color: \"#fff\",\n                padding: 4,\n                paddingLeft: 8,\n                paddingRight: 8,\n                borderRadius: 4,\n                fontWeight: \"bold\",\n                textShadow: \"0px 0px 5px rgba(0,0,0,0.4)\"\n              }}\n            >\n              {region.type}\n            </div>\n            <div style={{ flexGrow: 1 }} />\n            <IconButton\n              onClick={() => onDelete(region)}\n              tabIndex={-1}\n              style={{ width: 22, height: 22 }}\n              size=\"small\"\n              variant=\"outlined\"\n            >\n              <TrashIcon style={{ marginTop: -8, width: 16, height: 16 }} />\n            </IconButton>\n          </div>\n          {allowedClasses.length > 0 && (\n            <div style={{ marginTop: 6 }}>\n              <Select\n                placeholder=\"Classification\"\n                onChange={o =>\n                  onChange({\n                    ...(region: any),\n                    cls: o.value\n                  })\n                }\n                value={\n                  region.cls ? { label: region.cls, value: region.cls } : null\n                }\n                options={allowedClasses.map(c => ({ value: c, label: c }))}\n              />\n            </div>\n          )}\n          {allowedTags.length > 0 && (\n            <div style={{ marginTop: 4 }}>\n              <Select\n                onChange={newTags =>\n                  onChange({\n                    ...(region: any),\n                    tags: newTags.map(t => t.value)\n                  })\n                }\n                placeholder=\"Tags\"\n                value={(region.tags || []).map(c => ({ label: c, value: c }))}\n                isMulti\n                options={allowedTags.map(c => ({ value: c, label: c }))}\n              />\n            </div>\n          )}\n          <div style={{ marginTop: 4, display: \"flex\" }}>\n            <div style={{ flexGrow: 1 }} />\n            <Button\n              onClick={() => onClose(region)}\n              size=\"small\"\n              variant=\"contained\"\n              color=\"primary\"\n            >\n              <CheckIcon />\n            </Button>\n          </div>\n        </div>\n      )}\n    </Paper>\n  )\n}\n","// @flow\nimport React, { Fragment, useRef, useState, useLayoutEffect } from \"react\"\nimport { Matrix } from \"transformation-matrix-js\"\nimport getImageData from \"get-image-data\"\nimport Crosshairs from \"../Crosshairs\"\nimport type {\n  Region,\n  PixelRegion,\n  Point,\n  Polygon,\n  Box\n} from \"./region-tools.js\"\nimport { getEnclosingBox } from \"./region-tools.js\"\nimport { makeStyles } from \"@material-ui/styles\"\nimport styles from \"./styles\"\nimport classnames from \"classnames\"\nimport RegionLabel from \"../RegionLabel\"\nimport LockIcon from \"@material-ui/icons/Lock\"\nimport Paper from \"@material-ui/core/Paper\"\n// import excludePatternSrc from \"./xpattern.png\"\nimport excludePatternSrc from \"./xpattern.js\"\n\nconst useStyles = makeStyles(styles)\n\nconst boxCursorMap = [\n  [\"nw-resize\", \"n-resize\", \"ne-resize\"],\n  [\"w-resize\", \"grab\", \"e-resize\"],\n  [\"sw-resize\", \"s-resize\", \"se-resize\"]\n]\n\ntype Props = {\n  regions: Array<Region>,\n  imageSrc: string,\n  onMouseMove?: ({ x: number, y: number }) => any,\n  onMouseDown?: ({ x: number, y: number }) => any,\n  onMouseUp?: ({ x: number, y: number }) => any,\n  dragWithPrimary?: boolean,\n  zoomWithPrimary?: boolean,\n  createWithPrimary?: boolean,\n  showTags?: boolean,\n  showCrosshairs?: boolean,\n  regionClsList?: Array<string>,\n  regionTagList?: Array<string>,\n  allowedArea?: { x: number, y: number, w: number, h: number },\n\n  onChangeRegion: Region => any,\n  onBeginRegionEdit: Region => any,\n  onCloseRegionEdit: Region => any,\n  onDeleteRegion: Region => any,\n  onBeginBoxTransform: (Box, [number, number]) => any,\n  onBeginMovePolygonPoint: (Polygon, index: number) => any,\n  onAddPolygonPoint: (Polygon, point: [number, number], index: number) => any,\n  onSelectRegion: Region => any,\n  onBeginMovePoint: Point => any\n}\n\nconst getDefaultMat = () => Matrix.from(1, 0, 0, 1, -10, -10)\n\nexport default ({\n  regions,\n  imageSrc,\n  showTags,\n  onMouseMove = p => null,\n  onMouseDown = p => null,\n  onMouseUp = p => null,\n  dragWithPrimary = false,\n  zoomWithPrimary = false,\n  createWithPrimary = false,\n  regionClsList,\n  regionTagList,\n  showCrosshairs,\n  allowedArea,\n\n  onChangeRegion,\n  onBeginRegionEdit,\n  onCloseRegionEdit,\n  onBeginBoxTransform,\n  onBeginMovePolygonPoint,\n  onAddPolygonPoint,\n  onSelectRegion,\n  onBeginMovePoint,\n  onDeleteRegion\n}: Props) => {\n  const classes = useStyles()\n\n  const canvasEl = useRef(null)\n  const image = useRef(null)\n  const layoutParams = useRef({})\n  const excludePattern = useRef(null)\n  const [imageLoaded, changeImageLoaded] = useState(false)\n  const [dragging, changeDragging] = useState(false)\n  const [maskImagesLoaded, changeMaskImagesLoaded] = useState(0)\n  const [zoomStart, changeZoomStart] = useState(null)\n  const [zoomEnd, changeZoomEnd] = useState(null)\n  const mousePosition = useRef({ x: 0, y: 0 })\n  const prevMousePosition = useRef({ x: 0, y: 0 })\n  const [mat, changeMat] = useState(getDefaultMat())\n  const maskImages = useRef({})\n\n  const innerMousePos = mat.applyToPoint(\n    mousePosition.current.x,\n    mousePosition.current.y\n  )\n\n  const projectRegionBox = r => {\n    const { iw, ih } = layoutParams.current\n    const bbox = getEnclosingBox(r)\n    const margin = r.type === \"point\" ? 15 : 2\n    const cbox = {\n      x: bbox.x * iw - margin,\n      y: bbox.y * ih - margin,\n      w: bbox.w * iw + margin * 2,\n      h: bbox.h * ih + margin * 2\n    }\n    const pbox = {\n      ...mat\n        .clone()\n        .inverse()\n        .applyToPoint(cbox.x, cbox.y),\n      w: cbox.w / mat.a,\n      h: cbox.h / mat.d\n    }\n    return pbox\n  }\n\n  useLayoutEffect(() => {\n    if (image.current === null) {\n      image.current = new Image()\n      image.current.onload = () => {\n        changeImageLoaded(true)\n      }\n      image.current.src = imageSrc\n    }\n    const canvas = canvasEl.current\n    const { clientWidth, clientHeight } = canvas\n    canvas.width = clientWidth\n    canvas.height = clientHeight\n    const context = canvas.getContext(\"2d\")\n    if (excludePattern.current === null) {\n      excludePattern.current = {\n        image: new Image(),\n        pattern: null\n      }\n      excludePattern.current.image.onload = () => {\n        excludePattern.current.pattern = context.createPattern(\n          excludePattern.current.image,\n          \"repeat\"\n        )\n      }\n      excludePattern.current.image.src = excludePatternSrc\n    }\n    context.save()\n    context.transform(\n      ...mat\n        .clone()\n        .inverse()\n        .toArray()\n    )\n\n    const fitScale = Math.max(\n      image.current.naturalWidth / (clientWidth - 20),\n      image.current.naturalHeight / (clientHeight - 20)\n    )\n\n    const [iw, ih] = [\n      image.current.naturalWidth / fitScale,\n      image.current.naturalHeight / fitScale\n    ]\n\n    layoutParams.current = {\n      iw,\n      ih,\n      fitScale,\n      canvasWidth: clientWidth,\n      canvasHeight: clientHeight\n    }\n\n    context.drawImage(image.current, 0, 0, iw, ih)\n\n    if (allowedArea) {\n      // Pattern to indicate the NOT allowed areas\n      const { x, y, w, h } = allowedArea\n      context.save()\n      context.globalAlpha = 0.25\n      const outer = [[0, 0], [iw, 0], [iw, ih], [0, ih]]\n      const inner = [\n        [x * iw, y * ih],\n        [x * iw + w * iw, y * ih],\n        [x * iw + w * iw, y * ih + h * ih],\n        [x * iw, y * ih + h * ih]\n      ]\n      context.moveTo(...outer[0])\n      outer.forEach(p => context.lineTo(...p))\n      context.lineTo(...outer[0])\n      context.closePath()\n\n      inner.reverse()\n      context.moveTo(...inner[0])\n      inner.forEach(p => context.lineTo(...p))\n      context.lineTo(...inner[0])\n\n      context.fillStyle = excludePattern.current.pattern || \"#f00\"\n      context.fill()\n\n      context.restore()\n    }\n\n    context.save()\n    context.globalAlpha = mat.a * 0.5 + 0.5\n    context.lineWidth = mat.a * 1 + 1\n    if (context.globalAlpha > 0.6) {\n      context.shadowColor = \"black\"\n      context.shadowBlur = 4\n    }\n    for (const region of regions.filter(\n      r => r.visible || r.visible === undefined\n    )) {\n      switch (region.type) {\n        case \"point\": {\n          context.save()\n\n          context.beginPath()\n          context.strokeStyle = region.color\n          context.moveTo(region.x * iw - 10, region.y * ih)\n          context.lineTo(region.x * iw - 2, region.y * ih)\n          context.moveTo(region.x * iw + 10, region.y * ih)\n          context.lineTo(region.x * iw + 2, region.y * ih)\n          context.moveTo(region.x * iw, region.y * ih - 10)\n          context.lineTo(region.x * iw, region.y * ih - 2)\n          context.moveTo(region.x * iw, region.y * ih + 10)\n          context.lineTo(region.x * iw, region.y * ih + 2)\n          context.moveTo(region.x * iw + 5, region.y * ih)\n          context.arc(region.x * iw, region.y * ih, 5, 0, 2 * Math.PI)\n          context.stroke()\n          context.restore()\n          break\n        }\n        case \"box\": {\n          context.save()\n\n          context.shadowColor = \"black\"\n          context.shadowBlur = 4\n          context.strokeStyle = region.color\n          context.strokeRect(\n            region.x * iw,\n            region.y * ih,\n            region.w * iw,\n            region.h * ih\n          )\n\n          context.restore()\n          break\n        }\n        case \"polygon\": {\n          context.save()\n\n          context.shadowColor = \"black\"\n          context.shadowBlur = 4\n          context.strokeStyle = region.color\n\n          context.beginPath()\n          context.moveTo(region.points[0][0] * iw, region.points[0][1] * ih)\n          for (const point of region.points) {\n            context.lineTo(point[0] * iw, point[1] * ih)\n          }\n          if (!region.open) context.closePath()\n          context.stroke()\n          context.restore()\n          break\n        }\n        case \"pixel\": {\n          context.save()\n\n          if (maskImages.current[region.src]) {\n            if (maskImages.current[region.src].nodeName === \"CANVAS\") {\n              context.globalAlpha = 0.6\n              context.drawImage(\n                maskImages.current[region.src],\n                region.sx * iw,\n                region.sy * ih,\n                region.w * iw,\n                region.h * ih\n              )\n            }\n          } else {\n            maskImages.current[region.src] = new Image()\n            maskImages.current[region.src].onload = () => {\n              const img = maskImages.current[region.src]\n              const newCanvas = document.createElement(\"canvas\")\n              newCanvas.width = img.naturalWidth\n              newCanvas.height = img.naturalHeight\n              const ctx = newCanvas.getContext(\"2d\")\n              ctx.drawImage(img, 0, 0)\n              const imgData = ctx.getImageData(\n                0,\n                0,\n                img.naturalWidth,\n                img.naturalHeight\n              )\n              for (let i = 0; i < imgData.data.length; i += 4) {\n                const [r, g, b, a] = imgData.data.slice(i, i + 4)\n                const black = r < 10 && g < 10 && b < 10\n                imgData.data[i] = 0\n                imgData.data[i + 1] = 0\n                imgData.data[i + 2] = black ? 255 : 0\n                imgData.data[i + 3] = black ? 255 : 0\n              }\n              ctx.clearRect(0, 0, img.naturalWidth, img.naturalHeight)\n              ctx.putImageData(imgData, 0, 0)\n              maskImages.current[region.src] = newCanvas\n              changeMaskImagesLoaded(maskImagesLoaded + 1)\n            }\n            maskImages.current[region.src].src = region.src\n          }\n\n          context.restore()\n          break\n        }\n      }\n    }\n    context.restore()\n    context.restore()\n  })\n\n  const zoomIn = (direction, point) => {\n    const [mx, my] = [point.x, point.y]\n    let scale =\n      typeof direction === \"object\" ? direction.to / mat.a : 1 + 0.2 * direction\n\n    // NOTE: We're mutating mat here\n    mat.translate(mx, my).scaleU(scale)\n    if (mat.a > 2) mat.scaleU(2 / mat.a)\n    if (mat.a < 0.1) mat.scaleU(0.1 / mat.a)\n    mat.translate(-mx, -my)\n\n    changeMat(mat.clone())\n  }\n\n  const mouseEvents = {\n    onMouseMove: e => {\n      const { left, top } = canvasEl.current.getBoundingClientRect()\n      prevMousePosition.current.x = mousePosition.current.x\n      prevMousePosition.current.y = mousePosition.current.y\n      mousePosition.current.x = e.clientX - left\n      mousePosition.current.y = e.clientY - top\n\n      const projMouse = mat.applyToPoint(\n        mousePosition.current.x,\n        mousePosition.current.y\n      )\n\n      if (zoomWithPrimary && zoomStart) {\n        changeZoomEnd(projMouse)\n      }\n\n      const { iw, ih } = layoutParams.current\n      onMouseMove({ x: projMouse.x / iw, y: projMouse.y / ih })\n\n      if (dragging) {\n        mat.translate(\n          prevMousePosition.current.x - mousePosition.current.x,\n          prevMousePosition.current.y - mousePosition.current.y\n        )\n\n        changeMat(mat.clone())\n        // changeForceRenderState(Math.random())\n      }\n      e.preventDefault()\n    },\n    onMouseDown: (e, specialEvent = {}) => {\n      e.preventDefault()\n\n      if (e.button === 1 || (e.button === 0 && dragWithPrimary))\n        return changeDragging(true)\n      const projMouse = mat.applyToPoint(\n        mousePosition.current.x,\n        mousePosition.current.y\n      )\n      if (zoomWithPrimary && e.button === 0) {\n        changeZoomStart(projMouse)\n        changeZoomEnd(projMouse)\n        return\n      }\n      if (e.button === 0) {\n        if (specialEvent.type === \"resize-box\") {\n          // onResizeBox()\n        }\n        if (specialEvent.type === \"move-region\") {\n          // onResizeBox()\n        }\n        const { iw, ih } = layoutParams.current\n        onMouseDown({ x: projMouse.x / iw, y: projMouse.y / ih })\n      }\n    },\n    onMouseUp: e => {\n      e.preventDefault()\n      const projMouse = mat.applyToPoint(\n        mousePosition.current.x,\n        mousePosition.current.y\n      )\n      if (zoomStart) {\n        const zoomEnd = projMouse\n        if (\n          Math.abs(zoomStart.x - zoomEnd.x) < 10 &&\n          Math.abs(zoomStart.y - zoomEnd.y) < 10\n        ) {\n          if (mat.a < 1) {\n            zoomIn({ to: 1 }, mousePosition.current)\n          } else {\n            zoomIn({ to: 0.25 }, mousePosition.current)\n          }\n        } else {\n          const { iw, ih } = layoutParams.current\n\n          if (zoomStart.x > zoomEnd.x) {\n            ;[zoomStart.x, zoomEnd.x] = [zoomEnd.x, zoomStart.x]\n          }\n          if (zoomStart.y > zoomEnd.y) {\n            ;[zoomStart.y, zoomEnd.y] = [zoomEnd.y, zoomStart.y]\n          }\n\n          // The region defined by zoomStart and zoomEnd should be the new transform\n          let scale = Math.min(\n            (zoomEnd.x - zoomStart.x) / iw,\n            (zoomEnd.y - zoomStart.y) / ih\n          )\n          if (scale < 0.1) scale = 0.1\n          if (scale > 10) scale = 10\n\n          const newMat = getDefaultMat()\n            .translate(zoomStart.x, zoomStart.y)\n            .scaleU(scale)\n\n          changeMat(newMat.clone())\n        }\n\n        changeZoomStart(null)\n        changeZoomEnd(null)\n      }\n      if (e.button === 1 || (e.button === 0 && dragWithPrimary))\n        return changeDragging(false)\n      if (e.button === 0) {\n        const { iw, ih } = layoutParams.current\n        onMouseUp({ x: projMouse.x / iw, y: projMouse.y / ih })\n      }\n    },\n    onWheel: e => {\n      const direction = e.deltaY > 0 ? 1 : e.deltaY < 0 ? -1 : 0\n      zoomIn(direction, mousePosition.current)\n      e.preventDefault()\n    }\n  }\n\n  const { iw, ih } = layoutParams.current\n\n  let zoomBox = !zoomStart\n    ? null\n    : {\n        ...mat\n          .clone()\n          .inverse()\n          .applyToPoint(zoomStart.x, zoomStart.y),\n        w: (zoomEnd.x - zoomStart.x) / mat.a,\n        h: (zoomEnd.y - zoomStart.y) / mat.d\n      }\n  if (zoomBox) {\n    if (zoomBox.w < 0) {\n      zoomBox.x += zoomBox.w\n      zoomBox.w *= -1\n    }\n    if (zoomBox.h < 0) {\n      zoomBox.y += zoomBox.h\n      zoomBox.h *= -1\n    }\n  }\n\n  return (\n    <div\n      style={{\n        width: \"100%\",\n        height: \"100%\",\n        maxHeight: \"calc(100vh - 68px)\",\n        position: \"relative\",\n        overflow: \"hidden\",\n        cursor: createWithPrimary\n          ? \"crosshair\"\n          : dragging\n            ? \"grabbing\"\n            : dragWithPrimary\n              ? \"grab\"\n              : zoomWithPrimary\n                ? mat.a < 1\n                  ? \"zoom-out\"\n                  : \"zoom-in\"\n                : undefined\n      }}\n    >\n      {showCrosshairs && <Crosshairs mousePosition={mousePosition} />}\n      {regions\n        .filter(r => r.visible || r.visible === undefined)\n        .filter(r => !r.locked)\n        .map((r, i) => {\n          const pbox = projectRegionBox(r)\n          const { iw, ih } = layoutParams.current\n          return (\n            <Fragment>\n              <svg\n                key={r.id}\n                className={classnames(classes.highlightBox, {\n                  highlighted: r.highlighted\n                })}\n                {...mouseEvents}\n                {...(!zoomWithPrimary && !dragWithPrimary\n                  ? {\n                      onMouseDown: e => {\n                        if (\n                          !r.locked &&\n                          r.type === \"point\" &&\n                          r.highlighted &&\n                          e.button === 0\n                        ) {\n                          return onBeginMovePoint(r)\n                        }\n                        if (e.button === 0 && !createWithPrimary)\n                          return onSelectRegion(r)\n                        mouseEvents.onMouseDown(e)\n                      }\n                    }\n                  : {})}\n                style={{\n                  ...(r.highlighted\n                    ? {\n                        pointerEvents: r.type !== \"point\" ? \"none\" : undefined,\n                        cursor: \"grab\"\n                      }\n                    : {\n                        cursor: !(\n                          zoomWithPrimary ||\n                          dragWithPrimary ||\n                          createWithPrimary\n                        )\n                          ? \"pointer\"\n                          : undefined,\n                        pointerEvents:\n                          zoomWithPrimary ||\n                          dragWithPrimary ||\n                          (createWithPrimary && !r.highlighted)\n                            ? \"none\"\n                            : undefined\n                      }),\n                  position: \"absolute\",\n                  left: pbox.x - 5,\n                  top: pbox.y - 5,\n                  width: pbox.w + 10,\n                  height: pbox.h + 10\n                }}\n              >\n                <path\n                  d={`M5,5 L${pbox.w + 5},5 L${pbox.w + 5},${pbox.h +\n                    5} L5,${pbox.h + 5} Z`}\n                />\n              </svg>\n              {r.type === \"box\" &&\n                !dragWithPrimary &&\n                !zoomWithPrimary &&\n                !r.locked &&\n                r.highlighted &&\n                mat.a < 1.2 &&\n                [\n                  [0, 0],\n                  [0.5, 0],\n                  [1, 0],\n                  [1, 0.5],\n                  [1, 1],\n                  [0.5, 1],\n                  [0, 1],\n                  [0, 0.5],\n                  [0.5, 0.5]\n                ].map(([px, py], i) => (\n                  <div\n                    key={i}\n                    className={classes.transformGrabber}\n                    {...mouseEvents}\n                    onMouseDown={e => {\n                      if (e.button === 0)\n                        return onBeginBoxTransform(r, [px * 2 - 1, py * 2 - 1])\n                      mouseEvents.onMouseDown(e)\n                    }}\n                    style={{\n                      left: pbox.x - 4 - 2 + pbox.w * px,\n                      top: pbox.y - 4 - 2 + pbox.h * py,\n                      cursor: boxCursorMap[py * 2][px * 2],\n                      borderRadius: px === 0.5 && py === 0.5 ? 4 : undefined\n                    }}\n                  />\n                ))}\n              {r.type === \"polygon\" &&\n                !dragWithPrimary &&\n                !zoomWithPrimary &&\n                !r.locked &&\n                r.highlighted &&\n                r.points.map(([px, py], i) => {\n                  const proj = mat\n                    .clone()\n                    .inverse()\n                    .applyToPoint(px * iw, py * ih)\n                  return (\n                    <div\n                      key={i}\n                      {...mouseEvents}\n                      onMouseDown={e => {\n                        if (e.button === 0 && (!r.open || i === 0))\n                          return onBeginMovePolygonPoint(r, i)\n                        mouseEvents.onMouseDown(e)\n                      }}\n                      className={classes.transformGrabber}\n                      style={{\n                        cursor: !r.open\n                          ? \"move\"\n                          : i === 0\n                            ? \"pointer\"\n                            : undefined,\n                        pointerEvents:\n                          r.open && i === r.points.length - 1\n                            ? \"none\"\n                            : undefined,\n                        left: proj.x - 4,\n                        top: proj.y - 4\n                      }}\n                    />\n                  )\n                })}\n              {r.type === \"polygon\" &&\n                r.highlighted &&\n                !dragWithPrimary &&\n                !zoomWithPrimary &&\n                !r.locked &&\n                !r.open &&\n                r.points.length > 1 &&\n                r.points\n                  .map((p1, i) => [p1, r.points[(i + 1) % r.points.length]])\n                  .map(([p1, p2]) => [(p1[0] + p2[0]) / 2, (p1[1] + p2[1]) / 2])\n                  .map((pa, i) => {\n                    const proj = mat\n                      .clone()\n                      .inverse()\n                      .applyToPoint(pa[0] * iw, pa[1] * ih)\n                    return (\n                      <div\n                        key={i}\n                        {...mouseEvents}\n                        onMouseDown={e => {\n                          if (e.button === 0)\n                            return onAddPolygonPoint(r, pa, i + 1)\n                          mouseEvents.onMouseDown(e)\n                        }}\n                        className={classes.transformGrabber}\n                        style={{\n                          cursor: \"copy\",\n                          left: proj.x - 4,\n                          top: proj.y - 4,\n                          border: \"2px dotted #fff\",\n                          opacity: 0.5\n                        }}\n                      />\n                    )\n                  })}\n            </Fragment>\n          )\n        })}\n      {showTags &&\n        regions\n          .filter(r => r.visible || r.visible === undefined)\n          .map(region => {\n            const pbox = projectRegionBox(region)\n            const { iw, ih } = layoutParams.current\n            let margin = 8\n            if (region.highlighted && region.type === \"box\") margin += 6\n            const labelBoxHeight =\n              region.editingLabels && !region.locked ? 170 : 40\n            const coords =\n              pbox.y > labelBoxHeight\n                ? {\n                    left: pbox.x,\n                    bottom: layoutParams.current.canvasHeight - pbox.y + margin\n                  }\n                : { left: pbox.x, top: pbox.y + pbox.h + margin / 2 }\n            if (region.locked) {\n              return (\n                <Paper\n                  style={{\n                    position: \"absolute\",\n                    ...coords,\n                    zIndex: 10,\n                    backgroundColor: \"#fff\",\n                    borderRadius: 4,\n                    padding: 2,\n                    paddingBottom: 0,\n                    opacity: 0.5,\n                    pointerEvents: \"none\"\n                  }}\n                >\n                  <LockIcon style={{ width: 16, height: 16, color: \"#333\" }} />\n                </Paper>\n              )\n            }\n            return (\n              <div\n                style={{\n                  position: \"absolute\",\n                  ...coords,\n                  zIndex: 10 + (region.editingLabels ? 5 : 0)\n                }}\n                {...(!region.editingLabels ? mouseEvents : {})}\n                onMouseDown={e => e.preventDefault()}\n                onMouseUp={e => e.preventDefault()}\n                onMouseEnter={e => {\n                  if (region.editingLabels) {\n                    mouseEvents.onMouseUp(e)\n                    e.button = 1\n                    mouseEvents.onMouseUp(e)\n                  }\n                }}\n              >\n                <RegionLabel\n                  allowedClasses={regionClsList}\n                  allowedTags={regionTagList}\n                  onOpen={onBeginRegionEdit}\n                  onChange={onChangeRegion}\n                  onClose={onCloseRegionEdit}\n                  onDelete={onDeleteRegion}\n                  editing={region.editingLabels}\n                  region={region}\n                />\n              </div>\n            )\n          })}\n      {zoomWithPrimary &&\n        zoomBox !== null && (\n          <div\n            style={{\n              position: \"absolute\",\n              border: \"1px solid #fff\",\n              pointerEvents: \"none\",\n              left: zoomBox.x,\n              top: zoomBox.y,\n              width: zoomBox.w,\n              height: zoomBox.h\n            }}\n          />\n        )}\n      <canvas {...mouseEvents} className={classes.canvas} ref={canvasEl} />\n      <div className={classes.zoomIndicator}>\n        {((1 / mat.a) * 100).toFixed(0)}%\n      </div>\n    </div>\n  )\n}\n","import { grey } from \"@material-ui/core/colors\"\n\nexport default {\n  \"@keyframes borderDance\": {\n    from: { strokeDashoffset: 0 },\n    to: { strokeDashoffset: 100 }\n  },\n  highlightBox: {\n    transition: \"opacity 500ms\",\n    \"&:not(.highlighted)\": {\n      opacity: 0\n    },\n    \"&:not(.highlighted):hover\": {\n      opacity: 0.6\n    },\n    \"& path\": {\n      vectorEffect: \"non-scaling-stroke\",\n      strokeWidth: 2,\n      stroke: \"#FFF\",\n      fill: \"none\",\n      strokeDasharray: 5,\n      animationName: \"$borderDance\",\n      animationDuration: \"4s\",\n      animationTimingFunction: \"linear\",\n      animationIterationCount: \"infinite\",\n      animationPlayState: \"running\"\n    }\n  },\n  canvas: { width: \"100%\", height: \"100%\" },\n  transformGrabber: {\n    width: 8,\n    height: 8,\n    border: \"2px solid #FFF\",\n    position: \"absolute\"\n  },\n  zoomIndicator: {\n    position: \"absolute\",\n    bottom: 0,\n    right: 0,\n    backgroundColor: \"rgba(0,0,0,0.4)\",\n    color: \"#fff\",\n    opacity: 0.5,\n    fontWeight: \"bolder\",\n    fontSize: 14,\n    padding: 4\n  }\n}\n","// @flow\n\nexport type BaseRegion = {\n  id: string | number,\n  cls?: string,\n  locked?: boolean,\n  visible?: boolean,\n  color: string,\n  editingLabels?: boolean,\n  highlighted?: boolean,\n  tags?: Array<string>\n}\n\nexport type Point = {|\n  ...$Exact<BaseRegion>,\n  type: \"point\",\n  x: number,\n  y: number\n|}\n\nexport type PixelRegion =\n  | {|\n      ...$Exact<BaseRegion>,\n      type: \"pixel\",\n      sx: number,\n      sy: number,\n      w: number,\n      h: number,\n      src: string\n    |}\n  | {|\n      ...$Exact<BaseRegion>,\n      type: \"pixel\",\n      points: Array<[number, number]>\n    |}\nexport type Box = {|\n  ...$Exact<BaseRegion>,\n  type: \"box\",\n  x: number,\n  y: number,\n  w: number,\n  h: number\n|}\nexport type Polygon = {|\n  ...$Exact<BaseRegion>,\n  type: \"polygon\",\n  open?: boolean,\n  points: Array<[number, number]>\n|}\n\nexport type Region = Point | PixelRegion | Box | Polygon\n\nexport const getEnclosingBox = (region: Region) => {\n  switch (region.type) {\n    case \"polygon\": {\n      const box = {\n        x: Math.min(...region.points.map(([x, y]) => x)),\n        y: Math.min(...region.points.map(([x, y]) => y)),\n        w: 0,\n        h: 0\n      }\n      box.w = Math.max(...region.points.map(([x, y]) => x)) - box.x\n      box.h = Math.max(...region.points.map(([x, y]) => y)) - box.y\n      return box\n    }\n    case \"box\": {\n      return { x: region.x, y: region.y, w: region.w, h: region.h }\n    }\n    case \"point\": {\n      return { x: region.x, y: region.y, w: 0, h: 0 }\n    }\n    case \"pixel\": {\n      if (\n        region.sx !== undefined &&\n        region.sy !== undefined &&\n        region.w &&\n        region.h\n      ) {\n        return { x: region.sx, y: region.sy, w: region.w, h: region.h }\n      }\n      if (region.points) {\n        const box = {\n          x: Math.min(...region.points.map(([x, y]) => x)),\n          y: Math.min(...region.points.map(([x, y]) => y)),\n          w: 0,\n          h: 0\n        }\n        box.w = Math.max(...region.points.map(([x, y]) => x)) - box.x\n        box.h = Math.max(...region.points.map(([x, y]) => y)) - box.y\n        return box\n      }\n    }\n  }\n  throw new Error(\"unknown region\")\n}\n\nexport const moveRegion = (region: Region, x: number, y: number) => {\n  switch (region.type) {\n    case \"point\": {\n      return { ...region, x, y }\n    }\n    case \"box\": {\n      return { ...region, x: x - region.w / 2, y: y - region.h / 2 }\n    }\n  }\n  return region\n}\n","export default `data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4wMSAxY5oG+lzgAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAAcSURBVAjXY/jPwPCfAQnA+TAGugLcAhhakRUAAK3lEe8m9qZhAAAAAElFTkSuQmCC`\n","// @flow\n\nimport React, { createContext } from \"react\"\nimport Button from \"@material-ui/core/Button\"\n\nexport const HeaderButtonContext = createContext()\n\nexport default ({ name, Icon }: { name: string, Icon: any }) => {\n  return (\n    <HeaderButtonContext.Consumer>\n      {({ onHeaderButtonClick }: any) => (\n        <Button\n          onClick={() => onHeaderButtonClick(name)}\n          style={{ width: 80, margin: 2 }}\n        >\n          <div>\n            <Icon style={{}} />\n            <div style={{ fontWeight: \"bold\" }}>{name}</div>\n          </div>\n        </Button>\n      )}\n    </HeaderButtonContext.Consumer>\n  )\n}\n","import { grey } from \"@material-ui/core/colors\"\n\nexport default {\n  header: {\n    display: \"flex\",\n    position: \"relative\",\n    flexDirection: \"row\",\n    flexShrink: 0,\n    zIndex: 10,\n    boxShadow: \"0px 3px 8px rgba(0,0,0,.1)\"\n  },\n  fileInfo: {\n    flexGrow: 1,\n    alignItems: \"center\",\n    display: \"flex\",\n    fontWeight: \"bold\",\n    color: grey[800],\n    fontSize: 24,\n    paddingLeft: 16\n  }\n}\n","// @flow\n\nimport React from \"react\"\nimport { makeStyles } from \"@material-ui/styles\"\nimport HeaderButton, { HeaderButtonContext } from \"../HeaderButton\"\nimport BackIcon from \"@material-ui/icons/KeyboardArrowLeft\"\nimport NextIcon from \"@material-ui/icons/KeyboardArrowRight\"\nimport SettingsIcon from \"@material-ui/icons/Settings\"\nimport HelpIcon from \"@material-ui/icons/Help\"\nimport FullscreenIcon from \"@material-ui/icons/Fullscreen\"\nimport ExitIcon from \"@material-ui/icons/ExitToApp\"\nimport HotkeysIcon from \"@material-ui/icons/Keyboard\"\nimport styles from \"./styles\"\n\nconst useStyles = makeStyles(styles)\n\ntype Props = {\n  onHeaderButtonClick: string => any,\n  title: string,\n  inFullScreen?: boolean\n}\n\nexport default ({ onHeaderButtonClick, title, inFullScreen }: Props) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.header}>\n      <div className={classes.fileInfo}>{title}</div>\n      <div className={classes.headerActions}>\n        <HeaderButtonContext.Provider value={{ onHeaderButtonClick }}>\n          <HeaderButton name=\"Prev\" Icon={BackIcon} />\n          <HeaderButton name=\"Next\" Icon={NextIcon} />\n          <HeaderButton name=\"Settings\" Icon={SettingsIcon} />\n          {/* <HeaderButton name=\"Help\" Icon={HelpIcon} /> */}\n          {inFullScreen ? (\n            <HeaderButton name=\"Window\" Icon={FullscreenIcon} />\n          ) : (\n            <HeaderButton name=\"Fullscreen\" Icon={FullscreenIcon} />\n          )}\n          {/* <HeaderButton name=\"Hotkeys\" Icon={HotkeysIcon} /> */}\n          <HeaderButton name=\"Done\" Icon={ExitIcon} />\n        </HeaderButtonContext.Provider>\n      </div>\n    </div>\n  )\n}\n","// @flow\n\nimport React, { createContext, useContext } from \"react\"\nimport IconButton from \"@material-ui/core/IconButton\"\nimport Tooltip from \"@material-ui/core/Tooltip\"\nimport { blue } from \"@material-ui/core/colors\"\n\nexport const SelectedTool = createContext()\n\nexport default ({\n  id,\n  name,\n  icon,\n  selected,\n  togglable,\n  alwaysShowing = false\n}: {\n  id: string,\n  name: string,\n  icon: any,\n  alwaysShowing?: boolean,\n  selected?: boolean,\n  togglable?: boolean\n}) => {\n  const { enabledTools, selectedTool, onClickTool } = useContext(SelectedTool)\n  if (!enabledTools.includes(id) && !alwaysShowing) return null\n  selected = selected || selectedTool === id\n  return (\n    <Tooltip placement=\"right\" title={name}>\n      <div>\n        <IconButton\n          disabled={!togglable ? selected : undefined}\n          aria-label={name}\n          onClick={() => onClickTool(id)}\n          size=\"small\"\n          style={{\n            width: 50,\n            height: 50,\n            margin: 1,\n            color: selected ? blue[500] : undefined\n          }}\n        >\n          {icon}\n        </IconButton>\n      </div>\n    </Tooltip>\n  )\n}\n","// @flow\n\nimport React from \"react\"\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport {\n  faArrowsAlt,\n  faMousePointer,\n  faExpandArrowsAlt,\n  faTag,\n  faPaintBrush,\n  faCrosshairs,\n  faDrawPolygon,\n  faVectorSquare,\n  faHandPaper,\n  faSearch\n} from \"@fortawesome/free-solid-svg-icons\"\nimport SmallToolButton, { SelectedTool } from \"../SmallToolButton\"\nimport { makeStyles } from \"@material-ui/styles\"\nimport { grey } from \"@material-ui/core/colors\"\n\nconst useStyles = makeStyles({\n  iconTools: {\n    display: \"flex\",\n    padding: 4,\n    flexDirection: \"column\",\n    zIndex: 9,\n    boxShadow: \"0px 0px 5px rgba(0,0,0,0.1)\",\n    borderRight: `1px solid ${grey[300]}`,\n    backgroundColor: grey[100]\n  }\n})\n\ntype Props = {\n  showTags?: boolean,\n  enabledTools?: Array<string>,\n  selectedTool: string,\n  onClickTool: string => any\n}\n\nexport default ({\n  showTags,\n  selectedTool,\n  onClickTool,\n  enabledTools = [\"select\", \"create-point\", \"create-box\", \"create-polygon\"]\n}: Props) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.iconTools}>\n      <SelectedTool.Provider\n        value={{ enabledTools, selectedTool, onClickTool }}\n      >\n        <SmallToolButton\n          id=\"select\"\n          name=\"Select Region\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faMousePointer} />}\n        />\n        <SmallToolButton\n          alwaysShowing\n          id=\"pan\"\n          name=\"Drag/Pan\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faHandPaper} />}\n        />\n        <SmallToolButton\n          alwaysShowing\n          id=\"zoom\"\n          name=\"Zoom In/Out\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faSearch} />}\n        />\n        {/* <SmallToolButton\n          name=\"Move Region\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faArrowsAlt} />}\n        />\n        <SmallToolButton\n          name=\"Resize Region\"\n          icon={\n            <FontAwesomeIcon size=\"xs\" fixedWidth icon={faExpandArrowsAlt} />\n          }\n        /> */}\n        <SmallToolButton\n          alwaysShowing\n          togglable\n          id=\"show-tags\"\n          selected={showTags}\n          name=\"Show Tags\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faTag} />}\n        />\n        <SmallToolButton\n          id=\"create-point\"\n          name=\"Add Point\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faCrosshairs} />}\n        />\n        <SmallToolButton\n          id=\"create-box\"\n          name=\"Add Bounding Box\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faVectorSquare} />}\n        />\n        <SmallToolButton\n          id=\"create-polygon\"\n          name=\"Add Polygon\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faDrawPolygon} />}\n        />\n        {/* <SmallToolButton\n          id=\"create-pixel\"\n          name=\"Add Pixel Region\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faPaintBrush} />}\n        /> */}\n      </SelectedTool.Provider>\n    </div>\n  )\n}\n","import { grey } from \"@material-ui/core/colors\"\n\nexport default {\n  container: {\n    display: \"flex\",\n    flexGrow: 1,\n    flexDirection: \"column\",\n    minHeight: \"98vh\",\n    maxHeight: \"100vh\",\n    backgroundColor: \"#fff\",\n    overflow: \"hidden\",\n    \"&.fullscreen\": {\n      position: \"absolute\",\n      zIndex: 99999,\n      left: 0,\n      right: 0,\n      top: 0,\n      bottom: 0\n    }\n  },\n  workspace: {\n    backgroundColor: grey[200],\n    flexGrow: 1,\n    display: \"flex\",\n    flexDirection: \"row\"\n  },\n  iconToolsContainer: { display: \"flex\" },\n  imageCanvasContainer: {\n    display: \"flex\",\n    flexGrow: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  },\n  noImageSelected: {\n    fontWeight: \"bold\",\n    fontSize: 32,\n    color: grey[500]\n  },\n  sidebarContainer: {\n    width: 300,\n    overflowY: \"auto\",\n    backgroundColor: grey[100],\n    borderLeft: `1px solid ${grey[300]}`,\n    zIndex: 9,\n    maxHeight: \"calc(100% - 68px)\",\n    boxShadow: \"0px 0px 5px rgba(0,0,0,0.1)\"\n  }\n}\n","// @flow\n\nimport React, { createContext, useContext, useState } from \"react\"\n\nconst defaultSettings = {\n  showCrosshairs: false\n}\n\nexport const SettingsContext = createContext(defaultSettings)\n\nconst pullSettingsFromLocalStorage = () => {\n  if (!window || !window.localStorage) return {}\n  let settings = {}\n  for (let i = 0; i < window.localStorage.length; i++) {\n    const key = window.localStorage.key(i)\n    if (key.startsWith(\"settings_\")) {\n      try {\n        settings[key.replace(\"settings_\", \"\")] = JSON.parse(\n          window.localStorage.getItem(key)\n        )\n      } catch (e) {}\n    }\n  }\n  return settings\n}\n\nexport const useSettings = () => useContext(SettingsContext)\n\nexport default ({ children }) => {\n  const [state, changeState] = useState(() => pullSettingsFromLocalStorage())\n  const changeSetting = (setting: string, value: any) => {\n    changeState({ ...state, [setting]: value })\n    window.localStorage.setItem(`settings_${setting}`, JSON.stringify(value))\n  }\n  return (\n    <SettingsContext.Provider value={{ ...state, changeSetting }}>\n      {children}\n    </SettingsContext.Provider>\n  )\n}\n","// @flow\n\nimport React from \"react\"\nimport Dialog from \"@material-ui/core/Dialog\"\nimport DialogTitle from \"@material-ui/core/DialogTitle\"\nimport DialogContent from \"@material-ui/core/DialogContent\"\nimport DialogActions from \"@material-ui/core/DialogActions\"\nimport Button from \"@material-ui/core/Button\"\nimport Survey from \"material-survey/components/Survey\"\nimport { useSettings } from \"../SettingsProvider\"\n\nexport default ({ open, onClose }) => {\n  const settings = useSettings()\n  return (\n    <Dialog open={open} onClose={onClose}>\n      <DialogTitle>Settings</DialogTitle>\n      <DialogContent style={{ minWidth: 400 }}>\n        <Survey\n          variant=\"flat\"\n          noActions\n          defaultAnswers={settings}\n          onQuestionChange={(q, a, answers) => {\n            settings.changeSetting(q, a)\n          }}\n          form={{\n            questions: [\n              {\n                type: \"boolean\",\n                title: \"Show Crosshairs\",\n                name: \"showCrosshairs\"\n              }\n            ]\n          }}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onClose}>Close</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n","// @flow\n\nimport React, { useState } from \"react\"\nimport Grid from \"@material-ui/core/Grid\"\nimport { makeStyles } from \"@material-ui/styles\"\nimport Sidebar from \"../Sidebar\"\nimport ImageCanvas from \"../ImageCanvas\"\nimport Header from \"../Header\"\nimport IconTools from \"../IconTools\"\nimport styles from \"./styles\"\nimport type { MainLayoutState, Action } from \"./types\"\nimport useKey from \"use-key-hook\"\nimport classnames from \"classnames\"\nimport { useSettings } from \"../SettingsProvider\"\nimport SettingsDialog from \"../SettingsDialog\"\nimport Fullscreen from \"react-full-screen\"\n\nconst useStyles = makeStyles(styles)\n\ntype Props = {\n  state: MainLayoutState,\n  dispatch: Action => any\n}\n\nexport default ({ state, dispatch }: Props) => {\n  const classes = useStyles()\n  const settings = useSettings()\n\n  const action = (type: string, ...params: Array<string>) => (...args: any) =>\n    params.length > 0\n      ? dispatch(\n          ({\n            type,\n            ...params.reduce((acc, p, i) => ((acc[p] = args[i]), acc), {})\n          }: any)\n        )\n      : dispatch({ type, ...args[0] })\n\n  const currentImage = state.images.find(img => img.src === state.selectedImage)\n\n  useKey(() => dispatch({ type: \"CANCEL\" }), {\n    detectKeys: [27]\n  })\n\n  return (\n    <Fullscreen\n      enabled={state.fullScreen}\n      onChange={open => {\n        if (!open) {\n          action(\"HEADER_BUTTON_CLICKED\", \"buttonName\")(\"Exit Fullscreen\")\n        }\n      }}\n    >\n      <div\n        className={classnames(\n          classes.container,\n          state.fullScreen && \"Fullscreen\"\n        )}\n      >\n        <div className={classes.headerContainer}>\n          <Header\n            onHeaderButtonClick={action(\"HEADER_BUTTON_CLICKED\", \"buttonName\")}\n            inFullScreen={state.fullScreen}\n            title={currentImage ? currentImage.name : \"No Image Selected\"}\n          />\n        </div>\n        <div className={classes.workspace}>\n          <div className={classes.iconToolsContainer}>\n            <IconTools\n              enabledTools={state.enabledTools}\n              showTags={state.showTags}\n              selectedTool={state.selectedTool}\n              onClickTool={action(\"SELECT_TOOL\", \"selectedTool\")}\n            />\n          </div>\n          <div className={classes.imageCanvasContainer}>\n            {!state.selectedImage ? (\n              <div className={classes.noImageSelected}>No Image Selected</div>\n            ) : (\n              <ImageCanvas\n                {...settings}\n                key={state.selectedImage}\n                showTags={state.showTags}\n                allowedArea={state.allowedArea}\n                regionClsList={state.regionClsList}\n                regionTagList={state.regionTagList}\n                regions={currentImage ? currentImage.regions || [] : []}\n                imageSrc={state.selectedImage}\n                createWithPrimary={state.selectedTool.includes(\"create\")}\n                dragWithPrimary={state.selectedTool === \"pan\"}\n                zoomWithPrimary={state.selectedTool === \"zoom\"}\n                onMouseMove={action(\"MOUSE_MOVE\")}\n                onMouseDown={action(\"MOUSE_DOWN\")}\n                onMouseUp={action(\"MOUSE_UP\")}\n                onChangeRegion={action(\"CHANGE_REGION\", \"region\")}\n                onBeginRegionEdit={action(\"OPEN_REGION_EDITOR\", \"region\")}\n                onCloseRegionEdit={action(\"CLOSE_REGION_EDITOR\", \"region\")}\n                onDeleteRegion={action(\"DELETE_REGION\", \"region\")}\n                onBeginBoxTransform={action(\n                  \"BEGIN_BOX_TRANSFORM\",\n                  \"box\",\n                  \"directions\"\n                )}\n                onBeginMovePolygonPoint={action(\n                  \"BEGIN_MOVE_POLYGON_POINT\",\n                  \"polygon\",\n                  \"pointIndex\"\n                )}\n                onAddPolygonPoint={action(\n                  \"ADD_POLYGON_POINT\",\n                  \"polygon\",\n                  \"point\",\n                  \"pointIndex\"\n                )}\n                onSelectRegion={action(\"SELECT_REGION\", \"region\")}\n                onBeginMovePoint={action(\"BEGIN_MOVE_POINT\", \"point\")}\n              />\n            )}\n          </div>\n          <div className={classes.sidebarContainer}>\n            <Sidebar\n              debug={window.localStorage.$ANNOTATE_DEBUG_MODE && state}\n              taskDescription={state.taskDescription}\n              images={state.images}\n              regions={currentImage ? currentImage.regions || [] : []}\n              history={state.history}\n              currentImage={currentImage}\n              labelImages={state.labelImages}\n              imageClsList={state.imageClsList}\n              imageTagList={state.imageTagList}\n              onChangeImage={action(\"CHANGE_IMAGE\", \"delta\")}\n              onSelectRegion={action(\"SELECT_REGION\", \"region\")}\n              onDeleteRegion={action(\"DELETE_REGION\", \"region\")}\n              onSelectImage={action(\"SELECT_IMAGE\", \"image\")}\n              onChangeRegion={action(\"CHANGE_REGION\", \"region\")}\n              onRestoreHistory={action(\"RESTORE_HISTORY\")}\n            />\n          </div>\n        </div>\n        <SettingsDialog\n          open={state.settingsOpen}\n          onClose={() =>\n            dispatch({\n              type: \"HEADER_BUTTON_CLICKED\",\n              buttonName: \"Settings\"\n            })\n          }\n        />\n      </div>\n    </Fullscreen>\n  )\n}\n","// @flow\n\nimport type { MainLayoutState, Action } from \"../MainLayout/types\"\nimport { moveRegion } from \"../ImageCanvas/region-tools.js\"\nimport { setIn, updateIn } from \"seamless-immutable\"\nimport moment from \"moment\"\nimport isEqual from \"lodash/isEqual\"\n\nconst getRandomId = () =>\n  Math.random()\n    .toString()\n    .split(\".\")[1]\n\nconst getRandomInt = (min, max) => {\n  return Math.floor(Math.random() * (max - min + 1)) + min\n}\n\nconst getRandomColor = () => {\n  const h = getRandomInt(0, 360)\n  const s = 100\n  const l = 50\n  return `hsl(${h},${s}%,${l}%)`\n}\n\nconst typesToSaveWithHistory = {\n  BEGIN_BOX_TRANSFORM: \"Transform/Move Box\",\n  BEGIN_MOVE_POINT: \"Move Point\",\n  DELETE_REGION: \"Delete Region\"\n}\n\nexport default (state: MainLayoutState, action: Action) => {\n  if (!action.type.includes(\"MOUSE\")) {\n    state = setIn(state, [\"lastAction\"], action)\n  }\n  let currentImageIndex = state.images.findIndex(\n    img => img.src === state.selectedImage\n  )\n  if (currentImageIndex === -1) currentImageIndex = null\n  const getRegionIndex = region => {\n    const regionId = typeof region === \"string\" ? region : region.id\n    if (currentImageIndex === null) return null\n    const regionIndex = (\n      state.images[currentImageIndex].regions || []\n    ).findIndex(r => r.id === regionId)\n    return regionIndex === -1 ? null : regionIndex\n  }\n  const getRegion = regionId => {\n    const regionIndex = getRegionIndex(regionId)\n    if (regionIndex === null) return [null, null]\n    const region = state.images[currentImageIndex].regions[regionIndex]\n    return [region, regionIndex]\n  }\n  const modifyRegion = (regionId, obj) => {\n    const [region, regionIndex] = getRegion(regionId)\n    if (!region) return state\n    if (obj !== null) {\n      return setIn(\n        state,\n        [\"images\", currentImageIndex, \"regions\", regionIndex],\n        {\n          ...state.images[currentImageIndex].regions[regionIndex],\n          ...obj\n        }\n      )\n    } else {\n      // delete region\n      const regions = state.images[currentImageIndex].regions\n      return setIn(\n        state,\n        [\"images\", currentImageIndex, \"regions\"],\n        (regions || []).filter(r => r.id !== region.id)\n      )\n    }\n  }\n  const unselectRegions = (state: MainLayoutState) => {\n    if (currentImageIndex === null) return state\n    return setIn(\n      state,\n      [\"images\", currentImageIndex, \"regions\"],\n      (state.images[currentImageIndex].regions || []).map(r => ({\n        ...r,\n        highlighted: false\n      }))\n    )\n  }\n\n  const saveToHistory = (state: MainLayoutState, name: string) =>\n    updateIn(state, [\"history\"], h =>\n      [\n        {\n          time: moment().toDate(),\n          state,\n          name\n        }\n      ].concat((h || []).slice(0, 9))\n    )\n\n  if (Object.keys(typesToSaveWithHistory).includes(action.type)) {\n    state = saveToHistory(\n      state,\n      typesToSaveWithHistory[action.type] || action.type\n    )\n  }\n\n  const closeEditors = (state: MainLayoutState) => {\n    if (currentImageIndex === null) return state\n    return setIn(\n      state,\n      [\"images\", currentImageIndex, \"regions\"],\n      (state.images[currentImageIndex].regions || []).map(r => ({\n        ...r,\n        editingLabels: false\n      }))\n    )\n  }\n\n  const setNewImage = (newImage: string) => {\n    return setIn(state, [\"selectedImage\"], newImage)\n  }\n\n  switch (action.type) {\n    case \"@@INIT\": {\n      return state\n    }\n    case \"SELECT_IMAGE\": {\n      return setNewImage(action.image.src)\n    }\n    case \"CHANGE_REGION\": {\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      const oldRegion = state.images[currentImageIndex].regions[regionIndex]\n      if (oldRegion.cls !== action.region.cls) {\n        state = saveToHistory(state, \"Change Region Classification\")\n      }\n      if (!isEqual(oldRegion.tags, action.region.tags)) {\n        state = saveToHistory(state, \"Change Region Tags\")\n      }\n      return setIn(\n        state,\n        [\"images\", currentImageIndex, \"regions\", regionIndex],\n        action.region\n      )\n    }\n    case \"RESTORE_HISTORY\": {\n      if (state.history.length > 0) {\n        return state.history[0].state\n      }\n      return state\n    }\n    case \"CHANGE_IMAGE\": {\n      if (currentImageIndex === null) return state\n      const { delta } = action\n      for (const key of Object.keys(delta)) {\n        if (key === \"cls\") saveToHistory(state, \"Change Image Class\")\n        if (key === \"tags\") saveToHistory(state, \"Change Image Tags\")\n        state = setIn(state, [\"images\", currentImageIndex, key], delta[key])\n      }\n      return state\n    }\n    case \"SELECT_REGION\": {\n      const { region } = action\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      const regions = [...(state.images[currentImageIndex].regions || [])].map(\n        r => ({\n          ...r,\n          highlighted: r.id === region.id,\n          editingLabels: r.id === region.id\n        })\n      )\n      return setIn(state, [\"images\", currentImageIndex, \"regions\"], regions)\n    }\n    case \"BEGIN_MOVE_POINT\": {\n      state = closeEditors(state)\n      return setIn(state, [\"mode\"], {\n        mode: \"MOVE_REGION\",\n        regionId: action.point.id\n      })\n    }\n    case \"BEGIN_BOX_TRANSFORM\": {\n      const { box, directions } = action\n      state = closeEditors(state)\n      if (directions[0] === 0 && directions[1] === 0) {\n        return setIn(state, [\"mode\"], { mode: \"MOVE_REGION\", regionId: box.id })\n      } else {\n        return setIn(state, [\"mode\"], {\n          mode: \"RESIZE_BOX\",\n          regionId: box.id,\n          freedom: directions,\n          original: { x: box.x, y: box.y, w: box.w, h: box.h }\n        })\n      }\n    }\n    case \"BEGIN_MOVE_POLYGON_POINT\": {\n      const { polygon, pointIndex } = action\n      state = closeEditors(state)\n      if (\n        state.mode &&\n        state.mode.mode === \"DRAW_POLYGON\" &&\n        pointIndex === 0\n      ) {\n        return setIn(\n          modifyRegion(polygon, {\n            points: polygon.points.slice(0, -1),\n            open: false\n          }),\n          [\"mode\"],\n          null\n        )\n      } else {\n        state = saveToHistory(state, \"Move Polygon Point\")\n      }\n      return setIn(state, [\"mode\"], {\n        mode: \"MOVE_POLYGON_POINT\",\n        regionId: polygon.id,\n        pointIndex\n      })\n    }\n    case \"ADD_POLYGON_POINT\": {\n      const { polygon, point, pointIndex } = action\n      const regionIndex = getRegionIndex(polygon)\n      if (regionIndex === null) return state\n      const points = [...polygon.points]\n      points.splice(pointIndex, 0, point)\n      return setIn(\n        state,\n        [\"images\", currentImageIndex, \"regions\", regionIndex],\n        { ...polygon, points }\n      )\n    }\n    case \"MOUSE_MOVE\": {\n      const { x, y } = action\n      if (!state.mode) return state\n      if (currentImageIndex === null) return state\n      switch (state.mode.mode) {\n        case \"MOVE_POLYGON_POINT\": {\n          const { pointIndex, regionId } = state.mode\n          const regionIndex = getRegionIndex(regionId)\n          if (regionIndex === null) return state\n          return setIn(\n            state,\n            [\n              \"images\",\n              currentImageIndex,\n              \"regions\",\n              regionIndex,\n              \"points\",\n              pointIndex\n            ],\n            [x, y]\n          )\n        }\n        case \"MOVE_REGION\": {\n          const { regionId } = state.mode\n          const regionIndex = getRegionIndex(regionId)\n          if (regionIndex === null) return state\n          return setIn(\n            state,\n            [\"images\", currentImageIndex, \"regions\", regionIndex],\n            moveRegion(\n              state.images[currentImageIndex].regions[regionIndex],\n              x,\n              y\n            )\n          )\n        }\n        case \"RESIZE_BOX\": {\n          const {\n            regionId,\n            freedom: [xFree, yFree],\n            original: { x: ox, y: oy, w: ow, h: oh }\n          } = state.mode\n          const regionIndex = getRegionIndex(regionId)\n          if (regionIndex === null) return state\n          const box = state.images[currentImageIndex].regions[regionIndex]\n\n          const dx = xFree === 0 ? ox : xFree === -1 ? Math.min(ox + ow, x) : ox\n          const dw =\n            xFree === 0\n              ? ow\n              : xFree === -1\n              ? ow + (ox - dx)\n              : Math.max(0, ow + (x - ox - ow))\n          const dy = yFree === 0 ? oy : yFree === -1 ? Math.min(oy + oh, y) : oy\n          const dh =\n            yFree === 0\n              ? oh\n              : yFree === -1\n              ? oh + (oy - dy)\n              : Math.max(0, oh + (y - oy - oh))\n\n          // determine if we should switch the freedom\n          if (dw <= 0.001) {\n            state = setIn(state, [\"mode\", \"freedom\"], [xFree * -1, yFree])\n          }\n          if (dh <= 0.001) {\n            state = setIn(state, [\"mode\", \"freedom\"], [xFree, yFree * -1])\n          }\n\n          return setIn(\n            state,\n            [\"images\", currentImageIndex, \"regions\", regionIndex],\n            { ...box, x: dx, w: dw, y: dy, h: dh }\n          )\n        }\n        case \"DRAW_POLYGON\": {\n          const { regionId } = state.mode\n          const [region, regionIndex] = getRegion(regionId)\n          if (!region) return setIn(state, [\"mode\"], null)\n          return setIn(\n            state,\n            [\n              \"images\",\n              currentImageIndex,\n              \"regions\",\n              regionIndex,\n              \"points\",\n              (region: any).points.length - 1\n            ],\n            [x, y]\n          )\n        }\n      }\n      return state\n    }\n    case \"MOUSE_DOWN\": {\n      const { x, y } = action\n\n      let newRegion\n      if (currentImageIndex !== null) {\n        const region = state.images[currentImageIndex].regions\n\n        if (state.allowedArea) {\n          const aa = state.allowedArea\n          if (x < aa.x || x > aa.x + aa.w || y < aa.y || y > aa.y + aa.h) {\n            return state\n          }\n        }\n\n        switch (state.selectedTool) {\n          case \"create-point\": {\n            state = saveToHistory(state, \"Create Point\")\n            newRegion = {\n              type: \"point\",\n              x,\n              y,\n              highlighted: true,\n              editingLabels: true,\n              color: getRandomColor(),\n              id: getRandomId()\n            }\n            break\n          }\n          case \"create-box\": {\n            state = saveToHistory(state, \"Create Box\")\n            newRegion = {\n              type: \"box\",\n              x: x,\n              y: x,\n              w: 0.01,\n              h: 0.01,\n              highlighted: true,\n              editingLabels: false,\n              color: getRandomColor(),\n              id: getRandomId()\n            }\n            state = unselectRegions(state)\n            state = setIn(state, [\"mode\"], {\n              mode: \"RESIZE_BOX\",\n              editLabelEditorAfter: true,\n              regionId: newRegion.id,\n              freedom: [1, 1],\n              original: { x, y, w: newRegion.w, h: newRegion.h }\n            })\n            break\n          }\n          case \"create-polygon\": {\n            if (state.mode && state.mode.mode === \"DRAW_POLYGON\") break\n            state = saveToHistory(state, \"Create Polygon\")\n            newRegion = {\n              type: \"polygon\",\n              points: [[x, y], [x, y]],\n              open: true,\n              highlighted: true,\n              color: getRandomColor(),\n              id: getRandomId()\n            }\n            state = setIn(state, [\"mode\"], {\n              mode: \"DRAW_POLYGON\",\n              regionId: newRegion.id\n            })\n            break\n          }\n        }\n      }\n\n      if (newRegion) {\n        state = unselectRegions(state)\n      }\n\n      if (state.mode) {\n        switch (state.mode.mode) {\n          case \"DRAW_POLYGON\": {\n            const [polygon, regionIndex] = getRegion(state.mode.regionId)\n            if (!polygon) break\n            state = setIn(\n              state,\n              [\"images\", currentImageIndex, \"regions\", regionIndex],\n              { ...polygon, points: polygon.points.concat([[x, y]]) }\n            )\n          }\n        }\n      }\n\n      const regions = [...(state.images[currentImageIndex].regions || [])]\n        .map(r => ({\n          ...r,\n          editingLabels: false\n        }))\n        .concat(newRegion ? [newRegion] : [])\n\n      return setIn(state, [\"images\", currentImageIndex, \"regions\"], regions)\n    }\n    case \"MOUSE_UP\": {\n      const { x, y } = action\n      if (!state.mode) return state\n      switch (state.mode.mode) {\n        case \"RESIZE_BOX\": {\n          if (state.mode.editLabelEditorAfter) {\n            return {\n              ...modifyRegion(state.mode.regionId, { editingLabels: true }),\n              mode: null\n            }\n          }\n        }\n        case \"MOVE_REGION\":\n        case \"MOVE_POLYGON_POINT\": {\n          return { ...state, mode: null }\n        }\n      }\n      return state\n    }\n    case \"CHANGE_REGION\": {\n      const { region } = action\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      return setIn(\n        state,\n        [\"images\", currentImageIndex, \"regions\", regionIndex],\n        region\n      )\n    }\n    case \"OPEN_REGION_EDITOR\": {\n      const { region } = action\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      const newRegions = setIn(\n        state.images[currentImageIndex].regions.map(r => ({\n          ...r,\n          highlighted: false,\n          editingLabels: false\n        })),\n        [regionIndex],\n        {\n          ...(state.images[currentImageIndex].regions || [])[regionIndex],\n          highlighted: true,\n          editingLabels: true\n        }\n      )\n      return setIn(state, [\"images\", currentImageIndex, \"regions\"], newRegions)\n    }\n    case \"CLOSE_REGION_EDITOR\": {\n      const { region } = action\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      return setIn(\n        state,\n        [\"images\", currentImageIndex, \"regions\", regionIndex],\n        {\n          ...(state.images[currentImageIndex].regions || [])[regionIndex],\n          editingLabels: false\n        }\n      )\n    }\n    case \"DELETE_REGION\": {\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      return setIn(\n        state,\n        [\"images\", currentImageIndex, \"regions\"],\n        (state.images[currentImageIndex].regions || []).filter(\n          r => r.id !== action.region.id\n        )\n      )\n    }\n    case \"HEADER_BUTTON_CLICKED\": {\n      const buttonName = action.buttonName.toLowerCase()\n      switch (buttonName) {\n        case \"prev\": {\n          if (currentImageIndex === null) return state\n          if (currentImageIndex === 0) return state\n          return setNewImage(state.images[currentImageIndex - 1].src)\n        }\n        case \"next\": {\n          if (currentImageIndex === null) return state\n          if (currentImageIndex === state.images.length - 1) return state\n          return setNewImage(state.images[currentImageIndex + 1].src)\n        }\n        case \"settings\": {\n          return setIn(state, [\"settingsOpen\"], !state.settingsOpen)\n        }\n        case \"help\": {\n          return state\n        }\n        case \"fullscreen\": {\n          return setIn(state, [\"fullScreen\"], true)\n        }\n        case \"exit fullscreen\":\n        case \"window\": {\n          return setIn(state, [\"fullScreen\"], false)\n        }\n        case \"hotkeys\": {\n          return state\n        }\n        case \"exit\":\n        case \"done\": {\n          return state\n        }\n      }\n      return state\n      // return setIn(state, [\"\"]\n    }\n    case \"SELECT_TOOL\": {\n      state = setIn(state, [\"mode\"], null)\n      if (action.selectedTool === \"show-tags\") {\n        return setIn(state, [\"showTags\"], !state.showTags)\n      }\n      return setIn(state, [\"selectedTool\"], action.selectedTool)\n    }\n    case \"CANCEL\": {\n      const { mode } = state\n      if (mode) {\n        switch (mode.mode) {\n          case \"DRAW_POLYGON\": {\n            const { regionId } = mode\n            return modifyRegion(regionId, null)\n          }\n          case \"MOVE_POLYGON_POINT\":\n          case \"RESIZE_BOX\":\n          case \"MOVE_REGION\": {\n            return setIn(state, [\"mode\"], null)\n          }\n        }\n      }\n      // Close any open boxes\n      const regions: any = state.images[currentImageIndex].regions\n      if (regions.some(r => r.editingLabels)) {\n        return setIn(\n          state,\n          [\"images\", currentImageIndex, \"regions\"],\n          regions.map(r => ({\n            ...r,\n            editingLabels: false\n          }))\n        )\n      } else {\n        return setIn(\n          state,\n          [\"images\", currentImageIndex, \"regions\"],\n          regions.map(r => ({\n            ...r,\n            highlighted: false\n          }))\n        )\n      }\n    }\n  }\n  return state\n}\n","// @flow\n\nimport React, { useReducer } from \"react\"\nimport MainLayout from \"../MainLayout\"\nimport type {\n  ToolEnum,\n  Image,\n  Mode,\n  MainLayoutState,\n  Action\n} from \"../MainLayout/types\"\nimport reducer from \"./reducer\"\n\ntype Props = {\n  taskDescription: string,\n  allowedArea?: { x: number, y: number, w: number, h: number },\n  regionTagList?: Array<string>,\n  regionClsList?: Array<string>,\n  imageTagList?: Array<string>,\n  imageClsList?: Array<string>,\n  enabledTools?: Array<string>,\n  showTags?: boolean,\n  selectedImage?: string,\n  images: Array<Image>,\n  onExit: MainLayoutState => any\n}\n\nexport default ({\n  images,\n  allowedArea,\n  selectedImage = images.length > 0 ? images[0].src : undefined,\n  showTags = true,\n  enabledTools = [\"select\", \"create-point\", \"create-box\", \"create-polygon\"],\n  regionTagList = [],\n  regionClsList = [],\n  imageTagList = [],\n  imageClsList = [],\n  taskDescription,\n  onExit\n}: Props) => {\n  const [state, dispatchToReducer] = useReducer(reducer, {\n    showTags,\n    allowedArea,\n    selectedImage,\n    selectedTool: \"select\",\n    mode: null,\n    taskDescription,\n    images,\n    labelImages: imageClsList.length > 0 || imageTagList.length > 0,\n    regionClsList,\n    regionTagList,\n    imageClsList,\n    imageTagList,\n    enabledTools,\n    history: []\n  })\n\n  const dispatch = (action: Action) => {\n    if (\n      action.type === \"HEADER_BUTTON_CLICKED\" &&\n      (action.buttonName === \"Exit\" ||\n        action.buttonName === \"Done\" ||\n        action.buttonName === \"Complete\")\n    ) {\n      onExit({ ...state, history: undefined })\n    } else {\n      dispatchToReducer(action)\n    }\n  }\n\n  return <MainLayout debug state={state} dispatch={dispatch} />\n}\n","// @flow\n\nimport React, { Component } from \"react\"\nimport Dialog from \"@material-ui/core/Dialog\"\nimport Button from \"@material-ui/core/Button\"\nimport DialogTitle from \"@material-ui/core/DialogTitle\"\nimport DialogContent from \"@material-ui/core/DialogContent\"\nimport DialogActions from \"@material-ui/core/DialogActions\"\n\nexport default class ErrorBoundaryDialog extends Component {\n  state = { hasError: false, err: \"\" }\n  componentDidCatch(err, info) {\n    this.setState({\n      hasError: true,\n      err: err.toString() + \"\\n\\n\" + info.componentStack\n    })\n  }\n  render() {\n    if (this.state.hasError) {\n      return (\n        <Dialog open={this.state.hasError} onClose={this.props.onClose}>\n          <DialogTitle>Error Loading Annotator</DialogTitle>\n          <DialogContent>\n            <pre>{this.state.err}</pre>\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={this.props.onClose}>Close</Button>\n          </DialogActions>\n        </Dialog>\n      )\n    }\n    return this.props.children\n  }\n}\n","// @flow\n\nimport React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport Theme from \"./Theme\"\nimport DemoSite from \"./DemoSite\"\n\nReactDOM.render(\n  <Theme>\n    <DemoSite />\n  </Theme>,\n  document.getElementById(\"root\")\n)\n","// @flow\nimport React, { useState } from \"react\"\nimport ReactDOM from \"react-dom\"\nimport Editor, { examples } from \"./Editor\"\nimport Annotator from \"../Annotator\"\nimport ErrorBoundaryDialog from \"./ErrorBoundaryDialog.js\"\n\nexport default () => {\n  const [annotatorOpen, changeAnnotatorOpen] = useState(false)\n  const [annotatorProps, changeAnnotatorProps] = useState(examples[\"Custom\"]())\n  const [lastOutput, changeLastOutput] = useState()\n\n  return (\n    <div>\n      {annotatorOpen ? (\n        <ErrorBoundaryDialog\n          onClose={() => {\n            changeAnnotatorOpen(false)\n          }}\n        >\n          <Annotator\n            {...(annotatorProps: any)}\n            onExit={output => {\n              delete (output: any)[\"lastAction\"]\n              changeLastOutput(output)\n              changeAnnotatorOpen(false)\n            }}\n          />\n        </ErrorBoundaryDialog>\n      ) : (\n        <Editor\n          lastOutput={lastOutput}\n          onOpenAnnotator={props => {\n            changeAnnotatorProps(props)\n            changeAnnotatorOpen(true)\n          }}\n        />\n      )}\n    </div>\n  )\n}\n"],"sourceRoot":""}
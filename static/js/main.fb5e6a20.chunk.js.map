{"version":3,"sources":["Theme/index.js","DemoSite/Editor.js","SidebarBoxContainer/index.js","TaskDescriptionSidebarBox/index.js","ImageSelectorSidebarBox/index.js","RegionSelectorSidebarBox/styles.js","RegionSelectorSidebarBox/index.js","HistorySidebarBox/index.js","DebugSidebarBox/index.js","TagsSidebarBox/index.js","Sidebar/index.js","Crosshairs/index.js","RegionLabel/styles.js","RegionLabel/index.js","HighlightBox/index.js","PreventScrollToParents/index.js","ImageCanvas/index.js","ImageCanvas/styles.js","ImageCanvas/region-tools.js","ImageCanvas/xpattern.js","HeaderButton/index.js","Header/styles.js","Header/index.js","SmallToolButton/index.js","IconTools/index.js","MainLayout/styles.js","SettingsProvider/index.js","SettingsDialog/index.js","MainLayout/index.js","Annotator/reducer.js","Annotator/index.js","DemoSite/ErrorBoundaryDialog.js","DemoSite/index.js","LandingPage/index.js","index.js"],"names":["useStyles","makeStyles","container","fontFamily","theme","createMuiTheme","typography","overrides","MuiButton","root","textTransform","Theme","_ref","children","classes","react_default","a","createElement","ThemeProvider","className","editBar","padding","borderBottom","backgroundColor","display","alignItems","& .button","margin","select","width","fontSize","contentArea","specificationArea","loadSavedInput","JSON","parse","window","localStorage","getItem","e","examples","Simple Bounding Box","taskDescription","regionTagList","regionClsList","enabledTools","images","src","name","Simple Segmentation","Custom","Editor","onOpenAnnotator","lastOutput","c","_useState","useState","_useState2","Object","slicedToArray","currentError","changeCurrentError","_useState3","_useState4","selectedExample","changeSelectedExample","_useState5","_useState6","outputDialogOpen","changeOutputOpen","_useState7","stringify","_useState8","currentJSONValue","changeCurrentJSONValue","style","flexGrow","react_select_esm","value","label","options","keys","map","s","onChange","selectedOption","Button","disabled","onClick","variant","Boolean","border","lib_default","language","code","setItem","toString","height","default_highlight","Dialog","fullScreen","open","DialogTitle","DialogContent","minWidth","DialogActions","header","flexDirection","paddingLeft","paddingRight","title","fontWeight","color","grey","& span","expandButton","& .icon","marginTop","transition","&.expanded","transform","expandedContent","maxHeight","overflowY","&.noScroll","overflow","SidebarBoxContainer","icon","subTitle","_ref$noScroll","noScroll","_ref$expandedByDefaul","expandedByDefault","content","classnames","expanded","changeExpanded","Paper","IconButton","ExpandMore_default","Collapse","in","markdownContainer","& h1","& h2","& h3","& h4","& h5","& h6","& p","& a","& img","TaskDescriptionSidebarBox","description","Description_default","react_markdown_default","source","img","borderRadius","ImageSelectorSidebarBox","onSelect","concat","length","Collections_default","List","i","ListItem","button","dense","key","ListItemText","primary","secondary","regions","styles","& .icon2","opacity","&:hover","cursor","row","&.header:hover","&.highlighted","blue","chip","& .color","marginRight","& .text","Chip","text","Row","_ref2","highlighted","order","classification","area","trash","tags","lock","visible","changeMouseOver","onMouseEnter","onMouseLeave","Grid","item","xs","textAlign","RegionSelectorSidebarBox","_ref3","onDeleteRegion","onChangeRegion","onSelectRegion","PictureInPicture_default","RegionSelectorSidebarBox_Row","SwapVert_default","PieChart_default","Delete_default","Lock_default","Visibility_default","borderTop","marginBottom","r","id","RegionSelectorSidebarBox_Chip","cls","locked","objectSpread","LockOpen_default","undefined","VisibilityOff_default","emptyText","HistorySidebarBox","history","onRestoreHistory","History_default","time","moment","format","ListItemSecondaryAction","Undo_default","DebugSidebarBox","state","lastAction","image","find","selectedImage","region","mode","TagsSidebarBox","currentImage","_ref$imageClsList","imageClsList","_ref$imageTagList","imageTagList","onChangeImage","_currentImage$tags","_currentImage$cls","Style_default","placeholder","o","paddingTop","isMulti","Sidebar","debug","labelImages","onSelectImage","Crosshairs","mousePosition","x","y","changeForceRenderState","current","useEffect","interval","setInterval","clearInterval","react","position","left","pointerEvents","top","RegionLabel_styles","regionInfo","& .name","& .circle","boxShadow","& .tags","& .tag","textDecoration","RegionLabel","editing","_ref$allowedClasses","allowedClasses","_ref$allowedTags","allowedTags","onDelete","onClose","onOpen","textShadow","type","tabIndex","size","newTags","t","Check_default","@keyframes borderDance","from","strokeDashoffset","to","highlightBox","&:not(.highlighted)","&:not(.highlighted):hover","& path","vectorEffect","strokeWidth","stroke","fill","strokeDasharray","animationName","animationDuration","animationTimingFunction","animationIterationCount","animationPlayState","HighlightBox","mouseEvents","dragWithPrimary","zoomWithPrimary","createWithPrimary","onBeginMovePoint","pbox","assign","onMouseDown","w","h","d","Container","styled","& > div","PreventScrollToParents","otherProps","objectWithoutProperties","mouseOver","Combination","enabled","removeScrollBar","canvas","transformGrabber","zoomIndicator","bottom","right","pointDistanceIndicator","& text","boxCursorMap","getDefaultMat","Matrix","ImageCanvas","imageSrc","realSize","showTags","_ref$onMouseMove","onMouseMove","p","_ref$onMouseDown","_ref$onMouseUp","onMouseUp","_ref$dragWithPrimary","_ref$zoomWithPrimary","_ref$createWithPrimar","_ref$pointDistancePre","pointDistancePrecision","showCrosshairs","showPointDistances","allowedArea","onImageLoaded","onBeginRegionEdit","onCloseRegionEdit","onBeginBoxTransform","onBeginMovePolygonPoint","onAddPolygonPoint","canvasEl","useRef","layoutParams","excludePattern","changeImageLoaded","dragging","changeDragging","maskImagesLoaded","changeMaskImagesLoaded","zoomStart","changeZoomStart","_useState9","_useState10","zoomEnd","changeZoomEnd","prevMousePosition","_useState11","_useState12","mat","changeMat","maskImages","projectRegionBox","applyToPoint","_layoutParams$current","iw","ih","bbox","box","Math","min","apply","toConsumableArray","points","_ref4","max","_ref5","_ref6","_ref7","_ref8","sx","sy","_ref9","_ref10","_ref11","_ref12","_ref13","_ref14","_ref15","_ref16","Error","getEnclosingBox","cbox","clone","inverse","useLayoutEffect","Image","onload","naturalWidth","naturalHeight","clientWidth","clientHeight","context","getContext","pattern","createPattern","save","toArray","fitScale","canvasWidth","canvasHeight","drawImage","globalAlpha","outer","inner","moveTo","forEach","lineTo","closePath","reverse","fillStyle","restore","lineWidth","shadowColor","shadowBlur","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_loop","beginPath","strokeStyle","arc","PI","strokeRect","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","Symbol","iterator","next","done","point","err","return","nodeName","newCanvas","document","ctx","imgData","getImageData","data","_imgData$data$slice","slice","_imgData$data$slice2","g","b","black","clearRect","putImageData","_iterator","filter","zoomIn","direction","mx","my","scale","translate","scaleU","_canvasEl$current$get","getBoundingClientRect","clientX","clientY","projMouse","_layoutParams$current2","preventDefault","specialEvent","arguments","_layoutParams$current3","abs","_layoutParams$current4","newMat","_layoutParams$current5","onWheel","deltaY","_layoutParams$current6","zoomBox","_layoutParams$current7","px","py","proj","p1","p2","pa","_layoutParams$current8","labelBoxHeight","editingLabels","displayOnTop","coords","zIndex","paddingBottom","r1","flatMap","i1","r2","i2","displayDistance","pr1","pr2","prm","unitName","sqrt","pow","toFixed","ref","HeaderButtonContext","createContext","HeaderButton","Icon","Consumer","onHeaderButtonClick","Header_styles","flexShrink","fileInfo","Header","inFullScreen","multipleImages","headerActions","Provider","Fragment","BackIcon","NextIcon","SettingsIcon","FullscreenIcon","ExitIcon","SelectedTool","SmallToolButton","selected","togglable","_ref$alwaysShowing","alwaysShowing","_useContext","useContext","selectedTool","onClickTool","includes","Tooltip","placement","aria-label","iconTools","borderRight","IconTools","_ref$enabledTools","index_es","fixedWidth","faMousePointer","faHandPaper","faSearch","faTag","faCrosshairs","faVectorSquare","faDrawPolygon","MainLayout_styles","minHeight","&.fullscreen","workspace","iconToolsContainer","imageCanvasContainer","justifyContent","noImageSelected","sidebarContainer","borderLeft","SettingsContext","useSettings","SettingsProvider","settings","startsWith","replace","pullSettingsFromLocalStorage","changeState","changeSetting","setting","defineProperty","SettingsDialog","Survey_default","noActions","defaultAnswers","onQuestionChange","q","answers","form","questions","MainLayout","_Object$assign","dispatch","action","_len","params","Array","_key","_len2","args","_key2","reduce","acc","useKey","detectKeys","react_full_screen_dist_default","headerContainer","$ANNOTATE_DEBUG_MODE","settingsOpen","buttonName","getRandomId","random","split","getRandomColor","floor","typesToSaveWithHistory","BEGIN_BOX_TRANSFORM","BEGIN_MOVE_POINT","DELETE_REGION","reducer","setIn","currentImageIndex","findIndex","getRegionIndex","regionId","regionIndex","getRegion","modifyRegion","obj","_getRegion","_getRegion2","unselectRegions","saveToHistory","updateIn","toDate","closeEditors","setNewImage","newImage","oldRegion","isEqual","delta","_i","_Object$keys","directions","freedom","original","polygon","pointIndex","splice","_state$mode","moveRegion","_state$mode2","_state$mode2$freedom","xFree","yFree","_state$mode2$original","ox","oy","ow","oh","dx","dw","dy","dh","_getRegion3","_getRegion4","newRegion","aa","editLabelEditorAfter","_getRegion5","_getRegion6","newRegions","toLowerCase","some","Annotator","_ref$selectedImage","_ref$showTags","_ref$regionTagList","_ref$regionClsList","onExit","_useReducer","useReducer","_useReducer2","dispatchToReducer","ErrorBoundaryDialog","hasError","info","this","setState","componentStack","props","Component","DemoSite","annotatorOpen","changeAnnotatorOpen","annotatorProps","changeAnnotatorProps","changeLastOutput","ErrorBoundaryDialog_ErrorBoundaryDialog","output","DemoSite_Editor","RootContainer","ContentContainer","boxSizing","maxWidth","colors","Hero","HeroMain","HeroSub","lineHeight","HeroButtons","Section","CodeBlock","prism","docco","flatten","child","React","Children","HeadingRenderer","slug","level","LandingPage","LandingPage_Header","LandingPage_HeaderButton","href","react_github_btn","data-size","data-show-count","escapeHtml","renderers","heading","ReactDOM","render","path","location","pathname","src_LandingPage","getElementById"],"mappings":"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","file":"static/js/main.fb5e6a20.chunk.js","sourcesContent":["// @flow\n\nimport React from \"react\"\nimport {\n  ThemeProvider,\n  createMuiTheme,\n  makeStyles\n} from \"@material-ui/core/styles\"\n\nconst useStyles = makeStyles({\n  container: {\n    fontFamily: '\"Inter\", sans-serif'\n  }\n})\n\nconst theme = createMuiTheme({\n  typography: {\n    fontFamily: '\"Inter\", \"Roboto\", sans-serif'\n  },\n  overrides: {\n    MuiButton: {\n      root: {\n        textTransform: \"none\"\n      }\n    }\n  }\n})\n\nexport default ({ children }: any) => {\n  const classes = useStyles()\n  return (\n    <ThemeProvider theme={theme}>\n      <div className={classes.container}>{children}</div>\n    </ThemeProvider>\n  )\n}\n","// @flow\n\nimport React, { useState } from \"react\"\nimport Button from \"@material-ui/core/Button\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport Select from \"react-select\"\nimport Code from \"react-syntax-highlighter\"\nimport Dialog from \"@material-ui/core/Dialog\"\nimport DialogTitle from \"@material-ui/core/DialogTitle\"\nimport DialogContent from \"@material-ui/core/DialogContent\"\nimport DialogActions from \"@material-ui/core/DialogActions\"\nimport MonacoEditor from \"react-monaco-editor\"\n\nconst useStyles = makeStyles({\n  editBar: {\n    padding: 10,\n    borderBottom: \"1px solid #ccc\",\n    backgroundColor: \"#f8f8f8\",\n    display: \"flex\",\n    alignItems: \"center\",\n    \"& .button\": { margin: 5 }\n  },\n  select: { width: 240, fontSize: 14 },\n  contentArea: {\n    padding: 10\n  },\n  specificationArea: {\n    padding: 10\n  }\n})\n\nconst loadSavedInput = () => {\n  try {\n    return JSON.parse(window.localStorage.getItem(\"customInput\") || \"{}\")\n  } catch (e) {\n    return {}\n  }\n}\n\nexport const examples = {\n  \"Simple Bounding Box\": () => ({\n    taskDescription:\n      \"Annotate each image according to this _markdown_ specification.\",\n    // regionTagList: [],\n    // regionClsList: [\"hotdog\"],\n    regionTagList: [\"has-bun\"],\n    regionClsList: [\"hotdog\", \"not-hotdog\"],\n    enabledTools: [\"select\", \"create-box\"],\n    // showTags: true,\n    images: [\n      {\n        src:\n          \"https://images.unsplash.com/photo-1496905583330-eb54c7e5915a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=634&q=80\",\n        name: \"hot-dogs-1\"\n      }\n    ]\n  }),\n  \"Simple Segmentation\": () => ({\n    taskDescription:\n      \"Annotate each image according to this _markdown_ specification.\",\n    regionClsList: [\"car\", \"truck\"],\n    enabledTools: [\"select\", \"create-polygon\"],\n    images: [\n      {\n        src:\n          \"https://images.unsplash.com/photo-1561518776-e76a5e48f731?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=750&q=80\",\n        name: \"car-image-1\"\n      }\n    ]\n  }),\n  Custom: () => loadSavedInput()\n}\n\nconst Editor = ({ onOpenAnnotator, lastOutput }: any) => {\n  const c = useStyles()\n  const [currentError, changeCurrentError] = useState()\n  const [selectedExample, changeSelectedExample] = useState(\n    window.localStorage.getItem(\"customInput\")\n      ? \"Custom\"\n      : \"Simple Bounding Box\"\n  )\n  const [outputDialogOpen, changeOutputOpen] = useState(false)\n  const [currentJSONValue, changeCurrentJSONValue] = useState(\n    JSON.stringify(examples[selectedExample](), null, \"  \")\n  )\n  return (\n    <div>\n      <div className={c.editBar}>\n        <h3>React Image Annotate</h3>\n        <div style={{ flexGrow: 1 }} />\n        <div>\n          <div style={{ display: \"inline-flex\" }}>\n            <Select\n              className={c.select}\n              value={{ label: selectedExample, value: selectedExample }}\n              options={Object.keys(examples).map(s => ({\n                label: s,\n                value: s\n              }))}\n              onChange={selectedOption => {\n                changeSelectedExample(selectedOption.value)\n\n                changeCurrentJSONValue(\n                  JSON.stringify(\n                    selectedOption.value === \"Custom\"\n                      ? loadSavedInput()\n                      : examples[selectedOption.value](),\n                    null,\n                    \"  \"\n                  )\n                )\n              }}\n            />\n          </div>\n          <Button\n            className=\"button\"\n            disabled={!lastOutput}\n            onClick={() => changeOutputOpen(true)}\n          >\n            View Output\n          </Button>\n          <Button\n            className=\"button\"\n            variant=\"outlined\"\n            disabled={Boolean(currentError)}\n            onClick={() =>\n              onOpenAnnotator(\n                selectedExample === \"Custom\"\n                  ? loadSavedInput()\n                  : examples[selectedExample]\n              )\n            }\n          >\n            Open Annotator\n          </Button>\n        </div>\n      </div>\n      <div\n        className={c.contentArea}\n        style={\n          currentError\n            ? { border: \"2px solid #f00\" }\n            : { border: \"2px solid #fff\" }\n        }\n      >\n        <div>\n          <MonacoEditor\n            value={currentJSONValue}\n            language=\"javascript\"\n            onChange={code => {\n              try {\n                window.localStorage.setItem(\n                  \"customInput\",\n                  JSON.stringify(JSON.parse(code))\n                )\n                changeCurrentError(null)\n              } catch (e) {\n                changeCurrentError(e.toString())\n              }\n              changeCurrentJSONValue(code)\n            }}\n            width=\"100%\"\n            height=\"550px\"\n          />\n        </div>\n      </div>\n      <div className={c.specificationArea}>\n        <h2>React Image Annotate Format</h2>\n        <Code language=\"javascript\">{`\n{\n  taskDescription?: string, // markdown\n  regionTagList?: Array<string>,\n  regionClsList?: Array<string>,\n  imageTagList?: Array<string>,\n  imageClsList?: Array<string>,\n  // all tools are enabled by default\n  enabledTools?: Array< \"select\" | \"create-point\" | \"create-box\" | \"create-polygon\">,\n  selectedImage?: string, // initial selected image\n  images: Array<{\n    src: string,\n    thumbnailSrc?: string, // use this if you are using high-res images\n    name: string,\n    regions?: Array<{\n      id: string | number,\n      cls?: string,\n      color?: string,\n      tags?: Array<string>,\n\n      // Point\n      type: \"point\",\n      x: number, // [0-1] % of image width\n      y: number, // [0-1] % of image height\n\n      // Bounding Box\n      type: \"box\",\n      x: number, // [0-1] % of image width\n      y: number, // [0-1] % of image height\n      w: number, // [0-1] % of image width\n      h: number, // [0-1] % of image height\n\n      // Polygon\n      type: \"polygon\",\n      open?: boolean, // should last and first points be connected, default: true\n      points: Array<[number, number]> // [0-1] % of image width/height\n    }>\n  }>,\n}\n`}</Code>\n      </div>\n      <Dialog fullScreen open={outputDialogOpen}>\n        <DialogTitle>React Image Annotate Output</DialogTitle>\n        <DialogContent style={{ minWidth: 400 }}>\n          <MonacoEditor\n            value={JSON.stringify(lastOutput, null, \"  \")}\n            language=\"javascript\"\n            width=\"100%\"\n            height=\"550px\"\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => changeOutputOpen(false)}>Close</Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  )\n}\n\nexport default Editor\n","// @flow\n\nimport React, { useState } from \"react\"\nimport Paper from \"@material-ui/core/Paper\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport ExpandIcon from \"@material-ui/icons/ExpandMore\"\nimport IconButton from \"@material-ui/core/IconButton\"\nimport Collapse from \"@material-ui/core/Collapse\"\nimport { grey } from \"@material-ui/core/colors\"\nimport classnames from \"classnames\"\n\nconst useStyles = makeStyles({\n  container: { margin: 8 },\n  header: {\n    display: \"flex\",\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: 8,\n    paddingLeft: 16,\n    paddingRight: 16\n  },\n  title: {\n    fontSize: 14,\n    fontWeight: \"bold\",\n    flexGrow: 1,\n    paddingLeft: 8,\n    color: grey[800],\n    \"& span\": {\n      color: grey[600],\n      fontSize: 12\n    }\n  },\n  expandButton: {\n    padding: 0,\n    width: 30,\n    height: 30,\n    \"& .icon\": {\n      marginTop: -6,\n      width: 20,\n      height: 20,\n      transition: \"500ms transform\",\n      \"&.expanded\": {\n        transform: \"rotate(180deg)\"\n      }\n    }\n  },\n  expandedContent: {\n    maxHeight: 300,\n    overflowY: \"auto\",\n    \"&.noScroll\": {\n      overflowY: \"visible\",\n      overflow: \"visible\"\n    }\n  }\n})\n\nexport default ({\n  icon,\n  title,\n  subTitle,\n  children,\n  noScroll = false,\n  expandedByDefault = false\n}) => {\n  const classes = useStyles()\n  const content = (\n    <div\n      className={classnames(classes.expandedContent, noScroll && \"noScroll\")}\n    >\n      {children}\n    </div>\n  )\n\n  const [expanded, changeExpanded] = useState(expandedByDefault)\n  return (\n    <Paper className={classes.container}>\n      <div className={classes.header}>\n        {icon}\n        <div className={classes.title}>\n          {title} <span>{subTitle}</span>\n        </div>\n        <IconButton\n          onClick={() => changeExpanded(!expanded)}\n          className={classes.expandButton}\n        >\n          <ExpandIcon className={classnames(\"icon\", expanded && \"expanded\")} />\n        </IconButton>\n      </div>\n      {noScroll ? (\n        expanded ? (\n          content\n        ) : null\n      ) : (\n        <Collapse in={expanded}>{content}</Collapse>\n      )}\n    </Paper>\n  )\n}\n","// @flow\n\nimport React from \"react\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport DescriptionIcon from \"@material-ui/icons/Description\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport { grey } from \"@material-ui/core/colors\"\nimport Markdown from \"react-markdown\"\n\nconst useStyles = makeStyles({\n  markdownContainer: {\n    paddingLeft: 16,\n    paddingRight: 16,\n    fontSize: 12,\n    \"& h1\": { fontSize: 18 },\n    \"& h2\": { fontSize: 14 },\n    \"& h3\": { fontSize: 12 },\n    \"& h4\": { fontSize: 12 },\n    \"& h5\": { fontSize: 12 },\n    \"& h6\": { fontSize: 12 },\n    \"& p\": { fontSize: 12 },\n    \"& a\": {},\n    \"& img\": { width: \"100%\" }\n  }\n})\n\nexport default ({ description }) => {\n  const classes = useStyles()\n\n  return (\n    <SidebarBoxContainer\n      title=\"Task Description\"\n      icon={<DescriptionIcon style={{ color: grey[700] }} />}\n      expandedByDefault\n    >\n      <div className={classes.markdownContainer}>\n        <Markdown source={description} />\n      </div>\n    </SidebarBoxContainer>\n  )\n}\n","// @flow\n\nimport React from \"react\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport CollectionsIcon from \"@material-ui/icons/Collections\"\nimport { grey } from \"@material-ui/core/colors\"\nimport List from \"@material-ui/core/List\"\nimport ListItem from \"@material-ui/core/ListItem\"\nimport ListItemText from \"@material-ui/core/ListItemText\"\nimport Avatar from \"@material-ui/core/Avatar\"\n\nconst useStyles = makeStyles({\n  img: { width: 40, height: 40, borderRadius: 8 }\n})\n\nexport default ({ images, onSelect }) => {\n  const classes = useStyles()\n  return (\n    <SidebarBoxContainer\n      title=\"Images\"\n      subTitle={`(${images.length})`}\n      icon={<CollectionsIcon style={{ color: grey[700] }} />}\n    >\n      <div>\n        <List>\n          {images.map((img, i) => (\n            <ListItem button onClick={() => onSelect(img)} dense key={i}>\n              <img className={classes.img} src={img.src} />\n              <ListItemText\n                primary={img.name}\n                secondary={`${(img.regions || []).length} Labels`}\n              />\n            </ListItem>\n          ))}\n        </List>\n      </div>\n    </SidebarBoxContainer>\n  )\n}\n","import { grey, blue, orange, purple } from \"@material-ui/core/colors\"\n\nexport default {\n  container: {\n    fontSize: 11,\n    fontWeight: \"bold\",\n    color: grey[700],\n    \"& .icon\": {\n      marginTop: 4,\n      width: 16,\n      height: 16\n    },\n    \"& .icon2\": {\n      opacity: 0.5,\n      width: 16,\n      height: 16,\n      transition: \"200ms opacity\",\n      \"&:hover\": {\n        cursor: \"pointer\",\n        opacity: 1\n      }\n    }\n  },\n  row: {\n    padding: 4,\n    cursor: \"pointer\",\n    \"&.header:hover\": {\n      backgroundColor: \"#fff\"\n    },\n    \"&.highlighted\": {\n      backgroundColor: blue[100]\n    },\n    \"&:hover\": {\n      backgroundColor: blue[50],\n      color: grey[800]\n    }\n  },\n  chip: {\n    display: \"flex\",\n    flexDirection: \"row\",\n    padding: 2,\n    borderRadius: 2,\n    paddingLeft: 4,\n    paddingRight: 4,\n    alignItems: \"center\",\n    \"& .color\": {\n      borderRadius: 5,\n      width: 10,\n      height: 10,\n      marginRight: 4\n    },\n    \"& .text\": {}\n  }\n}\n","// @flow\n\nimport React, { Fragment, useState } from \"react\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport { grey } from \"@material-ui/core/colors\"\nimport RegionIcon from \"@material-ui/icons/PictureInPicture\"\nimport Grid from \"@material-ui/core/Grid\"\nimport ReorderIcon from \"@material-ui/icons/SwapVert\"\nimport PieChartIcon from \"@material-ui/icons/PieChart\"\nimport TrashIcon from \"@material-ui/icons/Delete\"\nimport LockIcon from \"@material-ui/icons/Lock\"\nimport UnlockIcon from \"@material-ui/icons/LockOpen\"\nimport VisibleIcon from \"@material-ui/icons/Visibility\"\nimport VisibleOffIcon from \"@material-ui/icons/VisibilityOff\"\nimport styles from \"./styles\"\nimport classnames from \"classnames\"\n\nconst useStyles = makeStyles(styles)\n\nconst Chip = ({ color, text }) => {\n  const classes = useStyles()\n  return (\n    <span className={classes.chip}>\n      <div className=\"color\" style={{ backgroundColor: color }} />\n      <div className=\"text\">{text}</div>\n    </span>\n  )\n}\n\nconst Row = ({\n  header,\n  highlighted,\n  order,\n  classification,\n  area,\n  tags,\n  trash,\n  lock,\n  visible,\n  onClick\n}) => {\n  const classes = useStyles()\n  const [mouseOver, changeMouseOver] = useState(false)\n  return (\n    <div\n      onClick={onClick}\n      onMouseEnter={() => changeMouseOver(true)}\n      onMouseLeave={() => changeMouseOver(false)}\n      className={classnames(classes.row, { header, highlighted })}\n    >\n      <Grid container alignItems=\"center\">\n        <Grid item xs={2}>\n          <div style={{ textAlign: \"right\", paddingRight: 10 }}>{order}</div>\n        </Grid>\n        <Grid item xs={5}>\n          {classification}\n        </Grid>\n        <Grid item xs={2}>\n          <div style={{ textAlign: \"right\", paddingRight: 6 }}>{area}</div>\n        </Grid>\n        <Grid item xs={1}>\n          {trash}\n        </Grid>\n        <Grid item xs={1}>\n          {lock}\n        </Grid>\n        <Grid item xs={1}>\n          {visible}\n        </Grid>\n      </Grid>\n    </div>\n  )\n}\n\nexport default ({\n  regions,\n  onDeleteRegion,\n  onChangeRegion,\n  onSelectRegion\n}) => {\n  const classes = useStyles()\n  return (\n    <SidebarBoxContainer\n      title=\"Regions\"\n      subTitle=\"\"\n      icon={<RegionIcon style={{ color: grey[700] }} />}\n      expandedByDefault\n    >\n      <div className={classes.container}>\n        <Row\n          header\n          highlighted={false}\n          order={<ReorderIcon className=\"icon\" />}\n          classification={<div style={{ paddingLeft: 10 }}>Class</div>}\n          area={<PieChartIcon className=\"icon\" />}\n          trash={<TrashIcon className=\"icon\" />}\n          lock={<LockIcon className=\"icon\" />}\n          visible={<VisibleIcon className=\"icon\" />}\n        />\n        <div\n          style={{\n            borderTop: `1px solid ${grey[200]}`,\n            marginTop: 2,\n            marginBottom: 2\n          }}\n        />\n        {regions.map((r, i) => (\n          <Row\n            header={false}\n            highlighted={r.highlighted}\n            onClick={() => onSelectRegion(r)}\n            key={r.id}\n            order={`#${i + 1}`}\n            classification={\n              <Chip text={r.cls || \"\"} color={r.color || \"#ddd\"} />\n            }\n            area=\"\"\n            trash={\n              <TrashIcon onClick={() => onDeleteRegion(r)} className=\"icon2\" />\n            }\n            lock={\n              r.locked ? (\n                <LockIcon\n                  onClick={() => onChangeRegion({ ...r, locked: false })}\n                  className=\"icon2\"\n                />\n              ) : (\n                <UnlockIcon\n                  onClick={() => onChangeRegion({ ...r, locked: true })}\n                  className=\"icon2\"\n                />\n              )\n            }\n            visible={\n              r.visible || r.visible === undefined ? (\n                <VisibleIcon\n                  onClick={() => onChangeRegion({ ...r, visible: false })}\n                  className=\"icon2\"\n                />\n              ) : (\n                <VisibleOffIcon\n                  onClick={() => onChangeRegion({ ...r, visible: true })}\n                  className=\"icon2\"\n                />\n              )\n            }\n          />\n        ))}\n      </div>\n    </SidebarBoxContainer>\n  )\n}\n","// @flow\n\nimport React, { setState } from \"react\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport HistoryIcon from \"@material-ui/icons/History\"\nimport List from \"@material-ui/core/List\"\nimport ListItem from \"@material-ui/core/ListItem\"\nimport ListItemText from \"@material-ui/core/ListItemText\"\nimport IconButton from \"@material-ui/core/IconButton\"\nimport ListItemSecondaryAction from \"@material-ui/core/ListItemSecondaryAction\"\nimport UndoIcon from \"@material-ui/icons/Undo\"\nimport moment from \"moment\"\nimport { grey } from \"@material-ui/core/colors\"\n\nconst useStyles = makeStyles({\n  emptyText: {\n    fontSize: 14,\n    fontWeight: \"bold\",\n    color: grey[500],\n    textAlign: \"center\",\n    padding: 20\n  }\n})\n\nexport default ({\n  history,\n  onRestoreHistory\n}: {\n  history: Array<{ name: string, time: Date }>\n}) => {\n  const classes = useStyles()\n\n  return (\n    <SidebarBoxContainer\n      title=\"History\"\n      icon={<HistoryIcon style={{ color: grey[700] }} />}\n      expandedByDefault\n    >\n      <List>\n        {history.length === 0 && (\n          <div className={classes.emptyText}>No History Yet</div>\n        )}\n        {history.map(({ name, time }, i) => (\n          <ListItem button dense key={i}>\n            <ListItemText\n              primary={name}\n              secondary={moment(time).format(\"LT\")}\n            />\n            {i === 0 && (\n              <ListItemSecondaryAction onClick={onRestoreHistory}>\n                <IconButton>\n                  <UndoIcon />\n                </IconButton>\n              </ListItemSecondaryAction>\n            )}\n          </ListItem>\n        ))}\n      </List>\n    </SidebarBoxContainer>\n  )\n}\n","// @flow\n\nimport React from \"react\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\n\nexport default ({ state, lastAction }: any) => {\n  const image = (state.images || []).find(\n    img => img.src === state.selectedImage\n  )\n  const region = image ? (image.regions || []).find(r => r.highlighted) : null\n\n  return (\n    <SidebarBoxContainer title=\"Debug\" icon={<span />} expandedByDefault>\n      <div style={{ padding: 4 }}>\n        <div>\n          <b>region</b>:\n        </div>\n        <pre>{JSON.stringify(region, null, \"  \")}</pre>\n        <div>\n          <b>lastAction</b>:\n        </div>\n        <pre>{JSON.stringify(lastAction, null, \"  \")}</pre>\n        <div>\n          <b>mode</b>:\n        </div>\n        <pre>{JSON.stringify(state.mode, null, \"  \")}</pre>\n      </div>\n    </SidebarBoxContainer>\n  )\n}\n","// @flow\n\nimport React from \"react\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport StyleIcon from \"@material-ui/icons/Style\"\nimport { grey } from \"@material-ui/core/colors\"\nimport Select from \"react-select\"\n\nconst useStyles = makeStyles({})\n\ntype Props = {\n  tags: Array<string>,\n  currentImage: { cls?: string, tags?: Array<string> },\n  imageClsList?: Array<string>,\n  imageTagList?: Array<string>,\n  onChangeImage: (Array<string>) => any\n}\n\nexport default ({\n  currentImage,\n  imageClsList = [],\n  imageTagList = [],\n  onChangeImage\n}: Props) => {\n  const { tags = [], cls = null } = currentImage\n  return (\n    <SidebarBoxContainer\n      title=\"Image Tags\"\n      expandedByDefault\n      noScroll\n      icon={<StyleIcon style={{ color: grey[700] }} />}\n    >\n      {imageClsList.length > 0 && (\n        <div style={{ padding: 8 }}>\n          <Select\n            placeholder=\"Image Classification\"\n            onChange={o => onChangeImage({ cls: o.value })}\n            value={cls ? { value: cls, label: cls } : cls}\n            options={imageClsList.map(c => ({ value: c, label: c }))}\n          />\n        </div>\n      )}\n      {imageTagList.length > 0 && (\n        <div style={{ padding: 8, paddingTop: 0 }}>\n          <Select\n            isMulti\n            placeholder=\"Image Tags\"\n            onChange={o => onChangeImage({ tags: o.map(a => a.value) })}\n            value={tags.map(r => ({ value: r, label: r }))}\n            options={imageTagList.map(c => ({ value: c, label: c }))}\n          />\n        </div>\n      )}\n    </SidebarBoxContainer>\n  )\n}\n","// @flow\n\nimport React from \"react\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport TaskDescription from \"../TaskDescriptionSidebarBox\"\nimport ImageSelector from \"../ImageSelectorSidebarBox\"\nimport RegionSelector from \"../RegionSelectorSidebarBox\"\nimport History from \"../HistorySidebarBox\"\nimport DebugBox from \"../DebugSidebarBox\"\nimport TagsSidebarBox from \"../TagsSidebarBox\"\nimport type { Region } from \"../ImageCanvas/region-tools.js\"\n\nconst useStyles = makeStyles({})\n\ntype Image = {\n  name: string,\n  src: string,\n  cls?: string,\n  tags?: Array<string>,\n  thumbnailSrc?: string,\n  regions?: Array<Region>\n}\n\ntype Props = {\n  debug: any,\n  taskDescription: string,\n  images: Array<Image>,\n  regions: Array<Region>,\n  history: Array<{ state: Object, name: string, time: Date }>,\n\n  labelImages?: boolean,\n  currentImage?: Image,\n  imageClsList?: Array<string>,\n  imageTagList?: Array<string>,\n\n  onChangeImage: Image => any,\n  onSelectRegion: Region => any,\n  onSelectImage: Image => any,\n  onChangeRegion: Region => any,\n  onDeleteRegion: Region => any,\n  onRestoreHistory: () => any\n}\n\nexport default ({\n  debug,\n  taskDescription,\n  images,\n  regions,\n  history,\n  labelImages,\n  currentImage,\n  imageClsList,\n  imageTagList,\n  onChangeImage,\n  onSelectRegion,\n  onSelectImage,\n  onChangeRegion,\n  onDeleteRegion,\n  onRestoreHistory\n}: Props) => {\n  const classes = useStyles()\n\n  return (\n    <div>\n      {debug && <DebugBox state={debug} lastAction={debug.lastAction} />}\n      <TaskDescription description={taskDescription} />\n      {labelImages && (\n        <TagsSidebarBox\n          currentImage={currentImage}\n          imageClsList={imageClsList}\n          imageTagList={imageTagList}\n          onChangeImage={onChangeImage}\n          expandedByDefault\n        />\n      )}\n      <ImageSelector onSelect={onSelectImage} images={images} />\n      <RegionSelector\n        regions={regions}\n        onSelectRegion={onSelectRegion}\n        onChangeRegion={onChangeRegion}\n        onDeleteRegion={onDeleteRegion}\n      />\n      <History history={history} onRestoreHistory={() => onRestoreHistory()} />\n    </div>\n  )\n}\n","// @flow\n\nimport React, { Fragment, useEffect, useState } from \"react\"\n\nexport default ({\n  mousePosition,\n  x,\n  y\n}: {\n  mousePosition: { current: { x: number, y: number } },\n  x?: number,\n  y?: number\n}) => {\n  const [forceRenderState, changeForceRenderState] = useState()\n\n  if (mousePosition) {\n    x = mousePosition.current.x\n    y = mousePosition.current.y\n  }\n\n  useEffect(() => {\n    if (!mousePosition) return\n    const interval = setInterval(() => {\n      if (x !== mousePosition.current.x || y !== mousePosition.current.y) {\n        changeForceRenderState([\n          mousePosition.current.x,\n          mousePosition.current.y\n        ])\n      }\n    }, 10)\n    return () => clearInterval(interval)\n  })\n\n  return (\n    <Fragment>\n      <div\n        style={{\n          position: \"absolute\",\n          height: \"100%\",\n          width: 1,\n          backgroundColor: \"#f00\",\n          left: x,\n          pointerEvents: \"none\",\n          top: 0\n        }}\n      />\n      <div\n        style={{\n          position: \"absolute\",\n          width: \"100%\",\n          height: 1,\n          backgroundColor: \"#f00\",\n          top: y,\n          pointerEvents: \"none\",\n          left: 0\n        }}\n      />\n    </Fragment>\n  )\n}\n","// @flow\n\nimport { grey } from \"@material-ui/core/colors\"\n\nexport default {\n  regionInfo: {\n    fontSize: 12,\n    cursor: \"default\",\n    transition: \"opacity 200ms\",\n    opacity: 0.7,\n    \"&:hover\": {\n      opacity: 0.9,\n      cursor: \"pointer\"\n    },\n    \"&.highlighted\": {\n      opacity: 0.9,\n      \"&:hover\": {\n        opacity: 1\n      }\n    },\n    // pointerEvents: \"none\",\n    fontWeight: 600,\n    color: grey[900],\n    padding: 8,\n    \"& .name\": {\n      display: \"flex\",\n      flexDirection: \"row\",\n      alignItems: \"center\",\n      \"& .circle\": {\n        marginRight: 4,\n        boxShadow: \"0px 0px 2px rgba(0,0,0,0.4)\",\n        width: 10,\n        height: 10,\n        borderRadius: 5\n      }\n    },\n    \"& .tags\": {\n      \"& .tag\": {\n        color: grey[700],\n        display: \"inline-block\",\n        margin: 1,\n        fontSize: 10,\n        textDecoration: \"underline\"\n      }\n    }\n  }\n}\n","// @flow\n\nimport React, { useState } from \"react\"\nimport Paper from \"@material-ui/core/Paper\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport styles from \"./styles\"\nimport classnames from \"classnames\"\nimport type { Region } from \"../ImageCanvas/region-tools.js\"\nimport IconButton from \"@material-ui/core/IconButton\"\nimport Button from \"@material-ui/core/Button\"\nimport TrashIcon from \"@material-ui/icons/Delete\"\nimport CheckIcon from \"@material-ui/icons/Check\"\nimport UndoIcon from \"@material-ui/icons/Undo\"\nimport Select from \"react-select\"\n\nconst useStyles = makeStyles(styles)\n\ntype Props = {\n  region: Region,\n  editing?: boolean,\n  allowedClasses?: Array<string>,\n  allowedTags?: Array<string>,\n  cls?: string,\n  tags?: Array<string>,\n  onDelete: Region => null,\n  onChange: Region => null,\n  onClose: Region => null,\n  onOpen: Region => null\n}\n\nexport default ({\n  region,\n  editing,\n  allowedClasses = [\"Laptop\", \"Mouse\", \"Compuda\"],\n  allowedTags = [\"Dog\", \"Cat\", \"Woof\", \"Electronic Device\"],\n  onDelete,\n  onChange,\n  onClose,\n  onOpen\n}: Props) => {\n  const classes = useStyles()\n\n  return (\n    <Paper\n      onClick={() => (!editing ? onOpen(region) : null)}\n      className={classnames(classes.regionInfo, {\n        highlighted: region.highlighted\n      })}\n    >\n      {!editing ? (\n        <div>\n          {region.cls && (\n            <div className=\"name\">\n              <div\n                className=\"circle\"\n                style={{ backgroundColor: region.color }}\n              />\n              {region.cls}\n            </div>\n          )}\n          {region.tags && (\n            <div className=\"tags\">\n              {region.tags.map(t => (\n                <div key={t} className=\"tag\">\n                  {t}\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      ) : (\n        <div style={{ width: 200 }}>\n          <div style={{ display: \"flex\", flexDirection: \"row\" }}>\n            <div\n              style={{\n                display: \"flex\",\n                backgroundColor: region.color,\n                color: \"#fff\",\n                padding: 4,\n                paddingLeft: 8,\n                paddingRight: 8,\n                borderRadius: 4,\n                fontWeight: \"bold\",\n                textShadow: \"0px 0px 5px rgba(0,0,0,0.4)\"\n              }}\n            >\n              {region.type}\n            </div>\n            <div style={{ flexGrow: 1 }} />\n            <IconButton\n              onClick={() => onDelete(region)}\n              tabIndex={-1}\n              style={{ width: 22, height: 22 }}\n              size=\"small\"\n              variant=\"outlined\"\n            >\n              <TrashIcon style={{ marginTop: -8, width: 16, height: 16 }} />\n            </IconButton>\n          </div>\n          {allowedClasses.length > 0 && (\n            <div style={{ marginTop: 6 }}>\n              <Select\n                placeholder=\"Classification\"\n                onChange={o =>\n                  onChange({\n                    ...(region: any),\n                    cls: o.value\n                  })\n                }\n                value={\n                  region.cls ? { label: region.cls, value: region.cls } : null\n                }\n                options={allowedClasses.map(c => ({ value: c, label: c }))}\n              />\n            </div>\n          )}\n          {allowedTags.length > 0 && (\n            <div style={{ marginTop: 4 }}>\n              <Select\n                onChange={newTags =>\n                  onChange({\n                    ...(region: any),\n                    tags: newTags.map(t => t.value)\n                  })\n                }\n                placeholder=\"Tags\"\n                value={(region.tags || []).map(c => ({ label: c, value: c }))}\n                isMulti\n                options={allowedTags.map(c => ({ value: c, label: c }))}\n              />\n            </div>\n          )}\n          <div style={{ marginTop: 4, display: \"flex\" }}>\n            <div style={{ flexGrow: 1 }} />\n            <Button\n              onClick={() => onClose(region)}\n              size=\"small\"\n              variant=\"contained\"\n              color=\"primary\"\n            >\n              <CheckIcon />\n            </Button>\n          </div>\n        </div>\n      )}\n    </Paper>\n  )\n}\n","// @flow\n\nimport React from \"react\"\nimport classnames from \"classnames\"\nimport { makeStyles } from \"@material-ui/core/styles\"\n\nconst useStyles = makeStyles({\n  \"@keyframes borderDance\": {\n    from: { strokeDashoffset: 0 },\n    to: { strokeDashoffset: 100 }\n  },\n  highlightBox: {\n    transition: \"opacity 500ms\",\n    \"&:not(.highlighted)\": {\n      opacity: 0\n    },\n    \"&:not(.highlighted):hover\": {\n      opacity: 0.6\n    },\n    \"& path\": {\n      vectorEffect: \"non-scaling-stroke\",\n      strokeWidth: 2,\n      stroke: \"#FFF\",\n      fill: \"none\",\n      strokeDasharray: 5,\n      animationName: \"$borderDance\",\n      animationDuration: \"4s\",\n      animationTimingFunction: \"linear\",\n      animationIterationCount: \"infinite\",\n      animationPlayState: \"running\"\n    }\n  }\n})\n\nexport default ({\n  mouseEvents,\n  dragWithPrimary,\n  zoomWithPrimary,\n  createWithPrimary,\n  onBeginMovePoint,\n  onSelectRegion,\n  region: r,\n  pbox\n}: {\n  mouseEvents: any,\n  dragWithPrimary: boolean,\n  zoomWithPrimary: boolean,\n  createWithPrimary: boolean,\n  onBeginMovePoint: Function,\n  onSelectRegion: Function,\n  region: any,\n  pbox: { x: number, y: number, w: number, h: number }\n}) => {\n  const classes = useStyles()\n  return (\n    <svg\n      key={r.id}\n      className={classnames(classes.highlightBox, {\n        highlighted: r.highlighted\n      })}\n      {...mouseEvents}\n      {...(!zoomWithPrimary && !dragWithPrimary\n        ? {\n            onMouseDown: e => {\n              if (\n                !r.locked &&\n                r.type === \"point\" &&\n                r.highlighted &&\n                e.button === 0\n              ) {\n                return onBeginMovePoint(r)\n              }\n              if (e.button === 0 && !createWithPrimary) return onSelectRegion(r)\n              mouseEvents.onMouseDown(e)\n            }\n          }\n        : {})}\n      style={{\n        ...(r.highlighted\n          ? {\n              pointerEvents: r.type !== \"point\" ? \"none\" : undefined,\n              cursor: \"grab\"\n            }\n          : {\n              cursor: !(zoomWithPrimary || dragWithPrimary || createWithPrimary)\n                ? \"pointer\"\n                : undefined,\n              pointerEvents:\n                zoomWithPrimary ||\n                dragWithPrimary ||\n                (createWithPrimary && !r.highlighted)\n                  ? \"none\"\n                  : undefined\n            }),\n        position: \"absolute\",\n        left: pbox.x - 5,\n        top: pbox.y - 5,\n        width: pbox.w + 10,\n        height: pbox.h + 10\n      }}\n    >\n      <path\n        d={`M5,5 L${pbox.w + 5},5 L${pbox.w + 5},${pbox.h + 5} L5,${pbox.h +\n          5} Z`}\n      />\n    </svg>\n  )\n}\n","// @flow\n\nimport React, { useState } from \"react\"\nimport { RemoveScroll } from \"react-remove-scroll\"\nimport { styled } from \"@material-ui/core/styles\"\n\nconst Container = styled(\"div\")({\n  \"& > div\": {\n    width: \"100%\",\n    height: \"100%\"\n  }\n})\n\nexport default ({ children, ...otherProps }) => {\n  const [mouseOver, changeMouseOver] = useState(false)\n  return (\n    <Container\n      {...otherProps}\n      onMouseEnter={e => changeMouseOver(true)}\n      onMouseLeave={e => changeMouseOver(false)}\n    >\n      <RemoveScroll enabled={mouseOver} removeScrollBar={false}>\n        {children}\n      </RemoveScroll>\n    </Container>\n  )\n}\n","// @flow\nimport React, { Fragment, useRef, useState, useLayoutEffect } from \"react\"\nimport { Matrix } from \"transformation-matrix-js\"\nimport getImageData from \"get-image-data\"\nimport Crosshairs from \"../Crosshairs\"\nimport type {\n  Region,\n  PixelRegion,\n  Point,\n  Polygon,\n  Box\n} from \"./region-tools.js\"\nimport { getEnclosingBox } from \"./region-tools.js\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport styles from \"./styles\"\nimport classnames from \"classnames\"\nimport RegionLabel from \"../RegionLabel\"\nimport LockIcon from \"@material-ui/icons/Lock\"\nimport Paper from \"@material-ui/core/Paper\"\nimport HighlightBox from \"../HighlightBox\"\n// import excludePatternSrc from \"./xpattern.png\"\nimport excludePatternSrc from \"./xpattern.js\"\nimport PreventScrollToParents from \"../PreventScrollToParents\"\n\nconst useStyles = makeStyles(styles)\n\nconst boxCursorMap = [\n  [\"nw-resize\", \"n-resize\", \"ne-resize\"],\n  [\"w-resize\", \"grab\", \"e-resize\"],\n  [\"sw-resize\", \"s-resize\", \"se-resize\"]\n]\n\ntype Props = {\n  regions: Array<Region>,\n  imageSrc: string,\n  onMouseMove?: ({ x: number, y: number }) => any,\n  onMouseDown?: ({ x: number, y: number }) => any,\n  onMouseUp?: ({ x: number, y: number }) => any,\n  dragWithPrimary?: boolean,\n  zoomWithPrimary?: boolean,\n  createWithPrimary?: boolean,\n  showTags?: boolean,\n  realSize?: { width: number, height: number, unitName: string },\n  showCrosshairs?: boolean,\n  showPointDistances?: boolean,\n  pointDistancePrecision?: number,\n  regionClsList?: Array<string>,\n  regionTagList?: Array<string>,\n  allowedArea?: { x: number, y: number, w: number, h: number },\n\n  onChangeRegion: Region => any,\n  onBeginRegionEdit: Region => any,\n  onCloseRegionEdit: Region => any,\n  onDeleteRegion: Region => any,\n  onBeginBoxTransform: (Box, [number, number]) => any,\n  onBeginMovePolygonPoint: (Polygon, index: number) => any,\n  onAddPolygonPoint: (Polygon, point: [number, number], index: number) => any,\n  onSelectRegion: Region => any,\n  onBeginMovePoint: Point => any,\n  onImageLoaded: ({ width: number, height: number }) => any\n}\n\nconst getDefaultMat = () => Matrix.from(1, 0, 0, 1, -10, -10)\n\nexport default ({\n  regions,\n  imageSrc,\n  realSize,\n  showTags,\n  onMouseMove = p => null,\n  onMouseDown = p => null,\n  onMouseUp = p => null,\n  dragWithPrimary = false,\n  zoomWithPrimary = false,\n  createWithPrimary = false,\n  pointDistancePrecision = 0,\n  regionClsList,\n  regionTagList,\n  showCrosshairs,\n  showPointDistances,\n  allowedArea,\n\n  onImageLoaded,\n  onChangeRegion,\n  onBeginRegionEdit,\n  onCloseRegionEdit,\n  onBeginBoxTransform,\n  onBeginMovePolygonPoint,\n  onAddPolygonPoint,\n  onSelectRegion,\n  onBeginMovePoint,\n  onDeleteRegion\n}: Props) => {\n  const classes = useStyles()\n\n  const canvasEl = useRef(null)\n  const image = useRef(null)\n  const layoutParams = useRef({})\n  const excludePattern = useRef(null)\n  const [imageLoaded, changeImageLoaded] = useState(false)\n  const [dragging, changeDragging] = useState(false)\n  const [maskImagesLoaded, changeMaskImagesLoaded] = useState(0)\n  const [zoomStart, changeZoomStart] = useState(null)\n  const [zoomEnd, changeZoomEnd] = useState(null)\n  const mousePosition = useRef({ x: 0, y: 0 })\n  const prevMousePosition = useRef({ x: 0, y: 0 })\n  const [mat, changeMat] = useState(getDefaultMat())\n  const maskImages = useRef({})\n\n  const innerMousePos = mat.applyToPoint(\n    mousePosition.current.x,\n    mousePosition.current.y\n  )\n\n  const projectRegionBox = r => {\n    const { iw, ih } = layoutParams.current\n    const bbox = getEnclosingBox(r)\n    const margin = r.type === \"point\" ? 15 : 2\n    const cbox = {\n      x: bbox.x * iw - margin,\n      y: bbox.y * ih - margin,\n      w: bbox.w * iw + margin * 2,\n      h: bbox.h * ih + margin * 2\n    }\n    const pbox = {\n      ...mat\n        .clone()\n        .inverse()\n        .applyToPoint(cbox.x, cbox.y),\n      w: cbox.w / mat.a,\n      h: cbox.h / mat.d\n    }\n    return pbox\n  }\n\n  useLayoutEffect(() => {\n    if (image.current === null) {\n      image.current = new Image()\n      image.current.onload = () => {\n        changeImageLoaded(true)\n        onImageLoaded({\n          width: image.current.naturalWidth,\n          height: image.current.naturalHeight\n        })\n      }\n      image.current.src = imageSrc\n    }\n    const canvas = canvasEl.current\n    const { clientWidth, clientHeight } = canvas\n    canvas.width = clientWidth\n    canvas.height = clientHeight\n    const context = canvas.getContext(\"2d\")\n    if (excludePattern.current === null) {\n      excludePattern.current = {\n        image: new Image(),\n        pattern: null\n      }\n      excludePattern.current.image.onload = () => {\n        excludePattern.current.pattern = context.createPattern(\n          excludePattern.current.image,\n          \"repeat\"\n        )\n      }\n      excludePattern.current.image.src = excludePatternSrc\n    }\n    context.save()\n    context.transform(\n      ...mat\n        .clone()\n        .inverse()\n        .toArray()\n    )\n\n    const fitScale = Math.max(\n      image.current.naturalWidth / (clientWidth - 20),\n      image.current.naturalHeight / (clientHeight - 20)\n    )\n\n    const [iw, ih] = [\n      image.current.naturalWidth / fitScale,\n      image.current.naturalHeight / fitScale\n    ]\n\n    layoutParams.current = {\n      iw,\n      ih,\n      fitScale,\n      canvasWidth: clientWidth,\n      canvasHeight: clientHeight\n    }\n\n    context.drawImage(image.current, 0, 0, iw, ih)\n\n    if (allowedArea) {\n      // Pattern to indicate the NOT allowed areas\n      const { x, y, w, h } = allowedArea\n      context.save()\n      context.globalAlpha = 0.25\n      const outer = [[0, 0], [iw, 0], [iw, ih], [0, ih]]\n      const inner = [\n        [x * iw, y * ih],\n        [x * iw + w * iw, y * ih],\n        [x * iw + w * iw, y * ih + h * ih],\n        [x * iw, y * ih + h * ih]\n      ]\n      context.moveTo(...outer[0])\n      outer.forEach(p => context.lineTo(...p))\n      context.lineTo(...outer[0])\n      context.closePath()\n\n      inner.reverse()\n      context.moveTo(...inner[0])\n      inner.forEach(p => context.lineTo(...p))\n      context.lineTo(...inner[0])\n\n      context.fillStyle = excludePattern.current.pattern || \"#f00\"\n      context.fill()\n\n      context.restore()\n    }\n\n    context.save()\n    context.globalAlpha = mat.a * 0.5 + 0.5\n    context.lineWidth = mat.a * 1 + 1\n    if (context.globalAlpha > 0.6) {\n      context.shadowColor = \"black\"\n      context.shadowBlur = 4\n    }\n    for (const region of regions.filter(\n      r => r.visible || r.visible === undefined\n    )) {\n      switch (region.type) {\n        case \"point\": {\n          context.save()\n\n          context.beginPath()\n          context.strokeStyle = region.color\n          context.moveTo(region.x * iw - 10, region.y * ih)\n          context.lineTo(region.x * iw - 2, region.y * ih)\n          context.moveTo(region.x * iw + 10, region.y * ih)\n          context.lineTo(region.x * iw + 2, region.y * ih)\n          context.moveTo(region.x * iw, region.y * ih - 10)\n          context.lineTo(region.x * iw, region.y * ih - 2)\n          context.moveTo(region.x * iw, region.y * ih + 10)\n          context.lineTo(region.x * iw, region.y * ih + 2)\n          context.moveTo(region.x * iw + 5, region.y * ih)\n          context.arc(region.x * iw, region.y * ih, 5, 0, 2 * Math.PI)\n          context.stroke()\n          context.restore()\n          break\n        }\n        case \"box\": {\n          context.save()\n\n          context.shadowColor = \"black\"\n          context.shadowBlur = 4\n          context.strokeStyle = region.color\n          context.strokeRect(\n            region.x * iw,\n            region.y * ih,\n            region.w * iw,\n            region.h * ih\n          )\n\n          context.restore()\n          break\n        }\n        case \"polygon\": {\n          context.save()\n\n          context.shadowColor = \"black\"\n          context.shadowBlur = 4\n          context.strokeStyle = region.color\n\n          context.beginPath()\n          context.moveTo(region.points[0][0] * iw, region.points[0][1] * ih)\n          for (const point of region.points) {\n            context.lineTo(point[0] * iw, point[1] * ih)\n          }\n          if (!region.open) context.closePath()\n          context.stroke()\n          context.restore()\n          break\n        }\n        case \"pixel\": {\n          context.save()\n\n          if (maskImages.current[region.src]) {\n            if (maskImages.current[region.src].nodeName === \"CANVAS\") {\n              context.globalAlpha = 0.6\n              context.drawImage(\n                maskImages.current[region.src],\n                region.sx * iw,\n                region.sy * ih,\n                region.w * iw,\n                region.h * ih\n              )\n            }\n          } else {\n            maskImages.current[region.src] = new Image()\n            maskImages.current[region.src].onload = () => {\n              const img = maskImages.current[region.src]\n              const newCanvas = document.createElement(\"canvas\")\n              newCanvas.width = img.naturalWidth\n              newCanvas.height = img.naturalHeight\n              const ctx = newCanvas.getContext(\"2d\")\n              ctx.drawImage(img, 0, 0)\n              const imgData = ctx.getImageData(\n                0,\n                0,\n                img.naturalWidth,\n                img.naturalHeight\n              )\n              for (let i = 0; i < imgData.data.length; i += 4) {\n                const [r, g, b, a] = imgData.data.slice(i, i + 4)\n                const black = r < 10 && g < 10 && b < 10\n                imgData.data[i] = 0\n                imgData.data[i + 1] = 0\n                imgData.data[i + 2] = black ? 255 : 0\n                imgData.data[i + 3] = black ? 255 : 0\n              }\n              ctx.clearRect(0, 0, img.naturalWidth, img.naturalHeight)\n              ctx.putImageData(imgData, 0, 0)\n              maskImages.current[region.src] = newCanvas\n              changeMaskImagesLoaded(maskImagesLoaded + 1)\n            }\n            maskImages.current[region.src].src = region.src\n          }\n\n          context.restore()\n          break\n        }\n      }\n    }\n    context.restore()\n    context.restore()\n  })\n\n  const zoomIn = (direction, point) => {\n    const [mx, my] = [point.x, point.y]\n    let scale =\n      typeof direction === \"object\" ? direction.to / mat.a : 1 + 0.2 * direction\n\n    // NOTE: We're mutating mat here\n    mat.translate(mx, my).scaleU(scale)\n    if (mat.a > 2) mat.scaleU(2 / mat.a)\n    if (mat.a < 0.1) mat.scaleU(0.1 / mat.a)\n    mat.translate(-mx, -my)\n\n    changeMat(mat.clone())\n  }\n\n  const mouseEvents = {\n    onMouseMove: e => {\n      const { left, top } = canvasEl.current.getBoundingClientRect()\n      prevMousePosition.current.x = mousePosition.current.x\n      prevMousePosition.current.y = mousePosition.current.y\n      mousePosition.current.x = e.clientX - left\n      mousePosition.current.y = e.clientY - top\n\n      const projMouse = mat.applyToPoint(\n        mousePosition.current.x,\n        mousePosition.current.y\n      )\n\n      if (zoomWithPrimary && zoomStart) {\n        changeZoomEnd(projMouse)\n      }\n\n      const { iw, ih } = layoutParams.current\n      onMouseMove({ x: projMouse.x / iw, y: projMouse.y / ih })\n\n      if (dragging) {\n        mat.translate(\n          prevMousePosition.current.x - mousePosition.current.x,\n          prevMousePosition.current.y - mousePosition.current.y\n        )\n\n        changeMat(mat.clone())\n        // changeForceRenderState(Math.random())\n      }\n      e.preventDefault()\n    },\n    onMouseDown: (e, specialEvent = {}) => {\n      e.preventDefault()\n\n      if (e.button === 1 || (e.button === 0 && dragWithPrimary))\n        return changeDragging(true)\n      const projMouse = mat.applyToPoint(\n        mousePosition.current.x,\n        mousePosition.current.y\n      )\n      if (zoomWithPrimary && e.button === 0) {\n        changeZoomStart(projMouse)\n        changeZoomEnd(projMouse)\n        return\n      }\n      if (e.button === 0) {\n        if (specialEvent.type === \"resize-box\") {\n          // onResizeBox()\n        }\n        if (specialEvent.type === \"move-region\") {\n          // onResizeBox()\n        }\n        const { iw, ih } = layoutParams.current\n        onMouseDown({ x: projMouse.x / iw, y: projMouse.y / ih })\n      }\n    },\n    onMouseUp: e => {\n      e.preventDefault()\n      const projMouse = mat.applyToPoint(\n        mousePosition.current.x,\n        mousePosition.current.y\n      )\n      if (zoomStart) {\n        const zoomEnd = projMouse\n        if (\n          Math.abs(zoomStart.x - zoomEnd.x) < 10 &&\n          Math.abs(zoomStart.y - zoomEnd.y) < 10\n        ) {\n          if (mat.a < 1) {\n            zoomIn({ to: 1 }, mousePosition.current)\n          } else {\n            zoomIn({ to: 0.25 }, mousePosition.current)\n          }\n        } else {\n          const { iw, ih } = layoutParams.current\n\n          if (zoomStart.x > zoomEnd.x) {\n            ;[zoomStart.x, zoomEnd.x] = [zoomEnd.x, zoomStart.x]\n          }\n          if (zoomStart.y > zoomEnd.y) {\n            ;[zoomStart.y, zoomEnd.y] = [zoomEnd.y, zoomStart.y]\n          }\n\n          // The region defined by zoomStart and zoomEnd should be the new transform\n          let scale = Math.min(\n            (zoomEnd.x - zoomStart.x) / iw,\n            (zoomEnd.y - zoomStart.y) / ih\n          )\n          if (scale < 0.1) scale = 0.1\n          if (scale > 10) scale = 10\n\n          const newMat = getDefaultMat()\n            .translate(zoomStart.x, zoomStart.y)\n            .scaleU(scale)\n\n          changeMat(newMat.clone())\n        }\n\n        changeZoomStart(null)\n        changeZoomEnd(null)\n      }\n      if (e.button === 1 || (e.button === 0 && dragWithPrimary))\n        return changeDragging(false)\n      if (e.button === 0) {\n        const { iw, ih } = layoutParams.current\n        onMouseUp({ x: projMouse.x / iw, y: projMouse.y / ih })\n      }\n    },\n    onWheel: e => {\n      const direction = e.deltaY > 0 ? 1 : e.deltaY < 0 ? -1 : 0\n      zoomIn(direction, mousePosition.current)\n      e.preventDefault()\n    }\n  }\n\n  const { iw, ih } = layoutParams.current\n\n  let zoomBox = !zoomStart\n    ? null\n    : {\n        ...mat\n          .clone()\n          .inverse()\n          .applyToPoint(zoomStart.x, zoomStart.y),\n        w: (zoomEnd.x - zoomStart.x) / mat.a,\n        h: (zoomEnd.y - zoomStart.y) / mat.d\n      }\n  if (zoomBox) {\n    if (zoomBox.w < 0) {\n      zoomBox.x += zoomBox.w\n      zoomBox.w *= -1\n    }\n    if (zoomBox.h < 0) {\n      zoomBox.y += zoomBox.h\n      zoomBox.h *= -1\n    }\n  }\n\n  return (\n    <div\n      style={{\n        width: \"100%\",\n        height: \"100%\",\n        maxHeight: \"calc(100vh - 68px)\",\n        position: \"relative\",\n        overflow: \"hidden\",\n        cursor: createWithPrimary\n          ? \"crosshair\"\n          : dragging\n          ? \"grabbing\"\n          : dragWithPrimary\n          ? \"grab\"\n          : zoomWithPrimary\n          ? mat.a < 1\n            ? \"zoom-out\"\n            : \"zoom-in\"\n          : undefined\n      }}\n    >\n      {showCrosshairs && <Crosshairs mousePosition={mousePosition} />}\n      {regions\n        .filter(r => r.visible || r.visible === undefined)\n        .filter(r => !r.locked)\n        .map((r, i) => {\n          const pbox = projectRegionBox(r)\n          const { iw, ih } = layoutParams.current\n          return (\n            <Fragment>\n              <PreventScrollToParents>\n                <HighlightBox\n                  region={r}\n                  mouseEvents={mouseEvents}\n                  dragWithPrimary={dragWithPrimary}\n                  createWithPrimary={createWithPrimary}\n                  zoomWithPrimary={zoomWithPrimary}\n                  onBeginMovePoint={onBeginMovePoint}\n                  onSelectRegion={onSelectRegion}\n                  pbox={pbox}\n                />\n                {r.type === \"box\" &&\n                  !dragWithPrimary &&\n                  !zoomWithPrimary &&\n                  !r.locked &&\n                  r.highlighted &&\n                  mat.a < 1.2 &&\n                  [\n                    [0, 0],\n                    [0.5, 0],\n                    [1, 0],\n                    [1, 0.5],\n                    [1, 1],\n                    [0.5, 1],\n                    [0, 1],\n                    [0, 0.5],\n                    [0.5, 0.5]\n                  ].map(([px, py], i) => (\n                    <div\n                      key={i}\n                      className={classes.transformGrabber}\n                      {...mouseEvents}\n                      onMouseDown={e => {\n                        if (e.button === 0)\n                          return onBeginBoxTransform(r, [\n                            px * 2 - 1,\n                            py * 2 - 1\n                          ])\n                        mouseEvents.onMouseDown(e)\n                      }}\n                      style={{\n                        left: pbox.x - 4 - 2 + pbox.w * px,\n                        top: pbox.y - 4 - 2 + pbox.h * py,\n                        cursor: boxCursorMap[py * 2][px * 2],\n                        borderRadius: px === 0.5 && py === 0.5 ? 4 : undefined\n                      }}\n                    />\n                  ))}\n                {r.type === \"polygon\" &&\n                  !dragWithPrimary &&\n                  !zoomWithPrimary &&\n                  !r.locked &&\n                  r.highlighted &&\n                  r.points.map(([px, py], i) => {\n                    const proj = mat\n                      .clone()\n                      .inverse()\n                      .applyToPoint(px * iw, py * ih)\n                    return (\n                      <div\n                        key={i}\n                        {...mouseEvents}\n                        onMouseDown={e => {\n                          if (e.button === 0 && (!r.open || i === 0))\n                            return onBeginMovePolygonPoint(r, i)\n                          mouseEvents.onMouseDown(e)\n                        }}\n                        className={classes.transformGrabber}\n                        style={{\n                          cursor: !r.open\n                            ? \"move\"\n                            : i === 0\n                            ? \"pointer\"\n                            : undefined,\n                          pointerEvents:\n                            r.open && i === r.points.length - 1\n                              ? \"none\"\n                              : undefined,\n                          left: proj.x - 4,\n                          top: proj.y - 4\n                        }}\n                      />\n                    )\n                  })}\n                {r.type === \"polygon\" &&\n                  r.highlighted &&\n                  !dragWithPrimary &&\n                  !zoomWithPrimary &&\n                  !r.locked &&\n                  !r.open &&\n                  r.points.length > 1 &&\n                  r.points\n                    .map((p1, i) => [p1, r.points[(i + 1) % r.points.length]])\n                    .map(([p1, p2]) => [\n                      (p1[0] + p2[0]) / 2,\n                      (p1[1] + p2[1]) / 2\n                    ])\n                    .map((pa, i) => {\n                      const proj = mat\n                        .clone()\n                        .inverse()\n                        .applyToPoint(pa[0] * iw, pa[1] * ih)\n                      return (\n                        <div\n                          key={i}\n                          {...mouseEvents}\n                          onMouseDown={e => {\n                            if (e.button === 0)\n                              return onAddPolygonPoint(r, pa, i + 1)\n                            mouseEvents.onMouseDown(e)\n                          }}\n                          className={classes.transformGrabber}\n                          style={{\n                            cursor: \"copy\",\n                            left: proj.x - 4,\n                            top: proj.y - 4,\n                            border: \"2px dotted #fff\",\n                            opacity: 0.5\n                          }}\n                        />\n                      )\n                    })}\n              </PreventScrollToParents>\n            </Fragment>\n          )\n        })}\n      {showTags &&\n        regions\n          .filter(r => r.visible || r.visible === undefined)\n          .map(region => {\n            const pbox = projectRegionBox(region)\n            const { iw, ih } = layoutParams.current\n            let margin = 8\n            if (region.highlighted && region.type === \"box\") margin += 6\n            const labelBoxHeight =\n              region.editingLabels && !region.locked\n                ? 170\n                : region.tags\n                ? 60\n                : 50\n            const displayOnTop = pbox.y > labelBoxHeight\n\n            const coords = displayOnTop\n              ? {\n                  left: pbox.x,\n                  top: pbox.y - margin / 2\n                }\n              : { left: pbox.x, top: pbox.y + pbox.h + margin / 2 }\n            if (region.locked) {\n              return (\n                <div\n                  style={{\n                    position: \"absolute\",\n                    ...coords,\n                    zIndex: 10 + (region.editingLabels ? 5 : 0)\n                  }}\n                >\n                  <Paper\n                    style={{\n                      position: \"absolute\",\n                      left: 0,\n                      ...(displayOnTop ? { bottom: 0 } : { top: 0 }),\n                      zIndex: 10,\n                      backgroundColor: \"#fff\",\n                      borderRadius: 4,\n                      padding: 2,\n                      paddingBottom: 0,\n                      opacity: 0.5,\n                      pointerEvents: \"none\"\n                    }}\n                  >\n                    <LockIcon\n                      style={{ width: 16, height: 16, color: \"#333\" }}\n                    />\n                  </Paper>\n                </div>\n              )\n            }\n            return (\n              <div\n                style={{\n                  position: \"absolute\",\n                  ...coords,\n                  zIndex: 10 + (region.editingLabels ? 5 : 0),\n                  width: 200\n                }}\n                onMouseDown={e => e.preventDefault()}\n                onMouseUp={e => e.preventDefault()}\n                onMouseEnter={e => {\n                  if (region.editingLabels) {\n                    mouseEvents.onMouseUp(e)\n                    e.button = 1\n                    mouseEvents.onMouseUp(e)\n                  }\n                }}\n              >\n                <div\n                  style={{\n                    position: \"absolute\",\n                    left: 0,\n                    ...(displayOnTop ? { bottom: 0 } : { top: 0 })\n                  }}\n                  {...(!region.editingLabels ? mouseEvents : {})}\n                >\n                  <RegionLabel\n                    allowedClasses={regionClsList}\n                    allowedTags={regionTagList}\n                    onOpen={onBeginRegionEdit}\n                    onChange={onChangeRegion}\n                    onClose={onCloseRegionEdit}\n                    onDelete={onDeleteRegion}\n                    editing={region.editingLabels}\n                    region={region}\n                  />\n                </div>\n              </div>\n            )\n          })}\n      {zoomWithPrimary && zoomBox !== null && (\n        <div\n          style={{\n            position: \"absolute\",\n            border: \"1px solid #fff\",\n            pointerEvents: \"none\",\n            left: zoomBox.x,\n            top: zoomBox.y,\n            width: zoomBox.w,\n            height: zoomBox.h\n          }}\n        />\n      )}\n      {showPointDistances && (\n        <svg\n          className={classes.pointDistanceIndicator}\n          style={{\n            pointerEvents: \"none\",\n            position: \"absolute\",\n            left: 0,\n            top: 0,\n            width: \"100%\",\n            height: \"100%\"\n          }}\n        >\n          {regions\n            .filter(r1 => r1.type === \"point\")\n            .flatMap((r1, i1) =>\n              regions\n                .filter((r2, i2) => i2 > i1)\n                .filter(r2 => r2.type === \"point\")\n                .map(r2 => {\n                  const pr1 = projectRegionBox(r1)\n                  const pr2 = projectRegionBox(r2)\n                  const prm = {\n                    x: (pr1.x + pr1.w / 2 + pr2.x + pr2.w / 2) / 2,\n                    y: (pr1.y + pr1.h / 2 + pr2.y + pr2.h / 2) / 2\n                  }\n                  let displayDistance\n                  if (realSize) {\n                    const { w, h, unitName } = realSize\n                    displayDistance =\n                      Math.sqrt(\n                        Math.pow(r1.x * w - r2.x * w, 2) +\n                          Math.pow(r1.y * h - r2.y * h, 2)\n                      ).toFixed(pointDistancePrecision) + unitName\n                  } else {\n                    displayDistance =\n                      (\n                        Math.sqrt(\n                          Math.pow(r1.x - r2.x, 2) + Math.pow(r1.y - r2.y, 2)\n                        ) * 100\n                      ).toFixed(pointDistancePrecision) + \"%\"\n                  }\n                  return (\n                    <Fragment>\n                      <path\n                        d={`M${pr1.x + pr1.w / 2},${pr1.y +\n                          pr1.h / 2} L${pr2.x + pr2.w / 2},${pr2.y +\n                          pr2.h / 2}`}\n                      />\n                      <text x={prm.x} y={prm.y}>\n                        {displayDistance}\n                      </text>\n                    </Fragment>\n                  )\n                })\n            )}\n        </svg>\n      )}\n      <PreventScrollToParents\n        style={{ width: \"100%\", height: \"100%\" }}\n        {...mouseEvents}\n      >\n        <canvas className={classes.canvas} ref={canvasEl} />\n      </PreventScrollToParents>\n      <div className={classes.zoomIndicator}>\n        {((1 / mat.a) * 100).toFixed(0)}%\n      </div>\n    </div>\n  )\n}\n","import { grey } from \"@material-ui/core/colors\"\n\nexport default {\n  canvas: { width: \"100%\", height: \"100%\" },\n  transformGrabber: {\n    width: 8,\n    height: 8,\n    border: \"2px solid #FFF\",\n    position: \"absolute\"\n  },\n  zoomIndicator: {\n    position: \"absolute\",\n    bottom: 16,\n    right: 0,\n    backgroundColor: \"rgba(0,0,0,0.4)\",\n    color: \"#fff\",\n    opacity: 0.5,\n    fontWeight: \"bolder\",\n    fontSize: 14,\n    padding: 4\n  },\n  pointDistanceIndicator: {\n    \"& text\": {\n      fill: \"#fff\"\n    },\n    \"& path\": {\n      vectorEffect: \"non-scaling-stroke\",\n      strokeWidth: 2,\n      opacity: 0.5,\n      stroke: \"#FFF\",\n      fill: \"none\",\n      strokeDasharray: 5,\n      animationDuration: \"4s\",\n      animationTimingFunction: \"linear\",\n      animationIterationCount: \"infinite\",\n      animationPlayState: \"running\"\n    }\n  }\n}\n","// @flow\n\nexport type BaseRegion = {\n  id: string | number,\n  cls?: string,\n  locked?: boolean,\n  visible?: boolean,\n  color: string,\n  editingLabels?: boolean,\n  highlighted?: boolean,\n  tags?: Array<string>\n}\n\nexport type Point = {|\n  ...$Exact<BaseRegion>,\n  type: \"point\",\n  x: number,\n  y: number\n|}\n\nexport type PixelRegion =\n  | {|\n      ...$Exact<BaseRegion>,\n      type: \"pixel\",\n      sx: number,\n      sy: number,\n      w: number,\n      h: number,\n      src: string\n    |}\n  | {|\n      ...$Exact<BaseRegion>,\n      type: \"pixel\",\n      points: Array<[number, number]>\n    |}\nexport type Box = {|\n  ...$Exact<BaseRegion>,\n  type: \"box\",\n  x: number,\n  y: number,\n  w: number,\n  h: number\n|}\nexport type Polygon = {|\n  ...$Exact<BaseRegion>,\n  type: \"polygon\",\n  open?: boolean,\n  points: Array<[number, number]>\n|}\n\nexport type Region = Point | PixelRegion | Box | Polygon\n\nexport const getEnclosingBox = (region: Region) => {\n  switch (region.type) {\n    case \"polygon\": {\n      const box = {\n        x: Math.min(...region.points.map(([x, y]) => x)),\n        y: Math.min(...region.points.map(([x, y]) => y)),\n        w: 0,\n        h: 0\n      }\n      box.w = Math.max(...region.points.map(([x, y]) => x)) - box.x\n      box.h = Math.max(...region.points.map(([x, y]) => y)) - box.y\n      return box\n    }\n    case \"box\": {\n      return { x: region.x, y: region.y, w: region.w, h: region.h }\n    }\n    case \"point\": {\n      return { x: region.x, y: region.y, w: 0, h: 0 }\n    }\n    case \"pixel\": {\n      if (\n        region.sx !== undefined &&\n        region.sy !== undefined &&\n        region.w &&\n        region.h\n      ) {\n        return { x: region.sx, y: region.sy, w: region.w, h: region.h }\n      }\n      if (region.points) {\n        const box = {\n          x: Math.min(...region.points.map(([x, y]) => x)),\n          y: Math.min(...region.points.map(([x, y]) => y)),\n          w: 0,\n          h: 0\n        }\n        box.w = Math.max(...region.points.map(([x, y]) => x)) - box.x\n        box.h = Math.max(...region.points.map(([x, y]) => y)) - box.y\n        return box\n      }\n    }\n  }\n  throw new Error(\"unknown region\")\n}\n\nexport const moveRegion = (region: Region, x: number, y: number) => {\n  switch (region.type) {\n    case \"point\": {\n      return { ...region, x, y }\n    }\n    case \"box\": {\n      return { ...region, x: x - region.w / 2, y: y - region.h / 2 }\n    }\n  }\n  return region\n}\n","export default `data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4wMSAxY5oG+lzgAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAAcSURBVAjXY/jPwPCfAQnA+TAGugLcAhhakRUAAK3lEe8m9qZhAAAAAElFTkSuQmCC`\n","// @flow\n\nimport React, { createContext } from \"react\"\nimport Button from \"@material-ui/core/Button\"\n\nexport const HeaderButtonContext = createContext()\n\nexport default ({ name, Icon }: { name: string, Icon: any }) => {\n  return (\n    <HeaderButtonContext.Consumer>\n      {({ onHeaderButtonClick }: any) => (\n        <Button\n          onClick={() => onHeaderButtonClick(name)}\n          style={{ width: 80, margin: 2 }}\n        >\n          <div>\n            <Icon style={{}} />\n            <div style={{ fontWeight: \"bold\" }}>{name}</div>\n          </div>\n        </Button>\n      )}\n    </HeaderButtonContext.Consumer>\n  )\n}\n","import { grey } from \"@material-ui/core/colors\"\n\nexport default {\n  header: {\n    display: \"flex\",\n    position: \"relative\",\n    flexDirection: \"row\",\n    flexShrink: 0,\n    zIndex: 10,\n    boxShadow: \"0px 3px 8px rgba(0,0,0,.1)\"\n  },\n  fileInfo: {\n    flexGrow: 1,\n    alignItems: \"center\",\n    display: \"flex\",\n    fontWeight: \"bold\",\n    color: grey[800],\n    fontSize: 24,\n    paddingLeft: 16\n  }\n}\n","// @flow\n\nimport React from \"react\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport HeaderButton, { HeaderButtonContext } from \"../HeaderButton\"\nimport BackIcon from \"@material-ui/icons/KeyboardArrowLeft\"\nimport NextIcon from \"@material-ui/icons/KeyboardArrowRight\"\nimport SettingsIcon from \"@material-ui/icons/Settings\"\nimport HelpIcon from \"@material-ui/icons/Help\"\nimport FullscreenIcon from \"@material-ui/icons/Fullscreen\"\nimport ExitIcon from \"@material-ui/icons/ExitToApp\"\nimport HotkeysIcon from \"@material-ui/icons/Keyboard\"\nimport styles from \"./styles\"\n\nconst useStyles = makeStyles(styles)\n\ntype Props = {\n  onHeaderButtonClick: string => any,\n  title: string,\n  inFullScreen?: boolean,\n  multipleImages?: boolean\n}\n\nexport default ({\n  onHeaderButtonClick,\n  title,\n  inFullScreen,\n  multipleImages\n}: Props) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.header}>\n      <div className={classes.fileInfo}>{title}</div>\n      <div className={classes.headerActions}>\n        <HeaderButtonContext.Provider value={{ onHeaderButtonClick }}>\n          {multipleImages && (\n            <>\n              <HeaderButton name=\"Prev\" Icon={BackIcon} />\n              <HeaderButton name=\"Next\" Icon={NextIcon} />\n            </>\n          )}\n          <HeaderButton name=\"Settings\" Icon={SettingsIcon} />\n          {/* <HeaderButton name=\"Help\" Icon={HelpIcon} /> */}\n          {inFullScreen ? (\n            <HeaderButton name=\"Window\" Icon={FullscreenIcon} />\n          ) : (\n            <HeaderButton name=\"Fullscreen\" Icon={FullscreenIcon} />\n          )}\n          {/* <HeaderButton name=\"Hotkeys\" Icon={HotkeysIcon} /> */}\n          <HeaderButton name=\"Save\" Icon={ExitIcon} />\n        </HeaderButtonContext.Provider>\n      </div>\n    </div>\n  )\n}\n","// @flow\n\nimport React, { createContext, useContext } from \"react\"\nimport IconButton from \"@material-ui/core/IconButton\"\nimport Tooltip from \"@material-ui/core/Tooltip\"\nimport { blue } from \"@material-ui/core/colors\"\n\nexport const SelectedTool = createContext()\n\nexport default ({\n  id,\n  name,\n  icon,\n  selected,\n  togglable,\n  alwaysShowing = false\n}: {\n  id: string,\n  name: string,\n  icon: any,\n  alwaysShowing?: boolean,\n  selected?: boolean,\n  togglable?: boolean\n}) => {\n  const { enabledTools, selectedTool, onClickTool } = useContext(SelectedTool)\n  if (!enabledTools.includes(id) && !alwaysShowing) return null\n  selected = selected || selectedTool === id\n  return (\n    <Tooltip placement=\"right\" title={name}>\n      <div>\n        <IconButton\n          disabled={!togglable ? selected : undefined}\n          aria-label={name}\n          onClick={() => onClickTool(id)}\n          size=\"small\"\n          style={{\n            width: 50,\n            height: 50,\n            margin: 1,\n            color: selected ? blue[500] : undefined\n          }}\n        >\n          {icon}\n        </IconButton>\n      </div>\n    </Tooltip>\n  )\n}\n","// @flow\n\nimport React from \"react\"\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport {\n  faArrowsAlt,\n  faMousePointer,\n  faExpandArrowsAlt,\n  faTag,\n  faPaintBrush,\n  faCrosshairs,\n  faDrawPolygon,\n  faVectorSquare,\n  faHandPaper,\n  faSearch\n} from \"@fortawesome/free-solid-svg-icons\"\nimport SmallToolButton, { SelectedTool } from \"../SmallToolButton\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport { grey } from \"@material-ui/core/colors\"\n\nconst useStyles = makeStyles({\n  iconTools: {\n    display: \"flex\",\n    padding: 4,\n    flexDirection: \"column\",\n    zIndex: 9,\n    boxShadow: \"0px 0px 5px rgba(0,0,0,0.1)\",\n    borderRight: `1px solid ${grey[300]}`,\n    backgroundColor: grey[100]\n  }\n})\n\ntype Props = {\n  showTags?: boolean,\n  enabledTools?: Array<string>,\n  selectedTool: string,\n  onClickTool: string => any\n}\n\nexport default ({\n  showTags,\n  selectedTool,\n  onClickTool,\n  enabledTools = [\"select\", \"create-point\", \"create-box\", \"create-polygon\"]\n}: Props) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.iconTools}>\n      <SelectedTool.Provider\n        value={{ enabledTools, selectedTool, onClickTool }}\n      >\n        <SmallToolButton\n          id=\"select\"\n          name=\"Select Region\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faMousePointer} />}\n        />\n        <SmallToolButton\n          alwaysShowing\n          id=\"pan\"\n          name=\"Drag/Pan\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faHandPaper} />}\n        />\n        <SmallToolButton\n          alwaysShowing\n          id=\"zoom\"\n          name=\"Zoom In/Out\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faSearch} />}\n        />\n        {/* <SmallToolButton\n          name=\"Move Region\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faArrowsAlt} />}\n        />\n        <SmallToolButton\n          name=\"Resize Region\"\n          icon={\n            <FontAwesomeIcon size=\"xs\" fixedWidth icon={faExpandArrowsAlt} />\n          }\n        /> */}\n        <SmallToolButton\n          alwaysShowing\n          togglable\n          id=\"show-tags\"\n          selected={showTags}\n          name=\"Show Tags\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faTag} />}\n        />\n        <SmallToolButton\n          id=\"create-point\"\n          name=\"Add Point\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faCrosshairs} />}\n        />\n        <SmallToolButton\n          id=\"create-box\"\n          name=\"Add Bounding Box\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faVectorSquare} />}\n        />\n        <SmallToolButton\n          id=\"create-polygon\"\n          name=\"Add Polygon\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faDrawPolygon} />}\n        />\n        {/* <SmallToolButton\n          id=\"create-pixel\"\n          name=\"Add Pixel Region\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faPaintBrush} />}\n        /> */}\n      </SelectedTool.Provider>\n    </div>\n  )\n}\n","import { grey } from \"@material-ui/core/colors\"\n\nexport default {\n  container: {\n    display: \"flex\",\n    flexGrow: 1,\n    flexDirection: \"column\",\n    minHeight: \"100%\",\n    maxHeight: \"100vh\",\n    backgroundColor: \"#fff\",\n    overflow: \"hidden\",\n    \"&.fullscreen\": {\n      position: \"absolute\",\n      zIndex: 99999,\n      left: 0,\n      right: 0,\n      top: 0,\n      bottom: 0\n    }\n  },\n  workspace: {\n    backgroundColor: grey[200],\n    flexGrow: 1,\n    display: \"flex\",\n    flexDirection: \"row\"\n  },\n  iconToolsContainer: { display: \"flex\" },\n  imageCanvasContainer: {\n    display: \"flex\",\n    flexGrow: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  },\n  noImageSelected: {\n    fontWeight: \"bold\",\n    fontSize: 32,\n    color: grey[500]\n  },\n  sidebarContainer: {\n    width: 300,\n    overflowY: \"auto\",\n    backgroundColor: grey[100],\n    borderLeft: `1px solid ${grey[300]}`,\n    zIndex: 9,\n    maxHeight: \"calc(100% - 68px)\",\n    boxShadow: \"0px 0px 5px rgba(0,0,0,0.1)\"\n  }\n}\n","// @flow\n\nimport React, { createContext, useContext, useState } from \"react\"\n\nconst defaultSettings = {\n  showCrosshairs: false\n}\n\nexport const SettingsContext = createContext(defaultSettings)\n\nconst pullSettingsFromLocalStorage = () => {\n  if (!window || !window.localStorage) return {}\n  let settings = {}\n  for (let i = 0; i < window.localStorage.length; i++) {\n    const key = window.localStorage.key(i)\n    if (key.startsWith(\"settings_\")) {\n      try {\n        settings[key.replace(\"settings_\", \"\")] = JSON.parse(\n          window.localStorage.getItem(key)\n        )\n      } catch (e) {}\n    }\n  }\n  return settings\n}\n\nexport const useSettings = () => useContext(SettingsContext)\n\nexport default ({ children }) => {\n  const [state, changeState] = useState(() => pullSettingsFromLocalStorage())\n  const changeSetting = (setting: string, value: any) => {\n    changeState({ ...state, [setting]: value })\n    window.localStorage.setItem(`settings_${setting}`, JSON.stringify(value))\n  }\n  return (\n    <SettingsContext.Provider value={{ ...state, changeSetting }}>\n      {children}\n    </SettingsContext.Provider>\n  )\n}\n","// @flow\n\nimport React from \"react\"\nimport Dialog from \"@material-ui/core/Dialog\"\nimport DialogTitle from \"@material-ui/core/DialogTitle\"\nimport DialogContent from \"@material-ui/core/DialogContent\"\nimport DialogActions from \"@material-ui/core/DialogActions\"\nimport Button from \"@material-ui/core/Button\"\nimport Survey from \"material-survey/components/Survey\"\nimport { useSettings } from \"../SettingsProvider\"\n\nexport default ({ open, onClose }) => {\n  const settings = useSettings()\n  return (\n    <Dialog open={open} onClose={onClose}>\n      <DialogTitle>Settings</DialogTitle>\n      <DialogContent style={{ minWidth: 400 }}>\n        <Survey\n          variant=\"flat\"\n          noActions\n          defaultAnswers={settings}\n          onQuestionChange={(q, a, answers) => settings.changeSetting(q, a)}\n          form={{\n            questions: [\n              {\n                type: \"boolean\",\n                title: \"Show Crosshairs\",\n                name: \"showCrosshairs\"\n              }\n            ]\n          }}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onClose}>Close</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n","// @flow\n\nimport React, { useState } from \"react\"\nimport Grid from \"@material-ui/core/Grid\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport Sidebar from \"../Sidebar\"\nimport ImageCanvas from \"../ImageCanvas\"\nimport Header from \"../Header\"\nimport IconTools from \"../IconTools\"\nimport styles from \"./styles\"\nimport type { MainLayoutState, Action } from \"./types\"\nimport useKey from \"use-key-hook\"\nimport classnames from \"classnames\"\nimport { useSettings } from \"../SettingsProvider\"\nimport SettingsDialog from \"../SettingsDialog\"\nimport Fullscreen from \"react-full-screen\"\n\nconst useStyles = makeStyles(styles)\n\ntype Props = {\n  state: MainLayoutState,\n  dispatch: Action => any\n}\n\nexport default ({ state, dispatch }: Props) => {\n  const classes = useStyles()\n  const settings = useSettings()\n\n  const action = (type: string, ...params: Array<string>) => (...args: any) =>\n    params.length > 0\n      ? dispatch(\n          ({\n            type,\n            ...params.reduce((acc, p, i) => ((acc[p] = args[i]), acc), {})\n          }: any)\n        )\n      : dispatch({ type, ...args[0] })\n\n  const currentImage = state.images.find(img => img.src === state.selectedImage)\n\n  useKey(() => dispatch({ type: \"CANCEL\" }), {\n    detectKeys: [27]\n  })\n\n  return (\n    <Fullscreen\n      enabled={state.fullScreen}\n      onChange={open => {\n        if (!open) {\n          action(\"HEADER_BUTTON_CLICKED\", \"buttonName\")(\"Exit Fullscreen\")\n        }\n      }}\n    >\n      <div\n        className={classnames(\n          classes.container,\n          state.fullScreen && \"Fullscreen\"\n        )}\n      >\n        <div className={classes.headerContainer}>\n          <Header\n            onHeaderButtonClick={action(\"HEADER_BUTTON_CLICKED\", \"buttonName\")}\n            inFullScreen={state.fullScreen}\n            multipleImages={Boolean(state.images.length > 1)}\n            title={currentImage ? currentImage.name : \"No Image Selected\"}\n          />\n        </div>\n        <div className={classes.workspace}>\n          <div className={classes.iconToolsContainer}>\n            <IconTools\n              enabledTools={state.enabledTools}\n              showTags={state.showTags}\n              selectedTool={state.selectedTool}\n              onClickTool={action(\"SELECT_TOOL\", \"selectedTool\")}\n            />\n          </div>\n          <div className={classes.imageCanvasContainer}>\n            {!state.selectedImage ? (\n              <div className={classes.noImageSelected}>No Image Selected</div>\n            ) : (\n              <div style={{ height: \"100%\", width: \"100%\" }}>\n                <ImageCanvas\n                  {...settings}\n                  key={state.selectedImage}\n                  showTags={state.showTags}\n                  allowedArea={state.allowedArea}\n                  regionClsList={state.regionClsList}\n                  regionTagList={state.regionTagList}\n                  regions={currentImage ? currentImage.regions || [] : []}\n                  realSize={currentImage ? currentImage.realSize : undefined}\n                  imageSrc={state.selectedImage}\n                  pointDistancePrecision={state.pointDistancePrecision}\n                  createWithPrimary={state.selectedTool.includes(\"create\")}\n                  dragWithPrimary={state.selectedTool === \"pan\"}\n                  zoomWithPrimary={state.selectedTool === \"zoom\"}\n                  showPointDistances={state.showPointDistances}\n                  pointDistancePrecision={state.pointDistancePrecision}\n                  onMouseMove={action(\"MOUSE_MOVE\")}\n                  onMouseDown={action(\"MOUSE_DOWN\")}\n                  onMouseUp={action(\"MOUSE_UP\")}\n                  onChangeRegion={action(\"CHANGE_REGION\", \"region\")}\n                  onBeginRegionEdit={action(\"OPEN_REGION_EDITOR\", \"region\")}\n                  onCloseRegionEdit={action(\"CLOSE_REGION_EDITOR\", \"region\")}\n                  onDeleteRegion={action(\"DELETE_REGION\", \"region\")}\n                  onBeginBoxTransform={action(\n                    \"BEGIN_BOX_TRANSFORM\",\n                    \"box\",\n                    \"directions\"\n                  )}\n                  onBeginMovePolygonPoint={action(\n                    \"BEGIN_MOVE_POLYGON_POINT\",\n                    \"polygon\",\n                    \"pointIndex\"\n                  )}\n                  onAddPolygonPoint={action(\n                    \"ADD_POLYGON_POINT\",\n                    \"polygon\",\n                    \"point\",\n                    \"pointIndex\"\n                  )}\n                  onSelectRegion={action(\"SELECT_REGION\", \"region\")}\n                  onBeginMovePoint={action(\"BEGIN_MOVE_POINT\", \"point\")}\n                  onImageLoaded={action(\"IMAGE_LOADED\", \"image\")}\n                />\n              </div>\n            )}\n          </div>\n          <div className={classes.sidebarContainer}>\n            <Sidebar\n              debug={window.localStorage.$ANNOTATE_DEBUG_MODE && state}\n              taskDescription={state.taskDescription}\n              images={state.images}\n              regions={currentImage ? currentImage.regions || [] : []}\n              history={state.history}\n              currentImage={currentImage}\n              labelImages={state.labelImages}\n              imageClsList={state.imageClsList}\n              imageTagList={state.imageTagList}\n              onChangeImage={action(\"CHANGE_IMAGE\", \"delta\")}\n              onSelectRegion={action(\"SELECT_REGION\", \"region\")}\n              onDeleteRegion={action(\"DELETE_REGION\", \"region\")}\n              onSelectImage={action(\"SELECT_IMAGE\", \"image\")}\n              onChangeRegion={action(\"CHANGE_REGION\", \"region\")}\n              onRestoreHistory={action(\"RESTORE_HISTORY\")}\n            />\n          </div>\n        </div>\n        <SettingsDialog\n          open={state.settingsOpen}\n          onClose={() =>\n            dispatch({\n              type: \"HEADER_BUTTON_CLICKED\",\n              buttonName: \"Settings\"\n            })\n          }\n        />\n      </div>\n    </Fullscreen>\n  )\n}\n","// @flow\n\nimport type { MainLayoutState, Action } from \"../MainLayout/types\"\nimport { moveRegion } from \"../ImageCanvas/region-tools.js\"\nimport { setIn, updateIn } from \"seamless-immutable\"\nimport moment from \"moment\"\nimport isEqual from \"lodash/isEqual\"\n\nconst getRandomId = () =>\n  Math.random()\n    .toString()\n    .split(\".\")[1]\n\nconst getRandomInt = (min, max) => {\n  return Math.floor(Math.random() * (max - min + 1)) + min\n}\n\nconst getRandomColor = () => {\n  const h = getRandomInt(0, 360)\n  const s = 100\n  const l = 50\n  return `hsl(${h},${s}%,${l}%)`\n}\n\nconst typesToSaveWithHistory = {\n  BEGIN_BOX_TRANSFORM: \"Transform/Move Box\",\n  BEGIN_MOVE_POINT: \"Move Point\",\n  DELETE_REGION: \"Delete Region\"\n}\n\nexport default (state: MainLayoutState, action: Action) => {\n  if (!action.type.includes(\"MOUSE\")) {\n    state = setIn(state, [\"lastAction\"], action)\n  }\n  let currentImageIndex = state.images.findIndex(\n    img => img.src === state.selectedImage\n  )\n  if (currentImageIndex === -1) currentImageIndex = null\n  const getRegionIndex = region => {\n    const regionId = typeof region === \"string\" ? region : region.id\n    if (currentImageIndex === null) return null\n    const regionIndex = (\n      state.images[currentImageIndex].regions || []\n    ).findIndex(r => r.id === regionId)\n    return regionIndex === -1 ? null : regionIndex\n  }\n  const getRegion = regionId => {\n    const regionIndex = getRegionIndex(regionId)\n    if (regionIndex === null) return [null, null]\n    const region = state.images[currentImageIndex].regions[regionIndex]\n    return [region, regionIndex]\n  }\n  const modifyRegion = (regionId, obj) => {\n    const [region, regionIndex] = getRegion(regionId)\n    if (!region) return state\n    if (obj !== null) {\n      return setIn(\n        state,\n        [\"images\", currentImageIndex, \"regions\", regionIndex],\n        {\n          ...state.images[currentImageIndex].regions[regionIndex],\n          ...obj\n        }\n      )\n    } else {\n      // delete region\n      const regions = state.images[currentImageIndex].regions\n      return setIn(\n        state,\n        [\"images\", currentImageIndex, \"regions\"],\n        (regions || []).filter(r => r.id !== region.id)\n      )\n    }\n  }\n  const unselectRegions = (state: MainLayoutState) => {\n    if (currentImageIndex === null) return state\n    return setIn(\n      state,\n      [\"images\", currentImageIndex, \"regions\"],\n      (state.images[currentImageIndex].regions || []).map(r => ({\n        ...r,\n        highlighted: false\n      }))\n    )\n  }\n\n  const saveToHistory = (state: MainLayoutState, name: string) =>\n    updateIn(state, [\"history\"], h =>\n      [\n        {\n          time: moment().toDate(),\n          state,\n          name\n        }\n      ].concat((h || []).slice(0, 9))\n    )\n\n  if (Object.keys(typesToSaveWithHistory).includes(action.type)) {\n    state = saveToHistory(\n      state,\n      typesToSaveWithHistory[action.type] || action.type\n    )\n  }\n\n  const closeEditors = (state: MainLayoutState) => {\n    if (currentImageIndex === null) return state\n    return setIn(\n      state,\n      [\"images\", currentImageIndex, \"regions\"],\n      (state.images[currentImageIndex].regions || []).map(r => ({\n        ...r,\n        editingLabels: false\n      }))\n    )\n  }\n\n  const setNewImage = (newImage: string) => {\n    return setIn(state, [\"selectedImage\"], newImage)\n  }\n\n  switch (action.type) {\n    case \"@@INIT\": {\n      return state\n    }\n    case \"SELECT_IMAGE\": {\n      return setNewImage(action.image.src)\n    }\n    case \"IMAGE_LOADED\": {\n      return setIn(state, [\"images\", currentImageIndex, \"pixelSize\"], {\n        w: action.image.width,\n        h: action.image.height\n      })\n    }\n    case \"CHANGE_REGION\": {\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      const oldRegion = state.images[currentImageIndex].regions[regionIndex]\n      if (oldRegion.cls !== action.region.cls) {\n        state = saveToHistory(state, \"Change Region Classification\")\n      }\n      if (!isEqual(oldRegion.tags, action.region.tags)) {\n        state = saveToHistory(state, \"Change Region Tags\")\n      }\n      return setIn(\n        state,\n        [\"images\", currentImageIndex, \"regions\", regionIndex],\n        action.region\n      )\n    }\n    case \"RESTORE_HISTORY\": {\n      if (state.history.length > 0) {\n        return state.history[0].state\n      }\n      return state\n    }\n    case \"CHANGE_IMAGE\": {\n      if (currentImageIndex === null) return state\n      const { delta } = action\n      for (const key of Object.keys(delta)) {\n        if (key === \"cls\") saveToHistory(state, \"Change Image Class\")\n        if (key === \"tags\") saveToHistory(state, \"Change Image Tags\")\n        state = setIn(state, [\"images\", currentImageIndex, key], delta[key])\n      }\n      return state\n    }\n    case \"SELECT_REGION\": {\n      const { region } = action\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      const regions = [...(state.images[currentImageIndex].regions || [])].map(\n        r => ({\n          ...r,\n          highlighted: r.id === region.id,\n          editingLabels: r.id === region.id\n        })\n      )\n      return setIn(state, [\"images\", currentImageIndex, \"regions\"], regions)\n    }\n    case \"BEGIN_MOVE_POINT\": {\n      state = closeEditors(state)\n      return setIn(state, [\"mode\"], {\n        mode: \"MOVE_REGION\",\n        regionId: action.point.id\n      })\n    }\n    case \"BEGIN_BOX_TRANSFORM\": {\n      const { box, directions } = action\n      state = closeEditors(state)\n      if (directions[0] === 0 && directions[1] === 0) {\n        return setIn(state, [\"mode\"], { mode: \"MOVE_REGION\", regionId: box.id })\n      } else {\n        return setIn(state, [\"mode\"], {\n          mode: \"RESIZE_BOX\",\n          regionId: box.id,\n          freedom: directions,\n          original: { x: box.x, y: box.y, w: box.w, h: box.h }\n        })\n      }\n    }\n    case \"BEGIN_MOVE_POLYGON_POINT\": {\n      const { polygon, pointIndex } = action\n      state = closeEditors(state)\n      if (\n        state.mode &&\n        state.mode.mode === \"DRAW_POLYGON\" &&\n        pointIndex === 0\n      ) {\n        return setIn(\n          modifyRegion(polygon, {\n            points: polygon.points.slice(0, -1),\n            open: false\n          }),\n          [\"mode\"],\n          null\n        )\n      } else {\n        state = saveToHistory(state, \"Move Polygon Point\")\n      }\n      return setIn(state, [\"mode\"], {\n        mode: \"MOVE_POLYGON_POINT\",\n        regionId: polygon.id,\n        pointIndex\n      })\n    }\n    case \"ADD_POLYGON_POINT\": {\n      const { polygon, point, pointIndex } = action\n      const regionIndex = getRegionIndex(polygon)\n      if (regionIndex === null) return state\n      const points = [...polygon.points]\n      points.splice(pointIndex, 0, point)\n      return setIn(\n        state,\n        [\"images\", currentImageIndex, \"regions\", regionIndex],\n        { ...polygon, points }\n      )\n    }\n    case \"MOUSE_MOVE\": {\n      const { x, y } = action\n      if (!state.mode) return state\n      if (currentImageIndex === null) return state\n      switch (state.mode.mode) {\n        case \"MOVE_POLYGON_POINT\": {\n          const { pointIndex, regionId } = state.mode\n          const regionIndex = getRegionIndex(regionId)\n          if (regionIndex === null) return state\n          return setIn(\n            state,\n            [\n              \"images\",\n              currentImageIndex,\n              \"regions\",\n              regionIndex,\n              \"points\",\n              pointIndex\n            ],\n            [x, y]\n          )\n        }\n        case \"MOVE_REGION\": {\n          const { regionId } = state.mode\n          const regionIndex = getRegionIndex(regionId)\n          if (regionIndex === null) return state\n          return setIn(\n            state,\n            [\"images\", currentImageIndex, \"regions\", regionIndex],\n            moveRegion(\n              state.images[currentImageIndex].regions[regionIndex],\n              x,\n              y\n            )\n          )\n        }\n        case \"RESIZE_BOX\": {\n          const {\n            regionId,\n            freedom: [xFree, yFree],\n            original: { x: ox, y: oy, w: ow, h: oh }\n          } = state.mode\n          const regionIndex = getRegionIndex(regionId)\n          if (regionIndex === null) return state\n          const box = state.images[currentImageIndex].regions[regionIndex]\n\n          const dx = xFree === 0 ? ox : xFree === -1 ? Math.min(ox + ow, x) : ox\n          const dw =\n            xFree === 0\n              ? ow\n              : xFree === -1\n                ? ow + (ox - dx)\n                : Math.max(0, ow + (x - ox - ow))\n          const dy = yFree === 0 ? oy : yFree === -1 ? Math.min(oy + oh, y) : oy\n          const dh =\n            yFree === 0\n              ? oh\n              : yFree === -1\n                ? oh + (oy - dy)\n                : Math.max(0, oh + (y - oy - oh))\n\n          // determine if we should switch the freedom\n          if (dw <= 0.001) {\n            state = setIn(state, [\"mode\", \"freedom\"], [xFree * -1, yFree])\n          }\n          if (dh <= 0.001) {\n            state = setIn(state, [\"mode\", \"freedom\"], [xFree, yFree * -1])\n          }\n\n          return setIn(\n            state,\n            [\"images\", currentImageIndex, \"regions\", regionIndex],\n            { ...box, x: dx, w: dw, y: dy, h: dh }\n          )\n        }\n        case \"DRAW_POLYGON\": {\n          const { regionId } = state.mode\n          const [region, regionIndex] = getRegion(regionId)\n          if (!region) return setIn(state, [\"mode\"], null)\n          return setIn(\n            state,\n            [\n              \"images\",\n              currentImageIndex,\n              \"regions\",\n              regionIndex,\n              \"points\",\n              (region: any).points.length - 1\n            ],\n            [x, y]\n          )\n        }\n      }\n      return state\n    }\n    case \"MOUSE_DOWN\": {\n      const { x, y } = action\n\n      let newRegion\n      if (currentImageIndex !== null) {\n        const region = state.images[currentImageIndex].regions\n\n        if (state.allowedArea) {\n          const aa = state.allowedArea\n          if (x < aa.x || x > aa.x + aa.w || y < aa.y || y > aa.y + aa.h) {\n            return state\n          }\n        }\n\n        switch (state.selectedTool) {\n          case \"create-point\": {\n            state = saveToHistory(state, \"Create Point\")\n            newRegion = {\n              type: \"point\",\n              x,\n              y,\n              highlighted: true,\n              editingLabels: true,\n              color: getRandomColor(),\n              id: getRandomId()\n            }\n            break\n          }\n          case \"create-box\": {\n            state = saveToHistory(state, \"Create Box\")\n            newRegion = {\n              type: \"box\",\n              x: x,\n              y: x,\n              w: 0.01,\n              h: 0.01,\n              highlighted: true,\n              editingLabels: false,\n              color: getRandomColor(),\n              id: getRandomId()\n            }\n            state = unselectRegions(state)\n            state = setIn(state, [\"mode\"], {\n              mode: \"RESIZE_BOX\",\n              editLabelEditorAfter: true,\n              regionId: newRegion.id,\n              freedom: [1, 1],\n              original: { x, y, w: newRegion.w, h: newRegion.h }\n            })\n            break\n          }\n          case \"create-polygon\": {\n            if (state.mode && state.mode.mode === \"DRAW_POLYGON\") break\n            state = saveToHistory(state, \"Create Polygon\")\n            newRegion = {\n              type: \"polygon\",\n              points: [[x, y], [x, y]],\n              open: true,\n              highlighted: true,\n              color: getRandomColor(),\n              id: getRandomId()\n            }\n            state = setIn(state, [\"mode\"], {\n              mode: \"DRAW_POLYGON\",\n              regionId: newRegion.id\n            })\n            break\n          }\n        }\n      }\n\n      if (newRegion) {\n        state = unselectRegions(state)\n      }\n\n      if (state.mode) {\n        switch (state.mode.mode) {\n          case \"DRAW_POLYGON\": {\n            const [polygon, regionIndex] = getRegion(state.mode.regionId)\n            if (!polygon) break\n            state = setIn(\n              state,\n              [\"images\", currentImageIndex, \"regions\", regionIndex],\n              { ...polygon, points: polygon.points.concat([[x, y]]) }\n            )\n          }\n        }\n      }\n\n      const regions = [...(state.images[currentImageIndex].regions || [])]\n        .map(r => ({\n          ...r,\n          editingLabels: false\n        }))\n        .concat(newRegion ? [newRegion] : [])\n\n      return setIn(state, [\"images\", currentImageIndex, \"regions\"], regions)\n    }\n    case \"MOUSE_UP\": {\n      const { x, y } = action\n      if (!state.mode) return state\n      switch (state.mode.mode) {\n        case \"RESIZE_BOX\": {\n          if (state.mode.editLabelEditorAfter) {\n            return {\n              ...modifyRegion(state.mode.regionId, { editingLabels: true }),\n              mode: null\n            }\n          }\n        }\n        case \"MOVE_REGION\":\n        case \"MOVE_POLYGON_POINT\": {\n          return { ...state, mode: null }\n        }\n      }\n      return state\n    }\n    case \"CHANGE_REGION\": {\n      const { region } = action\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      return setIn(\n        state,\n        [\"images\", currentImageIndex, \"regions\", regionIndex],\n        region\n      )\n    }\n    case \"OPEN_REGION_EDITOR\": {\n      const { region } = action\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      const newRegions = setIn(\n        state.images[currentImageIndex].regions.map(r => ({\n          ...r,\n          highlighted: false,\n          editingLabels: false\n        })),\n        [regionIndex],\n        {\n          ...(state.images[currentImageIndex].regions || [])[regionIndex],\n          highlighted: true,\n          editingLabels: true\n        }\n      )\n      return setIn(state, [\"images\", currentImageIndex, \"regions\"], newRegions)\n    }\n    case \"CLOSE_REGION_EDITOR\": {\n      const { region } = action\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      return setIn(\n        state,\n        [\"images\", currentImageIndex, \"regions\", regionIndex],\n        {\n          ...(state.images[currentImageIndex].regions || [])[regionIndex],\n          editingLabels: false\n        }\n      )\n    }\n    case \"DELETE_REGION\": {\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      return setIn(\n        state,\n        [\"images\", currentImageIndex, \"regions\"],\n        (state.images[currentImageIndex].regions || []).filter(\n          r => r.id !== action.region.id\n        )\n      )\n    }\n    case \"HEADER_BUTTON_CLICKED\": {\n      const buttonName = action.buttonName.toLowerCase()\n      switch (buttonName) {\n        case \"prev\": {\n          if (currentImageIndex === null) return state\n          if (currentImageIndex === 0) return state\n          return setNewImage(state.images[currentImageIndex - 1].src)\n        }\n        case \"next\": {\n          if (currentImageIndex === null) return state\n          if (currentImageIndex === state.images.length - 1) return state\n          return setNewImage(state.images[currentImageIndex + 1].src)\n        }\n        case \"settings\": {\n          return setIn(state, [\"settingsOpen\"], !state.settingsOpen)\n        }\n        case \"help\": {\n          return state\n        }\n        case \"fullscreen\": {\n          return setIn(state, [\"fullScreen\"], true)\n        }\n        case \"exit fullscreen\":\n        case \"window\": {\n          return setIn(state, [\"fullScreen\"], false)\n        }\n        case \"hotkeys\": {\n          return state\n        }\n        case \"exit\":\n        case \"done\": {\n          return state\n        }\n      }\n      return state\n      // return setIn(state, [\"\"]\n    }\n    case \"SELECT_TOOL\": {\n      state = setIn(state, [\"mode\"], null)\n      if (action.selectedTool === \"show-tags\") {\n        return setIn(state, [\"showTags\"], !state.showTags)\n      }\n      return setIn(state, [\"selectedTool\"], action.selectedTool)\n    }\n    case \"CANCEL\": {\n      const { mode } = state\n      if (mode) {\n        switch (mode.mode) {\n          case \"DRAW_POLYGON\": {\n            const { regionId } = mode\n            return modifyRegion(regionId, null)\n          }\n          case \"MOVE_POLYGON_POINT\":\n          case \"RESIZE_BOX\":\n          case \"MOVE_REGION\": {\n            return setIn(state, [\"mode\"], null)\n          }\n        }\n      }\n      // Close any open boxes\n      const regions: any = state.images[currentImageIndex].regions\n      if (regions.some(r => r.editingLabels)) {\n        return setIn(\n          state,\n          [\"images\", currentImageIndex, \"regions\"],\n          regions.map(r => ({\n            ...r,\n            editingLabels: false\n          }))\n        )\n      } else {\n        return setIn(\n          state,\n          [\"images\", currentImageIndex, \"regions\"],\n          regions.map(r => ({\n            ...r,\n            highlighted: false\n          }))\n        )\n      }\n    }\n  }\n  return state\n}\n","// @flow\n\nimport React, { useReducer } from \"react\"\nimport MainLayout from \"../MainLayout\"\nimport type {\n  ToolEnum,\n  Image,\n  Mode,\n  MainLayoutState,\n  Action\n} from \"../MainLayout/types\"\nimport SettingsProvider from \"../SettingsProvider\"\nimport reducer from \"./reducer\"\n\ntype Props = {\n  taskDescription: string,\n  allowedArea?: { x: number, y: number, w: number, h: number },\n  regionTagList?: Array<string>,\n  regionClsList?: Array<string>,\n  imageTagList?: Array<string>,\n  imageClsList?: Array<string>,\n  enabledTools?: Array<string>,\n  showTags?: boolean,\n  selectedImage?: string,\n  images: Array<Image>,\n  showPointDistances?: boolean,\n  pointDistancePrecision?: number,\n  onExit: MainLayoutState => any\n}\n\nexport default ({\n  images,\n  allowedArea,\n  selectedImage = images.length > 0 ? images[0].src : undefined,\n  showPointDistances,\n  pointDistancePrecision,\n  showTags = true,\n  enabledTools = [\"select\", \"create-point\", \"create-box\", \"create-polygon\"],\n  regionTagList = [],\n  regionClsList = [],\n  imageTagList = [],\n  imageClsList = [],\n  taskDescription,\n  onExit\n}: Props) => {\n  const [state, dispatchToReducer] = useReducer(reducer, {\n    showTags,\n    allowedArea,\n    selectedImage,\n    showPointDistances,\n    pointDistancePrecision,\n    selectedTool: \"select\",\n    mode: null,\n    taskDescription,\n    images,\n    labelImages: imageClsList.length > 0 || imageTagList.length > 0,\n    regionClsList,\n    regionTagList,\n    imageClsList,\n    imageTagList,\n    enabledTools,\n    history: []\n  })\n\n  const dispatch = (action: Action) => {\n    if (\n      action.type === \"HEADER_BUTTON_CLICKED\" &&\n      (action.buttonName === \"Exit\" ||\n        action.buttonName === \"Done\" ||\n        action.buttonName === \"Save\" ||\n        action.buttonName === \"Complete\")\n    ) {\n      onExit({ ...state, history: undefined })\n    } else {\n      dispatchToReducer(action)\n    }\n  }\n\n  return (\n    <SettingsProvider>\n      <MainLayout debug state={state} dispatch={dispatch} />\n    </SettingsProvider>\n  )\n}\n","// @flow\n\nimport React, { Component } from \"react\"\nimport Dialog from \"@material-ui/core/Dialog\"\nimport Button from \"@material-ui/core/Button\"\nimport DialogTitle from \"@material-ui/core/DialogTitle\"\nimport DialogContent from \"@material-ui/core/DialogContent\"\nimport DialogActions from \"@material-ui/core/DialogActions\"\n\nexport default class ErrorBoundaryDialog extends Component {\n  state = { hasError: false, err: \"\" }\n  componentDidCatch(err, info) {\n    this.setState({\n      hasError: true,\n      err: err.toString() + \"\\n\\n\" + info.componentStack\n    })\n  }\n  render() {\n    if (this.state.hasError) {\n      return (\n        <Dialog open={this.state.hasError} onClose={this.props.onClose}>\n          <DialogTitle>Error Loading Annotator</DialogTitle>\n          <DialogContent>\n            <pre>{this.state.err}</pre>\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={this.props.onClose}>Close</Button>\n          </DialogActions>\n        </Dialog>\n      )\n    }\n    return this.props.children\n  }\n}\n","// @flow\nimport React, { useState } from \"react\"\nimport ReactDOM from \"react-dom\"\nimport Editor, { examples } from \"./Editor\"\nimport Annotator from \"../Annotator\"\nimport ErrorBoundaryDialog from \"./ErrorBoundaryDialog.js\"\n\nexport default () => {\n  const [annotatorOpen, changeAnnotatorOpen] = useState(false)\n  const [annotatorProps, changeAnnotatorProps] = useState(examples[\"Custom\"]())\n  const [lastOutput, changeLastOutput] = useState()\n\n  return (\n    <div>\n      {annotatorOpen ? (\n        <ErrorBoundaryDialog\n          onClose={() => {\n            changeAnnotatorOpen(false)\n          }}\n        >\n          <Annotator\n            {...(annotatorProps: any)}\n            onExit={output => {\n              delete (output: any)[\"lastAction\"]\n              changeLastOutput(output)\n              changeAnnotatorOpen(false)\n            }}\n          />\n        </ErrorBoundaryDialog>\n      ) : (\n        <Editor\n          lastOutput={lastOutput}\n          onOpenAnnotator={props => {\n            changeAnnotatorProps(props)\n            changeAnnotatorOpen(true)\n          }}\n        />\n      )}\n    </div>\n  )\n}\n","// @flow\n\nimport React from \"react\"\nimport Button from \"@material-ui/core/Button\"\nimport { styled } from \"@material-ui/core/styles\"\nimport * as colors from \"@material-ui/core/colors\"\nimport Grid from \"@material-ui/core/Grid\"\nimport Markdown from \"react-markdown\"\nimport GitHubButton from \"react-github-btn\"\nimport \"./github-markdown.css\"\nimport raw from \"raw.macro\"\nimport { Prism as SyntaxHighlighter } from \"react-syntax-highlighter\"\nimport { docco } from \"react-syntax-highlighter/dist/cjs/languages/hljs/javascript\"\n\nconst contentMd = raw(\"./content.md\")\n\nconst RootContainer = styled(\"div\")({\n  display: \"flex\",\n  flexDirection: \"column\",\n  alignItems: \"center\"\n})\nconst ContentContainer = styled(\"div\")({\n  width: \"100%\",\n  boxSizing: \"border-box\",\n  display: \"flex\",\n  flexDirection: \"column\",\n  maxWidth: 1200\n})\nconst Header = styled(\"div\")({\n  width: \"100%\",\n  display: \"flex\",\n  justifyContent: \"center\",\n  backgroundColor: colors.blue[600],\n  padding: 8,\n  boxSizing: \"border-box\"\n})\nconst HeaderButton = styled(Button)({\n  color: \"white\",\n  margin: 8,\n  padding: 16,\n  paddingLeft: 24,\n  paddingRight: 24\n})\nconst Hero = styled(\"div\")({\n  display: \"flex\",\n  justifyContent: \"center\",\n  width: \"100%\",\n  backgroundColor: colors.blue[500],\n  padding: 16,\n  color: \"white\",\n  boxSizing: \"border-box\"\n})\nconst HeroMain = styled(\"div\")({\n  fontSize: 48,\n  fontWeight: \"bold\",\n  paddingTop: 64,\n  textShadow: \"0px 1px 5px rgba(0,0,0,0.3)\"\n})\nconst HeroSub = styled(\"div\")({\n  paddingTop: 32,\n  lineHeight: 1.5,\n  fontSize: 24,\n  textShadow: \"0px 1px 3px rgba(0,0,0,0.2)\"\n})\nconst HeroButtons = styled(\"div\")({\n  paddingTop: 32,\n  paddingBottom: 48\n})\nconst Section = styled(\"div\")({\n  display: \"flex\",\n  padding: 16,\n  paddingTop: 32,\n  flexDirection: \"column\"\n})\n\nconst CodeBlock = ({ language, value }) => {\n  return (\n    <SyntaxHighlighter language={language} style={docco}>\n      {value}\n    </SyntaxHighlighter>\n  )\n}\n\nfunction flatten(text, child) {\n  return typeof child === \"string\"\n    ? text + child\n    : React.Children.toArray(child.props.children).reduce(flatten, text)\n}\n\nfunction HeadingRenderer(props) {\n  var children = React.Children.toArray(props.children)\n  var text = children.reduce(flatten, \"\")\n  var slug = text.toLowerCase().replace(/\\W/g, \"-\")\n  return React.createElement(\"h\" + props.level, { id: slug }, props.children)\n}\n\nconst LandingPage = () => {\n  return (\n    <RootContainer>\n      <Header id=\"about\">\n        <ContentContainer style={{ flexDirection: \"row\", flexGrow: 1 }}>\n          <HeaderButton href=\"#features\">Features</HeaderButton>\n          <HeaderButton href=\"#usage\">Usage</HeaderButton>\n          <HeaderButton href=\"#props\">Props</HeaderButton>\n          <HeaderButton href=\"./demo\">Demo Playground</HeaderButton>\n        </ContentContainer>\n      </Header>\n      <Hero>\n        <ContentContainer>\n          <HeroMain>React Image Annotate</HeroMain>\n          <HeroSub>\n            Powerful React component for image annotations with bounding boxes,\n            tagging, classification, multiple images and polygon segmentation.\n          </HeroSub>\n          <HeroButtons>\n            <GitHubButton\n              href=\"https://github.com/waoai/react-image-annotate\"\n              data-size=\"large\"\n              data-show-count=\"true\"\n              aria-label=\"Star waoai/react-image-annotate on GitHub\"\n            >\n              Star\n            </GitHubButton>\n          </HeroButtons>\n        </ContentContainer>\n      </Hero>\n      <ContentContainer className=\"markdown-body\">\n        <Section className=\"markdown-body\">\n          <Markdown\n            escapeHtml={false}\n            source={contentMd}\n            renderers={{\n              code: CodeBlock,\n              heading: HeadingRenderer\n            }}\n          />\n        </Section>\n      </ContentContainer>\n    </RootContainer>\n  )\n}\n\nexport default LandingPage\n","// @flow\n\nimport React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport Theme from \"./Theme\"\nimport DemoSite from \"./DemoSite\"\nimport LandingPage from \"./LandingPage\"\nimport \"./site.css\"\n\nconst Site = () => {\n  const path = window.location.pathname\n    .replace(/\\/$/, \"\")\n    .split(\"/\")\n    .slice(-1)[0]\n  return <Theme>{path === \"demo\" ? <DemoSite /> : <LandingPage />}</Theme>\n}\n\nReactDOM.render(<Site />, document.getElementById(\"root\"))\n"],"sourceRoot":""}
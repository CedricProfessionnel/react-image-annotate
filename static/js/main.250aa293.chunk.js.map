{"version":3,"sources":["Theme/index.js","DemoSite/Editor.js","SidebarBoxContainer/index.js","TaskDescriptionSidebarBox/index.js","ImageSelectorSidebarBox/index.js","RegionSelectorSidebarBox/styles.js","RegionSelectorSidebarBox/index.js","HistorySidebarBox/index.js","DebugSidebarBox/index.js","TagsSidebarBox/index.js","KeyframeTimeline/get-time-string.js","KeyframesSelectorSidebarBox/index.js","Sidebar/index.js","Shortcuts/ShortcutField.js","Crosshairs/index.js","PreventScrollToParents/index.js","hooks/use-window-size.js","ImageCanvas/use-mouse.js","ImageCanvas/use-project-box.js","ImageCanvas/region-tools.js","PointDistances/index.js","RegionLabel/styles.js","RegionLabel/index.js","RegionTags/index.js","colors.js","ImageMask/index.js","HighlightBox/index.js","RegionSelectAndTransformBoxes/index.js","SettingsProvider/index.js","VideoOrImageCanvasBackground/index.js","RegionShapes/index.js","ImageCanvas/index.js","ImageCanvas/styles.js","ImageCanvas/use-wasd-mode.js","hooks/use-exclude-pattern.js","hooks/xpattern.js","HeaderButton/index.js","Header/styles.js","KeyframeTimeline/index.js","Header/index.js","SmallToolButton/index.js","IconTools/index.js","MainLayout/styles.js","SettingsDialog/index.js","Fullscreen/index.js","Annotator/reducers/get-active-image.js","ShortcutsManager/index.js","Annotator/reducers/get-implied-video-regions.js","MainLayout/use-implied-video-regions.js","MainLayout/index.js","Annotator/reducers/combine-reducers.js","Annotator/reducers/history-handler.js","Annotator/reducers/convert-expanding-line-to-polygon.js","Annotator/reducers/general-reducer.js","Annotator/reducers/image-reducer.js","Annotator/reducers/video-reducer.js","Annotator/index.js","DemoSite/ErrorBoundaryDialog.js","DemoSite/index.js","LandingPage/index.js","index.js"],"names":["useStyles","makeStyles","container","fontFamily","theme","createMuiTheme","typography","overrides","MuiButton","root","textTransform","Theme","_ref","children","classes","react_default","a","createElement","ThemeProvider","className","editBar","padding","borderBottom","backgroundColor","display","alignItems","& .button","margin","select","width","fontSize","contentArea","specificationArea","loadSavedInput","JSON","parse","window","localStorage","getItem","e","examples","Simple Bounding Box","taskDescription","regionTagList","regionClsList","enabledTools","images","src","name","Simple Segmentation","Custom","Editor","onOpenAnnotator","lastOutput","c","_useState","useState","_useState2","Object","slicedToArray","currentError","changeCurrentError","_useState3","_useState4","selectedExample","changeSelectedExample","_useState5","_useState6","outputDialogOpen","changeOutputOpen","_useState7","stringify","_useState8","currentJSONValue","changeCurrentJSONValue","style","flexGrow","react_select_browser_esm","value","label","options","keys","map","s","onChange","selectedOption","Button","disabled","onClick","variant","Boolean","border","lib_default","language","code","setItem","toString","height","default_highlight","Dialog","fullScreen","open","DialogTitle","DialogContent","minWidth","DialogActions","header","flexDirection","paddingLeft","paddingRight","title","fontWeight","color","grey","& span","expandButton","& .icon","marginTop","transition","&.expanded","transform","expandedContent","maxHeight","overflowY","&.noScroll","overflow","memo","icon","subTitle","_ref$noScroll","noScroll","_ref$expandedByDefaul","expandedByDefault","content","classnames","expanded","changeExpanded","toggleExpanded","useEventCallback","Paper","IconButton","ExpandMore_default","Collapse","in","prev","next","MarkdownContainer","styled","& h1","& h2","& h3","& h4","& h5","& h6","& p","& a","& img","description","src_SidebarBoxContainer","Description_default","react_markdown_default","source","img","borderRadius","mapUsedImageProps","regions","length","onSelect","concat","Collections_default","List","i","ListItem","button","dense","key","ListItemText","primary","secondary","prevProps","nextProps","isEqual","styles","& .icon2","opacity","&:hover","cursor","row","&.header:hover","&.highlighted","blue","chip","& .color","marginRight","& .text","HeaderSep","borderTop","marginBottom","Chip","text","RowLayout","_ref2","highlighted","order","classification","area","trash","tags","lock","visible","changeMouseOver","onMouseEnter","onMouseLeave","Grid","item","xs","textAlign","MemoRowHeader","RegionSelectorSidebarBox_RowLayout","SwapVert_default","PieChart_default","Delete_default","Lock_default","Visibility_default","MemoRow","_ref3","r","region","onSelectRegion","onDeleteRegion","onChangeRegion","locked","cls","index","RegionSelectorSidebarBox_Chip","objectSpread","LockOpen_default","undefined","VisibilityOff_default","id","mapUsedRegionProperties","_ref4","PictureInPicture_default","assign","emptyText","history","onRestoreHistory","History_default","time","moment","format","ListItemSecondaryAction","Undo_default","DebugSidebarBox","state","lastAction","image","find","selectedImage","filter","mode","selectedImageFrameTime","emptyArr","currentImage","_ref$imageClsList","imageClsList","_ref$imageTagList","imageTagList","onChangeImage","_currentImage$tags","_currentImage$cls","onChangeClassification","o","onChangeTags","selectValue","useMemo","memoImgClsList","asMutable","memoImgTagList","memoCurrentTags","Style_default","placeholder","paddingTop","isMulti","getTimeString","ms","precision","arguments","secs","Number","isInteger","toFixed","mins","KeyframeRow","colors","&.current","& .time","& .regionCount","marginLeft","& .trash","KeyframesSelector","currentVideoTime","keyframes","onChangeVideoTime","onDeleteKeyframe","keyframeTimes","t","parseInt","AddLocation_default","fullWidth","stopPropagation","shortcutKeyFieldWrapper","shortcutKeyText","lineHeight","shortcutTextfield","boxSizing","Sidebar","debug","labelImages","onSelectImage","onShortcutActionDispatched","src_DebugSidebarBox","src_TaskDescriptionSidebarBox","src_TagsSidebarBox","src_ImageSelectorSidebarBox","src_RegionSelectorSidebarBox","KeyframesSelectorSidebarBox","src_HistorySidebarBox","Crosshairs","mousePosition","x","y","changeForceRenderState","current","useEffect","interval","setInterval","clearInterval","react","position","zIndex","left","pointerEvents","top","Container","& > div","PreventScrollToParents","otherProps","objectWithoutProperties","mouseOver","onMouseMove","setTimeout","Combination","enabled","removeScrollBar","useWindowSize","initialWidth","Infinity","initialHeight","isClient","_useRafState","useRafState","innerWidth","innerHeight","_useRafState2","setState","handler","addEventListener","removeEventListener","useInterval","use_mouse","canvasEl","changeMat","changeDragging","zoomStart","changeZoomStart","zoomEnd","changeZoomEnd","layoutParams","zoomWithPrimary","dragWithPrimary","mat","onMouseUp","onMouseDown","dragging","useRef","prevMousePosition","zoomIn","direction","point","mx","my","scale","to","translate","scaleU","clone","mouseEvents","_canvasEl$current$get","getBoundingClientRect","clientX","clientY","projMouse","applyToPoint","_layoutParams$current","iw","ih","preventDefault","specialEvent","type","_layoutParams$current2","Math","abs","_layoutParams$current3","min","newMat","Matrix","from","_layoutParams$current4","onWheel","deltaY","use_project_box","bbox","box","apply","toConsumableArray","points","w","h","max","_ref5","_ref6","_ref7","_ref8","_ref9","_ref10","_ref11","_ref12","Error","getEnclosingBox","cbox","inverse","d","Svg","& text","fill","& path","vectorEffect","strokeWidth","stroke","strokeDasharray","animationDuration","animationTimingFunction","animationIterationCount","animationPlayState","PointDistances","projectRegionBox","pointDistancePrecision","realSize","r1","flatMap","i1","r2","i2","displayDistance","pr1","pr2","prm","unitName","sqrt","pow","RegionLabel_styles","regionInfo","& .name","& .circle","boxShadow","& .tags","& .tag","textDecoration","editing","allowedClasses","allowedTags","onDelete","onClose","onOpen","onRegionClassAdded","textShadow","tabIndex","size","dist_react_select_browser_esm","actionMeta","action","newTags","Check_default","RegionTags","onBeginRegionEdit","onCloseRegionEdit","imageSrc","RegionEditLabel","RegionLabel","DefaultRegionLabel","pbox","labelBoxHeight","editingLabels","displayOnTop","coords","bottom","paddingBottom","obj","newObj","_len","args","Array","_key","_i","_args","copyWithout","muiColors","colorInts","rrggbb","bbggrr","replace","substr","reverseParseColor","ImageMask","imagePosition","_ref$zIndex","_ref$hide","hide","_ref$autoSegmentation","autoSegmentationOptions","mmgc","MMGC_INIT","canvasRef","setCanvasRef","superPixelsGenerated","sampleImageData","setSampleImageData","canvas","document","ctx","getContext","Image","crossOrigin","onload","naturalWidth","naturalHeight","drawImage","imageData","getImageData","useDebounce","cp","setImageSize","context","setSimpleMode","setMaxClusters","setClassColor","imageAddress","getImageAddr","HEAPU8","set","data","computeSuperPixels","includes","toLowerCase","clearClassElements","_step","_iterator","_createForOfIteratorHelper","n","done","classPoint","clsIndex","indexOf","console","log","addClassPoint","floor","err","f","_step2","_iterator2","_loop","_step3","polygon","pi","addPolygon","_iterator3","p","p1","p2","ri1","round","ci1","ri2","ci2","addLineToPolygon","computeMasks","maskAddress","getColoredMask","cppImDataUint8","Uint8ClampedArray","buffer","maskImageData","ImageData","clearRect","putImageData","bottomRight","topLeft","imageRendering","isNaN","ref","@keyframes borderDance","strokeDashoffset","highlightBox","&:not(.highlighted)","&:not(.highlighted):hover","animationName","HighlightBox","createWithPrimary","onBeginMovePoint","unfinished","styleCoords","pathD","TransformGrabber","boxCursorMap","RegionSelectAndTransformBox","fullImageSegmentationMode","onBeginBoxTransform","onBeginMovePolygonPoint","onAddPolygonPoint","showHighlightBox","src_PreventScrollToParents","src_HighlightBox","px","py","proj","pa","RegionSelectAndTransformBoxes","props","SettingsContext","createContext","showCrosshairs","wasdMode","useSettings","useContext","SettingsProvider","settings","startsWith","pullSettingsFromLocalStorage","changeState","Provider","changeSetting","setting","defineProperty","Video","StyledImage","VideoOrImageCanvasBackground","videoTime","videoSrc","onLoad","videoPlaying","onChangeVideoPlaying","videoRef","imageRef","currentTime","renderLoopRunning","play","videoPlaybackSpeed","playbackRate","parseFloat","pause","checkForNewFrame","newVideoTime","paused","requestAnimationFrame","onLoadedVideoMetadata","event","videoElm","currentTarget","videoWidth","videoHeight","duration","onImageLoaded","imageElm","stylePosition","onLoadedMetadata","clamp","num","RegionComponents","colorAlpha","Component","fullSegmentationMode","join","expanding-line","_region$expandingWidt","expandingWidth","slice","pointPairs","angle","atan2","PI","dx","sin","dy","cos","firstSection","secondSection","reverse","lastPoint","Fragment","candidatePoint","pixel","WrappedRegionList","_ref13","regionId","fullgeSegmentationMode","RegionShapes","_ref14","_ref14$regions","zoomIndicator","right","fixedRegionLabel","ImageCanvas","showTags","_ref$onMouseMove","_ref$onMouseDown","_ref$onMouseUp","_ref$dragWithPrimary","_ref$zoomWithPrimary","_ref$createWithPrimar","_ref$pointDistancePre","_ref$showHighlightBox","showPointDistances","allowedArea","_ref$RegionEditLabel","_ref$videoPlaying","_ref$showMask","showMask","onImageOrVideoLoaded","_useRafState3","_useRafState4","_useRafState5","_useRafState6","_useRafState7","_useRafState8","_useRafState9","_useRafState10","windowSize","getLatestMat","dirs","keysDown","keyDownListener","keyUpListener","somethingChanged","_newMat","useWasdMode","_useMouse","useMouse","useLayoutEffect","useProjectRegionBox","imageDimensions","changeImageDimensions","imageLoaded","onVideoOrImageLoaded","dims","excludePattern","pattern","createPattern","useExcludePattern","clientWidth","clientHeight","fitScale","canvasWidth","canvasHeight","save","toArray","globalAlpha","outer","inner","moveTo","forEach","lineTo","closePath","fillStyle","restore","zoomBox","highlightedRegion","highlightedRegions","src_Crosshairs","src_RegionSelectAndTransformBoxes","src_RegionTags","src_RegionLabel","disableClose","src_PointDistances","src_ImageMask","src_RegionShapes","StyledButton","IconName","HeaderButtonContext","MemoizedHeaderButton","Icon","HeaderButton","onHeaderButtonClick","Header_styles","flexShrink","fileInfo","&.videoMode","flexMode","Tick","TickText","userSelect","PositionCursor","placeItems","fontVariantNumeric","&::before","borderLeft","borderRight","KeyframeMarker","_styled","borderTopLeftRadius","borderTopRightRadius","displayIntervalPairs","KeyframeTimeline","_ref4$currentTime","onChangeCurrentTime","_useMeasure","useMeasure","_useMeasure2","bounds","instantCurrentTime","changeInstantCurrentTime","draggingTime","changeDraggingTime","sort","b","_useMemo","KeyframeTimeline_createForOfIteratorHelper","minor","major","getMajorInterval","_useMemo2","minorInterval","majorInterval","newTime","KeyframeTimeline_Container","range","kt","Header","inFullScreen","videoMode","_ref$nextVideoFrameHa","isAVideoFrame","nextVideoFrameHasRegions","videoDuration","multipleImages","alwaysShowPrevButton","alwaysShowNextButton","headerActions","src_HeaderButton","BackIcon","NextIcon","QueuePlayNextIcon","PauseIcon","PlayIcon","SettingsIcon","FullscreenIcon","ExitIcon","SelectedTool","selected","togglable","_ref$alwaysShowing","alwaysShowing","_useContext","selectedTool","onClickTool","Tooltip","placement","aria-label","iconTools","grow","defaultTools","IconTools","_ref$enabledTools","selectedToolContextValue","src_SmallToolButton","index_es","fixedWidth","faMousePointer","faHandPaper","faSearch","faTag","faCrosshairs","faVectorSquare","faDrawPolygon","faGripLines","faMask","MainLayout_styles","&.fullscreen","workspace","iconToolsContainer","imageCanvasContainer","justifyContent","noImageSelected","sidebarContainer","SettingsDialog","Survey_default","noActions","defaultAnswers","onQuestionChange","q","answers","form","questions","defaultValue","choices","Fullscreen","react_full_screen_dist_default","get_active_image","pathToActiveImage","activeImage","currentImageIndex","annotationType","findIndex","frameTime","getIn","get_implied_video_regions","nextKeyframeTimeIndex","t1","prevKeyframe","t2","nextKeyframe","prevRegionMap","nextRegionMap","get_implied_video_regions_createForOfIteratorHelper","impliedRegions","w1","w2","push","pp","defaultKeyMap","ShortcutsManager_i","_defaultHotkeys","binding","ShortcutsManager_ref2","useDispatchHotkeyHandlers","dispatch","select_tool","zoom_tool","create_point","create_bounding_box","pan_tool","create_polygon","create_pixel","save_and_previous_sample","buttonName","save_and_next_sample","save_and_exit_sample","HotkeyDiv","withHotKeys","hotKeys","divRef","MainLayout","_Object$assign","nextImage","_ref2$alwaysShowNextB","_ref2$alwaysShowPrevB","memoizedActionFns","params","fnKey","fn","_len2","_key2","reduce","acc","_getActiveImage","getActiveImage","useKey","detectKeys","innerContainerRef","hotkeyHandlers","impliedVideoRegions","_state$currentVideoTi","getImpliedVideoRegions","useImpliedVideoRegions","refocusOnMouseEvent","useCallback","contains","activeElement","target","focus","src_Fullscreen","onMouseOver","allowChanges","handlers","headerContainer","src_Header","videoName","src_IconTools","src_ImageCanvas","src_Sidebar","$ANNOTATE_DEBUG_MODE","src_SettingsDialog","settingsOpen","typesToSaveWithHistory","BEGIN_BOX_TRANSFORM","BEGIN_MOVE_POINT","DELETE_REGION","saveToHistory","updateIn","toDate","without","convert_expanding_line_to_polygon","expandingLine","newPoints","getRandomId","random","split","general_reducer","oldRegionClsList","Date","now","lastMouseMoveCall","setIn","getRegionIndex","regionIndex","getRegion","modifyRegion","_getRegion","_getRegion2","closeEditors","setNewImage","oldRegion","delta","_Object$keys","directions","freedom","original","pointIndex","splice","mouseDownAt","_state$mode","moveRegion","_state$mode2","_state$mode2$freedom","xFree","yFree","_state$mode2$original","ox","oy","ow","oh","dw","dh","_getRegion3","_getRegion4","_getRegion5","_getRegion6","mouseDistFromLastPoint","_getRegion7","_getRegion8","newRegion","aa","_getRegion9","_getRegion10","_getRegion11","_getRegion12","convertExpandingLineToPolygon","_getRegion13","_getRegion14","defaultRegionCls","defaultRegionColor","editLabelEditorAfter","isNew","_state3$mouseDownAt","_getRegion15","_getRegion16","newExpandingLine","newRegions","some","image_reducer","metadata","video_reducer","copyImpliedRegions","isPlaying","Annotator","_ref$selectedImage","_ref$showTags","_ref$selectedTool","_ref$regionTagList","_ref$regionClsList","_ref$keyframes","_ref$fullImageSegment","_ref$videoTime","onExit","onNextImage","onPrevImage","reducer","_useReducer","useReducer","reducers","combine_reducers_createForOfIteratorHelper","combineReducers","imageReducer","videoReducer","generalReducer","prevState","nextState","makeImmutable","_useReducer2","dispatchToReducer","src_SettingsProvider","src_MainLayout","ErrorBoundaryDialog","hasError","info","this","componentStack","DemoSite","annotatorOpen","changeAnnotatorOpen","annotatorProps","changeAnnotatorProps","changeLastOutput","ErrorBoundaryDialog_ErrorBoundaryDialog","src_Annotator","output","DemoSite_Editor","RootContainer","ContentContainer","maxWidth","Hero","HeroMain","HeroSub","HeroButtons","Section","CodeBlock","prism","docco","flatten","child","React","Children","HeadingRenderer","slug","level","LandingPage","LandingPage_Header","LandingPage_HeaderButton","href","react_github_btn","data-size","data-show-count","escapeHtml","renderers","heading","Site","path","location","pathname","src_Theme","src_LandingPage","ReactDOM","render","src_Site","getElementById"],"mappings":"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","file":"static/js/main.250aa293.chunk.js","sourcesContent":["// @flow\n\nimport React from \"react\"\nimport {\n  ThemeProvider,\n  createMuiTheme,\n  makeStyles,\n} from \"@material-ui/core/styles\"\n\nconst useStyles = makeStyles({\n  container: {\n    fontFamily: '\"Inter\", sans-serif',\n  },\n})\n\nconst theme = createMuiTheme({\n  typography: {\n    fontFamily: '\"Inter\", \"Roboto\", sans-serif',\n  },\n  overrides: {\n    MuiButton: {\n      root: {\n        textTransform: \"none\",\n      },\n    },\n  },\n})\n\nexport const Theme = ({ children }: any) => {\n  const classes = useStyles()\n  return (\n    <ThemeProvider theme={theme}>\n      <div className={classes.container}>{children}</div>\n    </ThemeProvider>\n  )\n}\n\nexport default Theme\n","// @flow\n\nimport React, { useState } from \"react\"\nimport Button from \"@material-ui/core/Button\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport Select from \"react-select\"\nimport Code from \"react-syntax-highlighter\"\nimport Dialog from \"@material-ui/core/Dialog\"\nimport DialogTitle from \"@material-ui/core/DialogTitle\"\nimport DialogContent from \"@material-ui/core/DialogContent\"\nimport DialogActions from \"@material-ui/core/DialogActions\"\nimport MonacoEditor from \"react-monaco-editor\"\n\nconst useStyles = makeStyles({\n  editBar: {\n    padding: 10,\n    borderBottom: \"1px solid #ccc\",\n    backgroundColor: \"#f8f8f8\",\n    display: \"flex\",\n    alignItems: \"center\",\n    \"& .button\": { margin: 5 },\n  },\n  select: { width: 240, fontSize: 14 },\n  contentArea: {\n    padding: 10,\n  },\n  specificationArea: {\n    padding: 10,\n  },\n})\n\nconst loadSavedInput = () => {\n  try {\n    return JSON.parse(window.localStorage.getItem(\"customInput\") || \"{}\")\n  } catch (e) {\n    return {}\n  }\n}\n\nexport const examples = {\n  \"Simple Bounding Box\": () => ({\n    taskDescription:\n      \"Annotate each image according to this _markdown_ specification.\",\n    // regionTagList: [],\n    // regionClsList: [\"hotdog\"],\n    regionTagList: [\"has-bun\"],\n    regionClsList: [\"hotdog\", \"not-hotdog\"],\n    enabledTools: [\"select\", \"create-box\"],\n    // showTags: true,\n    images: [\n      {\n        src:\n          \"https://images.unsplash.com/photo-1496905583330-eb54c7e5915a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=634&q=80\",\n        name: \"hot-dogs-1\",\n      },\n      {\n        src:\n          \"https://www.bianchi.com/wp-content/uploads/2019/07/YPB17I555K.jpg\",\n        name: \"bianchi-oltre-xr4\",\n      },\n    ],\n  }),\n  \"Simple Segmentation\": () => ({\n    taskDescription:\n      \"Annotate each image according to this _markdown_ specification.\",\n    regionClsList: [\"car\", \"truck\"],\n    enabledTools: [\"select\", \"create-polygon\"],\n    images: [\n      {\n        src:\n          \"https://images.unsplash.com/photo-1561518776-e76a5e48f731?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=750&q=80\",\n        name: \"car-image-1\",\n      },\n    ],\n  }),\n  Custom: () => loadSavedInput(),\n}\n\nconst Editor = ({ onOpenAnnotator, lastOutput }: any) => {\n  const c = useStyles()\n  const [currentError, changeCurrentError] = useState()\n  const [selectedExample, changeSelectedExample] = useState(\n    window.localStorage.getItem(\"customInput\")\n      ? \"Custom\"\n      : \"Simple Bounding Box\"\n  )\n  const [outputDialogOpen, changeOutputOpen] = useState(false)\n  const [currentJSONValue, changeCurrentJSONValue] = useState(\n    JSON.stringify(examples[selectedExample](), null, \"  \")\n  )\n  return (\n    <div>\n      <div className={c.editBar}>\n        <h3>React Image Annotate</h3>\n        <div style={{ flexGrow: 1 }} />\n        <div>\n          <div style={{ display: \"inline-flex\" }}>\n            <Select\n              className={c.select}\n              value={{ label: selectedExample, value: selectedExample }}\n              options={Object.keys(examples).map((s) => ({\n                label: s,\n                value: s,\n              }))}\n              onChange={(selectedOption) => {\n                changeSelectedExample(selectedOption.value)\n\n                changeCurrentJSONValue(\n                  JSON.stringify(\n                    selectedOption.value === \"Custom\"\n                      ? loadSavedInput()\n                      : examples[selectedOption.value](),\n                    null,\n                    \"  \"\n                  )\n                )\n              }}\n            />\n          </div>\n          <Button\n            className=\"button\"\n            disabled={!lastOutput}\n            onClick={() => changeOutputOpen(true)}\n          >\n            View Output\n          </Button>\n          <Button\n            className=\"button\"\n            variant=\"outlined\"\n            disabled={Boolean(currentError)}\n            onClick={() => {\n              onOpenAnnotator(\n                selectedExample === \"Custom\"\n                  ? loadSavedInput()\n                  : examples[selectedExample]\n              )\n            }}\n          >\n            Open Annotator\n          </Button>\n        </div>\n      </div>\n      <div\n        className={c.contentArea}\n        style={\n          currentError\n            ? { border: \"2px solid #f00\" }\n            : { border: \"2px solid #fff\" }\n        }\n      >\n        <div>\n          <MonacoEditor\n            value={currentJSONValue}\n            language=\"javascript\"\n            onChange={(code) => {\n              try {\n                window.localStorage.setItem(\n                  \"customInput\",\n                  JSON.stringify(JSON.parse(code))\n                )\n                changeCurrentError(null)\n              } catch (e) {\n                changeCurrentError(e.toString())\n              }\n              changeCurrentJSONValue(code)\n            }}\n            width=\"100%\"\n            height=\"550px\"\n          />\n        </div>\n      </div>\n      <div className={c.specificationArea}>\n        <h2>React Image Annotate Format</h2>\n        <Code language=\"javascript\">{`\n{\n  taskDescription?: string, // markdown\n  regionTagList?: Array<string>,\n  regionClsList?: Array<string>,\n  imageTagList?: Array<string>,\n  imageClsList?: Array<string>,\n  // all tools are enabled by default\n  enabledTools?: Array< \"select\" | \"create-point\" | \"create-box\" | \"create-polygon\">,\n  selectedImage?: string, // initial selected image\n  images: Array<{\n    src: string,\n    thumbnailSrc?: string, // use this if you are using high-res images\n    name: string,\n    regions?: Array<{\n      id: string | number,\n      cls?: string,\n      color?: string,\n      tags?: Array<string>,\n\n      // Point\n      type: \"point\",\n      x: number, // [0-1] % of image width\n      y: number, // [0-1] % of image height\n\n      // Bounding Box\n      type: \"box\",\n      x: number, // [0-1] % of image width\n      y: number, // [0-1] % of image height\n      w: number, // [0-1] % of image width\n      h: number, // [0-1] % of image height\n\n      // Polygon\n      type: \"polygon\",\n      open?: boolean, // should last and first points be connected, default: true\n      points: Array<[number, number]> // [0-1] % of image width/height\n    }>\n  }>,\n}\n`}</Code>\n      </div>\n      <Dialog fullScreen open={outputDialogOpen}>\n        <DialogTitle>React Image Annotate Output</DialogTitle>\n        <DialogContent style={{ minWidth: 400 }}>\n          <MonacoEditor\n            value={JSON.stringify(lastOutput, null, \"  \")}\n            language=\"javascript\"\n            width=\"100%\"\n            height=\"550px\"\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => changeOutputOpen(false)}>Close</Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  )\n}\n\nexport default Editor\n","// @flow\n\nimport React, { useState, memo } from \"react\"\nimport Paper from \"@material-ui/core/Paper\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport ExpandIcon from \"@material-ui/icons/ExpandMore\"\nimport IconButton from \"@material-ui/core/IconButton\"\nimport Collapse from \"@material-ui/core/Collapse\"\nimport { grey } from \"@material-ui/core/colors\"\nimport classnames from \"classnames\"\nimport useEventCallback from \"use-event-callback\"\n\nconst useStyles = makeStyles({\n  container: { margin: 8 },\n  header: {\n    display: \"flex\",\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: 8,\n    paddingLeft: 16,\n    paddingRight: 16,\n  },\n  title: {\n    fontSize: 14,\n    fontWeight: \"bold\",\n    flexGrow: 1,\n    paddingLeft: 8,\n    color: grey[800],\n    \"& span\": {\n      color: grey[600],\n      fontSize: 12,\n    },\n  },\n  expandButton: {\n    padding: 0,\n    width: 30,\n    height: 30,\n    \"& .icon\": {\n      marginTop: -6,\n      width: 20,\n      height: 20,\n      transition: \"500ms transform\",\n      \"&.expanded\": {\n        transform: \"rotate(180deg)\",\n      },\n    },\n  },\n  expandedContent: {\n    maxHeight: 300,\n    overflowY: \"auto\",\n    \"&.noScroll\": {\n      overflowY: \"visible\",\n      overflow: \"visible\",\n    },\n  },\n})\n\nexport const SidebarBoxContainer = ({\n  icon,\n  title,\n  subTitle,\n  children,\n  noScroll = false,\n  expandedByDefault = false,\n}) => {\n  const classes = useStyles()\n  const content = (\n    <div\n      className={classnames(classes.expandedContent, noScroll && \"noScroll\")}\n    >\n      {children}\n    </div>\n  )\n\n  const [expanded, changeExpanded] = useState(expandedByDefault)\n  const toggleExpanded = useEventCallback(() => changeExpanded(!expanded))\n  return (\n    <Paper className={classes.container}>\n      <div className={classes.header}>\n        {icon}\n        <div className={classes.title}>\n          {title} <span>{subTitle}</span>\n        </div>\n        <IconButton onClick={toggleExpanded} className={classes.expandButton}>\n          <ExpandIcon className={classnames(\"icon\", expanded && \"expanded\")} />\n        </IconButton>\n      </div>\n      {noScroll ? (\n        expanded ? (\n          content\n        ) : null\n      ) : (\n        <Collapse in={expanded}>{content}</Collapse>\n      )}\n    </Paper>\n  )\n}\n\nexport default memo(\n  SidebarBoxContainer,\n  (prev, next) => prev.title === next.title && prev.children === next.children\n)\n","// @flow\n\nimport React, { memo } from \"react\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport DescriptionIcon from \"@material-ui/icons/Description\"\nimport { styled } from \"@material-ui/core/styles\"\nimport { grey } from \"@material-ui/core/colors\"\nimport Markdown from \"react-markdown\"\n\nconst MarkdownContainer = styled(\"div\")({\n  paddingLeft: 16,\n  paddingRight: 16,\n  fontSize: 12,\n  \"& h1\": { fontSize: 18 },\n  \"& h2\": { fontSize: 14 },\n  \"& h3\": { fontSize: 12 },\n  \"& h4\": { fontSize: 12 },\n  \"& h5\": { fontSize: 12 },\n  \"& h6\": { fontSize: 12 },\n  \"& p\": { fontSize: 12 },\n  \"& a\": {},\n  \"& img\": { width: \"100%\" },\n})\n\nexport const TaskDescriptionSidebarBox = ({ description }) => {\n  return (\n    <SidebarBoxContainer\n      title=\"Task Description\"\n      icon={<DescriptionIcon style={{ color: grey[700] }} />}\n      expandedByDefault={description && description !== \"\" ? false : true}\n    >\n      <MarkdownContainer>\n        <Markdown source={description} />\n      </MarkdownContainer>\n    </SidebarBoxContainer>\n  )\n}\n\nexport default memo(TaskDescriptionSidebarBox)\n","// @flow\n\nimport React, { memo } from \"react\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport CollectionsIcon from \"@material-ui/icons/Collections\"\nimport { grey } from \"@material-ui/core/colors\"\nimport List from \"@material-ui/core/List\"\nimport ListItem from \"@material-ui/core/ListItem\"\nimport ListItemText from \"@material-ui/core/ListItemText\"\nimport Avatar from \"@material-ui/core/Avatar\"\nimport isEqual from \"lodash/isEqual\"\n\nconst useStyles = makeStyles({\n  img: { width: 40, height: 40, borderRadius: 8 },\n})\n\nexport const ImageSelectorSidebarBox = ({ images, onSelect }) => {\n  const classes = useStyles()\n  return (\n    <SidebarBoxContainer\n      title=\"Images\"\n      subTitle={`(${images.length})`}\n      icon={<CollectionsIcon style={{ color: grey[700] }} />}\n    >\n      <div>\n        <List>\n          {images.map((img, i) => (\n            <ListItem button onClick={() => onSelect(img)} dense key={i}>\n              <img className={classes.img} src={img.src} />\n              <ListItemText\n                primary={img.name}\n                secondary={`${(img.regions || []).length} Labels`}\n              />\n            </ListItem>\n          ))}\n        </List>\n      </div>\n    </SidebarBoxContainer>\n  )\n}\n\nconst mapUsedImageProps = (a) => [a.name, (a.regions || []).length, a.src]\n\nexport default memo(ImageSelectorSidebarBox, (prevProps, nextProps) =>\n  isEqual(\n    prevProps.images.map(mapUsedImageProps),\n    nextProps.images.map(mapUsedImageProps)\n  )\n)\n","import { grey, blue, orange, purple } from \"@material-ui/core/colors\"\n\nexport default {\n  container: {\n    fontSize: 11,\n    fontWeight: \"bold\",\n    color: grey[700],\n    \"& .icon\": {\n      marginTop: 4,\n      width: 16,\n      height: 16,\n    },\n    \"& .icon2\": {\n      opacity: 0.5,\n      width: 16,\n      height: 16,\n      transition: \"200ms opacity\",\n      \"&:hover\": {\n        cursor: \"pointer\",\n        opacity: 1,\n      },\n    },\n  },\n  row: {\n    padding: 4,\n    cursor: \"pointer\",\n    \"&.header:hover\": {\n      backgroundColor: \"#fff\",\n    },\n    \"&.highlighted\": {\n      backgroundColor: blue[100],\n    },\n    \"&:hover\": {\n      backgroundColor: blue[50],\n      color: grey[800],\n    },\n  },\n  chip: {\n    display: \"flex\",\n    flexDirection: \"row\",\n    padding: 2,\n    borderRadius: 2,\n    paddingLeft: 4,\n    paddingRight: 4,\n    alignItems: \"center\",\n    \"& .color\": {\n      borderRadius: 5,\n      width: 10,\n      height: 10,\n      marginRight: 4,\n    },\n    \"& .text\": {},\n  },\n}\n","// @flow\n\nimport React, { Fragment, useState, memo } from \"react\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport { makeStyles, styled } from \"@material-ui/core/styles\"\nimport { grey } from \"@material-ui/core/colors\"\nimport RegionIcon from \"@material-ui/icons/PictureInPicture\"\nimport Grid from \"@material-ui/core/Grid\"\nimport ReorderIcon from \"@material-ui/icons/SwapVert\"\nimport PieChartIcon from \"@material-ui/icons/PieChart\"\nimport TrashIcon from \"@material-ui/icons/Delete\"\nimport LockIcon from \"@material-ui/icons/Lock\"\nimport UnlockIcon from \"@material-ui/icons/LockOpen\"\nimport VisibleIcon from \"@material-ui/icons/Visibility\"\nimport VisibleOffIcon from \"@material-ui/icons/VisibilityOff\"\nimport styles from \"./styles\"\nimport classnames from \"classnames\"\nimport isEqual from \"lodash/isEqual\"\n\nconst useStyles = makeStyles(styles)\n\nconst HeaderSep = styled(\"div\")({\n  borderTop: `1px solid ${grey[200]}`,\n  marginTop: 2,\n  marginBottom: 2,\n})\n\nconst Chip = ({ color, text }) => {\n  const classes = useStyles()\n  return (\n    <span className={classes.chip}>\n      <div className=\"color\" style={{ backgroundColor: color }} />\n      <div className=\"text\">{text}</div>\n    </span>\n  )\n}\n\nconst RowLayout = ({\n  header,\n  highlighted,\n  order,\n  classification,\n  area,\n  tags,\n  trash,\n  lock,\n  visible,\n  onClick,\n}) => {\n  const classes = useStyles()\n  const [mouseOver, changeMouseOver] = useState(false)\n  return (\n    <div\n      onClick={onClick}\n      onMouseEnter={() => changeMouseOver(true)}\n      onMouseLeave={() => changeMouseOver(false)}\n      className={classnames(classes.row, { header, highlighted })}\n    >\n      <Grid container alignItems=\"center\">\n        <Grid item xs={2}>\n          <div style={{ textAlign: \"right\", paddingRight: 10 }}>{order}</div>\n        </Grid>\n        <Grid item xs={5}>\n          {classification}\n        </Grid>\n        <Grid item xs={2}>\n          <div style={{ textAlign: \"right\", paddingRight: 6 }}>{area}</div>\n        </Grid>\n        <Grid item xs={1}>\n          {trash}\n        </Grid>\n        <Grid item xs={1}>\n          {lock}\n        </Grid>\n        <Grid item xs={1}>\n          {visible}\n        </Grid>\n      </Grid>\n    </div>\n  )\n}\n\nconst RowHeader = () => {\n  return (\n    <RowLayout\n      header\n      highlighted={false}\n      order={<ReorderIcon className=\"icon\" />}\n      classification={<div style={{ paddingLeft: 10 }}>Class</div>}\n      area={<PieChartIcon className=\"icon\" />}\n      trash={<TrashIcon className=\"icon\" />}\n      lock={<LockIcon className=\"icon\" />}\n      visible={<VisibleIcon className=\"icon\" />}\n    />\n  )\n}\n\nconst MemoRowHeader = memo(RowHeader)\n\nconst Row = ({\n  region: r,\n  highlighted,\n  onSelectRegion,\n  onDeleteRegion,\n  onChangeRegion,\n  visible,\n  locked,\n  color,\n  cls,\n  index,\n}) => {\n  return (\n    <RowLayout\n      header={false}\n      highlighted={highlighted}\n      onClick={() => onSelectRegion(r)}\n      order={`#${index + 1}`}\n      classification={<Chip text={cls || \"\"} color={color || \"#ddd\"} />}\n      area=\"\"\n      trash={<TrashIcon onClick={() => onDeleteRegion(r)} className=\"icon2\" />}\n      lock={\n        r.locked ? (\n          <LockIcon\n            onClick={() => onChangeRegion({ ...r, locked: false })}\n            className=\"icon2\"\n          />\n        ) : (\n          <UnlockIcon\n            onClick={() => onChangeRegion({ ...r, locked: true })}\n            className=\"icon2\"\n          />\n        )\n      }\n      visible={\n        r.visible || r.visible === undefined ? (\n          <VisibleIcon\n            onClick={() => onChangeRegion({ ...r, visible: false })}\n            className=\"icon2\"\n          />\n        ) : (\n          <VisibleOffIcon\n            onClick={() => onChangeRegion({ ...r, visible: true })}\n            className=\"icon2\"\n          />\n        )\n      }\n    />\n  )\n}\n\nconst MemoRow = memo(\n  Row,\n  (prevProps, nextProps) =>\n    prevProps.highlighted === nextProps.highlighted &&\n    prevProps.visible === nextProps.visible &&\n    prevProps.locked === nextProps.locked &&\n    prevProps.id === nextProps.id &&\n    prevProps.index === nextProps.index &&\n    prevProps.cls === nextProps.cls &&\n    prevProps.color === nextProps.color\n)\n\nexport const RegionSelectorSidebarBox = ({\n  regions,\n  onDeleteRegion,\n  onChangeRegion,\n  onSelectRegion,\n}) => {\n  const classes = useStyles()\n  return (\n    <SidebarBoxContainer\n      title=\"Regions\"\n      subTitle=\"\"\n      icon={<RegionIcon style={{ color: grey[700] }} />}\n      expandedByDefault\n    >\n      <div className={classes.container}>\n        <MemoRowHeader />\n        <HeaderSep />\n        {regions.map((r, i) => (\n          <MemoRow\n            key={r.id}\n            {...r}\n            region={r}\n            index={i}\n            onSelectRegion={onSelectRegion}\n            onDeleteRegion={onDeleteRegion}\n            onChangeRegion={onChangeRegion}\n          />\n        ))}\n      </div>\n    </SidebarBoxContainer>\n  )\n}\n\nconst mapUsedRegionProperties = (r) => [\n  r.id,\n  r.color,\n  r.locked,\n  r.visible,\n  r.highlighted,\n]\n\nexport default memo(RegionSelectorSidebarBox, (prevProps, nextProps) =>\n  isEqual(\n    prevProps.regions.map(mapUsedRegionProperties),\n    nextProps.regions.map(mapUsedRegionProperties)\n  )\n)\n","// @flow\n\nimport React, { setState, memo } from \"react\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport HistoryIcon from \"@material-ui/icons/History\"\nimport List from \"@material-ui/core/List\"\nimport ListItem from \"@material-ui/core/ListItem\"\nimport ListItemText from \"@material-ui/core/ListItemText\"\nimport IconButton from \"@material-ui/core/IconButton\"\nimport ListItemSecondaryAction from \"@material-ui/core/ListItemSecondaryAction\"\nimport UndoIcon from \"@material-ui/icons/Undo\"\nimport moment from \"moment\"\nimport { grey } from \"@material-ui/core/colors\"\nimport isEqual from \"lodash/isEqual\"\n\nconst useStyles = makeStyles({\n  emptyText: {\n    fontSize: 14,\n    fontWeight: \"bold\",\n    color: grey[500],\n    textAlign: \"center\",\n    padding: 20,\n  },\n})\n\nexport const HistorySidebarBox = ({\n  history,\n  onRestoreHistory,\n}: {\n  history: Array<{ name: string, time: Date }>,\n}) => {\n  const classes = useStyles()\n\n  return (\n    <SidebarBoxContainer\n      title=\"History\"\n      icon={<HistoryIcon style={{ color: grey[700] }} />}\n      expandedByDefault\n    >\n      <List>\n        {history.length === 0 && (\n          <div className={classes.emptyText}>No History Yet</div>\n        )}\n        {history.map(({ name, time }, i) => (\n          <ListItem button dense key={i}>\n            <ListItemText\n              primary={name}\n              secondary={moment(time).format(\"LT\")}\n            />\n            {i === 0 && (\n              <ListItemSecondaryAction onClick={() => onRestoreHistory()}>\n                <IconButton>\n                  <UndoIcon />\n                </IconButton>\n              </ListItemSecondaryAction>\n            )}\n          </ListItem>\n        ))}\n      </List>\n    </SidebarBoxContainer>\n  )\n}\n\nexport default memo(HistorySidebarBox, (prevProps, nextProps) =>\n  isEqual(\n    prevProps.history.map((a) => [a.name, a.time]),\n    nextProps.history.map((a) => [a.name, a.time])\n  )\n)\n","// @flow\n\nimport React from \"react\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\n\nexport const DebugSidebarBox = ({ state, lastAction }: any) => {\n  const image = (state.images || []).find(\n    (img) => img.src === state.selectedImage\n  )\n  const region = image\n    ? (image.regions || []).filter((r) => r.highlighted)\n    : null\n\n  return (\n    <SidebarBoxContainer title=\"Debug\" icon={<span />} expandedByDefault>\n      <div style={{ padding: 4 }}>\n        <div>\n          <b>region</b>:\n        </div>\n        <pre>{JSON.stringify(region, null, \"  \")}</pre>\n        <div>\n          <b>lastAction</b>:\n        </div>\n        <pre>{JSON.stringify(lastAction, null, \"  \")}</pre>\n        <div>\n          <b>mode</b>:\n        </div>\n        <pre>{JSON.stringify(state.mode, null, \"  \")}</pre>\n        <div>\n          <b>frame:</b>\n        </div>\n        <pre>{JSON.stringify(state.selectedImageFrameTime, null, \"  \")}</pre>\n      </div>\n    </SidebarBoxContainer>\n  )\n}\n\nexport default DebugSidebarBox\n","// @flow\n\nimport React, { useMemo, memo } from \"react\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport StyleIcon from \"@material-ui/icons/Style\"\nimport { grey } from \"@material-ui/core/colors\"\nimport Select from \"react-select\"\nimport useEventCallback from \"use-event-callback\"\nimport { asMutable } from \"seamless-immutable\"\n\nconst useStyles = makeStyles({})\n\ntype Props = {\n  tags: Array<string>,\n  currentImage: { cls?: string, tags?: Array<string> },\n  imageClsList?: Array<string>,\n  imageTagList?: Array<string>,\n  onChangeImage: (Array<string>) => any,\n}\n\nconst emptyArr = []\n\nexport const TagsSidebarBox = ({\n  currentImage,\n  imageClsList = emptyArr,\n  imageTagList = emptyArr,\n  onChangeImage,\n}: Props) => {\n  if (!currentImage) return null\n  const { tags = [], cls = null } = currentImage\n  const onChangeClassification = useEventCallback((o) =>\n    onChangeImage({ cls: o.value })\n  )\n  const onChangeTags = useEventCallback((o) =>\n    onChangeImage({ tags: o.map((a) => a.value) })\n  )\n  const selectValue = useMemo(() => (cls ? { value: cls, label: cls } : null), [\n    cls,\n  ])\n  const memoImgClsList = useMemo(\n    () => asMutable(imageClsList.map((c) => ({ value: c, label: c }))),\n    [imageClsList]\n  )\n  const memoImgTagList = useMemo(\n    () => asMutable(imageTagList.map((c) => ({ value: c, label: c }))),\n    [imageTagList]\n  )\n  const memoCurrentTags = useMemo(\n    () => tags.map((r) => ({ value: r, label: r })),\n    [tags]\n  )\n\n  return (\n    <SidebarBoxContainer\n      title=\"Image Tags\"\n      expandedByDefault\n      noScroll\n      icon={<StyleIcon style={{ color: grey[700] }} />}\n    >\n      {imageClsList.length > 0 && (\n        <div style={{ padding: 8 }}>\n          <Select\n            placeholder=\"Image Classification\"\n            onChange={onChangeClassification}\n            value={selectValue}\n            options={memoImgClsList}\n          />\n        </div>\n      )}\n      {imageTagList.length > 0 && (\n        <div style={{ padding: 8, paddingTop: 0 }}>\n          <Select\n            isMulti\n            placeholder=\"Image Tags\"\n            onChange={onChangeTags}\n            value={memoCurrentTags}\n            options={memoImgTagList}\n          />\n        </div>\n      )}\n    </SidebarBoxContainer>\n  )\n}\n\nexport default memo(\n  TagsSidebarBox,\n  (prevProps, nextProps) =>\n    prevProps.currentImage.cls === nextProps.currentImage.cls &&\n    prevProps.currentImage.tags === nextProps.currentImage.tags &&\n    prevProps.imageClsList === nextProps.imageClsList &&\n    prevProps.imageTagList === nextProps.imageTagList\n)\n","// @flow\n\nconst getTimeString = (ms, precision = 1) => {\n  if (ms < 1000) {\n    return ms + \"ms\"\n  } else {\n    const secs = ms / 1000\n    if (secs < 60) {\n      if (Number.isInteger(secs)) {\n        return secs + \"s\"\n      } else {\n        return secs.toFixed(precision) + \"s\"\n      }\n    } else {\n      const mins = secs / 60\n      if (Number.isInteger(mins)) {\n        return mins + \"m\"\n      } else {\n        return mins.toFixed(precision) + \"m\"\n      }\n    }\n  }\n}\n\nexport default getTimeString\n","// @flow weak\n\nimport React from \"react\"\nimport AddLocationIcon from \"@material-ui/icons/AddLocation\"\nimport SidebarBoxContainer from \"../SidebarBoxContainer\"\nimport * as colors from \"@material-ui/core/colors\"\nimport getTimeString from \"../KeyframeTimeline/get-time-string.js\"\nimport TrashIcon from \"@material-ui/icons/Delete\"\nimport { styled } from \"@material-ui/core/styles\"\n\nconst KeyframeRow = styled(\"div\")({\n  cursor: \"pointer\",\n  display: \"flex\",\n  alignItems: \"center\",\n  padding: 8,\n  fontSize: 14,\n  color: colors.grey[700],\n  \"&.current\": {\n    backgroundColor: colors.blue[100],\n  },\n  \"&:hover\": {\n    backgroundColor: colors.grey[100],\n  },\n  \"& .time\": {\n    flexGrow: 1,\n    fontWeight: \"bold\",\n    \"& .regionCount\": {\n      marginLeft: 8,\n      fontWeight: \"normal\",\n      color: colors.grey[500],\n    },\n  },\n  \"& .trash\": {\n    \"& .icon\": {\n      fontSize: 18,\n      color: colors.grey[600],\n      transition: \"transform 80ms\",\n      \"&:hover\": {\n        color: colors.grey[800],\n        transform: \"scale(1.25,1.25)\",\n      },\n    },\n  },\n})\n\nconst KeyframesSelector = ({\n  currentVideoTime,\n  keyframes,\n  onChangeVideoTime,\n  onDeleteKeyframe,\n}) => {\n  const keyframeTimes = Object.keys(keyframes).map((t) => parseInt(t))\n  return (\n    <SidebarBoxContainer\n      title=\"Keyframes\"\n      subTitle=\"\"\n      icon={<AddLocationIcon style={{ color: colors.grey[700] }} />}\n      expandedByDefault\n    >\n      {keyframeTimes.map((t) => (\n        <KeyframeRow\n          fullWidth\n          key={t}\n          className={currentVideoTime === t ? \"current\" : \"\"}\n          onClick={() => onChangeVideoTime(t)}\n        >\n          <div className=\"time\">\n            {getTimeString(t, 2)}\n            <span className=\"regionCount\">\n              ({(keyframes[t].regions || []).length})\n            </span>\n          </div>\n          <div className=\"trash\">\n            <TrashIcon\n              onClick={(e) => {\n                onDeleteKeyframe(t)\n                e.stopPropagation()\n              }}\n              className=\"icon\"\n            />\n          </div>\n        </KeyframeRow>\n      ))}\n    </SidebarBoxContainer>\n  )\n}\n\nexport default KeyframesSelector\n","// @flow\n\nimport React from \"react\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport TaskDescription from \"../TaskDescriptionSidebarBox\"\nimport ImageSelector from \"../ImageSelectorSidebarBox\"\nimport RegionSelector from \"../RegionSelectorSidebarBox\"\nimport History from \"../HistorySidebarBox\"\nimport DebugBox from \"../DebugSidebarBox\"\nimport TagsSidebarBox from \"../TagsSidebarBox\"\nimport KeyframesSelector from \"../KeyframesSelectorSidebarBox\"\nimport type { Region } from \"../ImageCanvas/region-tools.js\"\nimport Shortcuts from \"../Shortcuts\"\n\nconst useStyles = makeStyles({})\n\ntype Image = {\n  name: string,\n  src: string,\n  cls?: string,\n  tags?: Array<string>,\n  thumbnailSrc?: string,\n  regions?: Array<Region>,\n}\n\ntype Props = {\n  debug: any,\n  taskDescription: string,\n  images?: Array<Image>,\n  regions: Array<Region>,\n  history: Array<{ state: Object, name: string, time: Date }>,\n\n  labelImages?: boolean,\n  currentImage?: Image,\n  imageClsList?: Array<string>,\n  imageTagList?: Array<string>,\n\n  onChangeImage: (Image) => any,\n  onSelectRegion: (Region) => any,\n  onSelectImage: (Image) => any,\n  onChangeRegion: (Region) => any,\n  onDeleteRegion: (Region) => any,\n  onRestoreHistory: () => any,\n  onShortcutActionDispatched: (action: any) => any,\n}\n\nconst emptyArr = []\n\nexport const Sidebar = ({\n  debug,\n  taskDescription,\n  keyframes,\n  images,\n  regions,\n  history,\n  labelImages,\n  currentImage,\n  currentVideoTime,\n  imageClsList,\n  imageTagList,\n  onChangeImage,\n  onSelectRegion,\n  onSelectImage,\n  onChangeRegion,\n  onDeleteRegion,\n  onRestoreHistory,\n  onChangeVideoTime,\n  onDeleteKeyframe,\n  onShortcutActionDispatched,\n}: Props) => {\n  const classes = useStyles()\n\n  if (!regions) regions = emptyArr\n\n  return (\n    <div>\n      {debug && <DebugBox state={debug} lastAction={debug.lastAction} />}\n      {taskDescription && (taskDescription || \"\").length > 1 && (\n        <TaskDescription description={taskDescription} />\n      )}\n      {labelImages && (\n        <TagsSidebarBox\n          currentImage={currentImage}\n          imageClsList={imageClsList}\n          imageTagList={imageTagList}\n          onChangeImage={onChangeImage}\n          expandedByDefault\n        />\n      )}\n      {images && images.length > 1 && (\n        <ImageSelector onSelect={onSelectImage} images={images} />\n      )}\n      <RegionSelector\n        regions={regions}\n        onSelectRegion={onSelectRegion}\n        onChangeRegion={onChangeRegion}\n        onDeleteRegion={onDeleteRegion}\n      />\n      {keyframes && (\n        <KeyframesSelector\n          currentVideoTime={currentVideoTime}\n          keyframes={keyframes}\n          onChangeVideoTime={onChangeVideoTime}\n          onDeleteKeyframe={onDeleteKeyframe}\n        />\n      )}\n      <History history={history} onRestoreHistory={() => onRestoreHistory()} />\n      {/* <Shortcuts onShortcutActionDispatched={onShortcutActionDispatched} /> */}\n    </div>\n  )\n}\n\nexport default Sidebar\n","import React from \"react\"\nimport TextField from \"@material-ui/core/TextField\"\nimport { makeStyles } from \"@material-ui/core/styles\"\n\nconst useStyles = makeStyles({\n  shortcutKeyFieldWrapper: {\n    paddingTop: 8,\n    display: \"inline-flex\",\n    width: \"100%\",\n  },\n  shortcutKeyText: {\n    lineHeight: 0,\n  },\n  shortcutTextfield: {\n    width: \"100%\",\n    boxSizing: \"border-box\",\n    textAlign: \"center\",\n  },\n})\n\nconst ShortcutField = ({ actionId, actionName, keyName, onChangeShortcut }) => {\n  const classes = useStyles()\n\n  return (\n    <div className={classes.shortcutKeyFieldWrapper}>\n      <TextField\n        variant=\"outlined\"\n        label={actionName}\n        className={classes.shortcutTextfield}\n        value={keyName}\n        onKeyPress={(e) => {\n          onChangeShortcut(actionId, e.key)\n          e.stopPropagation()\n        }}\n      />\n    </div>\n  )\n}\n\nexport default ShortcutField\n","// @flow\n\nimport React, { Fragment, useEffect, useState } from \"react\"\n\nexport const Crosshairs = ({\n  mousePosition,\n  x,\n  y,\n}: {\n  mousePosition: { current: { x: number, y: number } },\n  x?: number,\n  y?: number,\n}) => {\n  const [forceRenderState, changeForceRenderState] = useState()\n\n  if (mousePosition) {\n    x = mousePosition.current.x\n    y = mousePosition.current.y\n  }\n\n  useEffect(() => {\n    if (!mousePosition) return\n    const interval = setInterval(() => {\n      if (x !== mousePosition.current.x || y !== mousePosition.current.y) {\n        changeForceRenderState([\n          mousePosition.current.x,\n          mousePosition.current.y,\n        ])\n      }\n    }, 10)\n    return () => clearInterval(interval)\n  })\n\n  return (\n    <Fragment>\n      <div\n        style={{\n          position: \"absolute\",\n          height: \"100%\",\n          width: 1,\n          zIndex: 10,\n          backgroundColor: \"#f00\",\n          left: x,\n          pointerEvents: \"none\",\n          top: 0,\n        }}\n      />\n      <div\n        style={{\n          position: \"absolute\",\n          width: \"100%\",\n          zIndex: 10,\n          height: 1,\n          backgroundColor: \"#f00\",\n          top: y,\n          pointerEvents: \"none\",\n          left: 0,\n        }}\n      />\n    </Fragment>\n  )\n}\n\nexport default Crosshairs\n","// @flow\n\nimport React, { useState } from \"react\"\nimport { RemoveScroll } from \"react-remove-scroll\"\nimport { styled } from \"@material-ui/core/styles\"\nimport useEventCallback from \"use-event-callback\"\n\nconst Container = styled(\"div\")({\n  \"& > div\": {\n    width: \"100%\",\n    height: \"100%\",\n  },\n})\n\nexport const PreventScrollToParents = ({ children, ...otherProps }) => {\n  const [mouseOver, changeMouseOver] = useState(false)\n  const onMouseMove = useEventCallback((e) => {\n    if (!mouseOver) changeMouseOver(true)\n    if (otherProps.onMouseMove) {\n      otherProps.onMouseMove(e)\n    }\n  })\n  const onMouseLeave = useEventCallback((e) => {\n    setTimeout(() => {\n      if (mouseOver) {\n        changeMouseOver(false)\n      }\n    }, 100)\n  })\n\n  return (\n    <Container\n      {...otherProps}\n      onMouseMove={onMouseMove}\n      onMouseLeave={onMouseLeave}\n    >\n      <RemoveScroll enabled={mouseOver} removeScrollBar={false}>\n        {children}\n      </RemoveScroll>\n    </Container>\n  )\n}\n\nexport default PreventScrollToParents\n","// @flow\n\nimport { useEffect } from \"react\"\n\nimport { useRafState, useInterval } from \"react-use\"\n\nconst useWindowSize = (initialWidth = Infinity, initialHeight = Infinity) => {\n  const isClient = typeof window !== \"undefined\"\n  const [state, setState] = useRafState({\n    width: isClient ? window.innerWidth : initialWidth,\n    height: isClient ? window.innerHeight : initialHeight,\n  })\n\n  useEffect(() => {\n    if (!isClient) return\n    const handler = () => {\n      setState({\n        width: window.innerWidth,\n        height: window.innerHeight,\n      })\n    }\n\n    window.addEventListener(\"resize\", handler)\n\n    return () => {\n      window.removeEventListener(\"resize\", handler)\n    }\n  }, [])\n\n  useInterval(() => {\n    if (!isClient) return\n    if (\n      window.innerWidth !== state.width ||\n      window.innerHeight !== state.height\n    ) {\n      setState({\n        width: window.innerWidth,\n        height: window.innerHeight,\n      })\n    }\n  }, 100)\n\n  return state\n}\n\nexport default useWindowSize\n","// @flow weak\n\nimport { useRef } from \"react\"\nimport { Matrix } from \"transformation-matrix-js\"\n\nconst getDefaultMat = () => Matrix.from(1, 0, 0, 1, -10, -10)\n\nexport default ({\n  canvasEl,\n  changeMat,\n  changeDragging,\n  zoomStart,\n  zoomEnd,\n  changeZoomStart,\n  changeZoomEnd,\n  layoutParams,\n  zoomWithPrimary,\n  dragWithPrimary,\n  mat,\n  onMouseMove,\n  onMouseUp,\n  onMouseDown,\n  dragging,\n}) => {\n  const mousePosition = useRef({ x: 0, y: 0 })\n  const prevMousePosition = useRef({ x: 0, y: 0 })\n\n  const zoomIn = (direction, point) => {\n    const [mx, my] = [point.x, point.y]\n    let scale =\n      typeof direction === \"object\" ? direction.to / mat.a : 1 + 0.2 * direction\n\n    // NOTE: We're mutating mat here\n    mat.translate(mx, my).scaleU(scale)\n    if (mat.a > 2) mat.scaleU(2 / mat.a)\n    if (mat.a < 0.05) mat.scaleU(0.05 / mat.a)\n    mat.translate(-mx, -my)\n\n    changeMat(mat.clone())\n  }\n\n  const mouseEvents = {\n    onMouseMove: (e) => {\n      const { left, top } = canvasEl.current.getBoundingClientRect()\n      prevMousePosition.current.x = mousePosition.current.x\n      prevMousePosition.current.y = mousePosition.current.y\n      mousePosition.current.x = e.clientX - left\n      mousePosition.current.y = e.clientY - top\n\n      const projMouse = mat.applyToPoint(\n        mousePosition.current.x,\n        mousePosition.current.y\n      )\n\n      if (zoomWithPrimary && zoomStart) {\n        changeZoomEnd(projMouse)\n      }\n\n      const { iw, ih } = layoutParams.current\n      onMouseMove({ x: projMouse.x / iw, y: projMouse.y / ih })\n\n      if (dragging) {\n        mat.translate(\n          prevMousePosition.current.x - mousePosition.current.x,\n          prevMousePosition.current.y - mousePosition.current.y\n        )\n\n        changeMat(mat.clone())\n      }\n      e.preventDefault()\n    },\n    onMouseDown: (e, specialEvent = {}) => {\n      e.preventDefault()\n\n      if (e.button === 1 || (e.button === 0 && dragWithPrimary))\n        return changeDragging(true)\n\n      const projMouse = mat.applyToPoint(\n        mousePosition.current.x,\n        mousePosition.current.y\n      )\n      if (zoomWithPrimary && e.button === 0) {\n        changeZoomStart(projMouse)\n        changeZoomEnd(projMouse)\n        return\n      }\n      if (e.button === 0) {\n        if (specialEvent.type === \"resize-box\") {\n          // onResizeBox()\n        }\n        if (specialEvent.type === \"move-region\") {\n          // onResizeBox()\n        }\n        const { iw, ih } = layoutParams.current\n        onMouseDown({ x: projMouse.x / iw, y: projMouse.y / ih })\n      }\n    },\n    onMouseUp: (e) => {\n      e.preventDefault()\n      const projMouse = mat.applyToPoint(\n        mousePosition.current.x,\n        mousePosition.current.y\n      )\n      if (zoomStart) {\n        const zoomEnd = projMouse\n        if (\n          Math.abs(zoomStart.x - zoomEnd.x) < 10 &&\n          Math.abs(zoomStart.y - zoomEnd.y) < 10\n        ) {\n          if (mat.a < 1) {\n            zoomIn({ to: 1 }, mousePosition.current)\n          } else {\n            zoomIn({ to: 0.25 }, mousePosition.current)\n          }\n        } else {\n          const { iw, ih } = layoutParams.current\n\n          if (zoomStart.x > zoomEnd.x) {\n            ;[zoomStart.x, zoomEnd.x] = [zoomEnd.x, zoomStart.x]\n          }\n          if (zoomStart.y > zoomEnd.y) {\n            ;[zoomStart.y, zoomEnd.y] = [zoomEnd.y, zoomStart.y]\n          }\n\n          // The region defined by zoomStart and zoomEnd should be the new transform\n          let scale = Math.min(\n            (zoomEnd.x - zoomStart.x) / iw,\n            (zoomEnd.y - zoomStart.y) / ih\n          )\n          if (scale < 0.05) scale = 0.05\n          if (scale > 10) scale = 10\n\n          const newMat = getDefaultMat()\n            .translate(zoomStart.x, zoomStart.y)\n            .scaleU(scale)\n\n          changeMat(newMat.clone())\n        }\n\n        changeZoomStart(null)\n        changeZoomEnd(null)\n      }\n      if (e.button === 1 || (e.button === 0 && dragWithPrimary))\n        return changeDragging(false)\n      if (e.button === 0) {\n        const { iw, ih } = layoutParams.current\n        onMouseUp({ x: projMouse.x / iw, y: projMouse.y / ih })\n      }\n    },\n    onWheel: (e) => {\n      const direction = e.deltaY > 0 ? 1 : e.deltaY < 0 ? -1 : 0\n      zoomIn(direction, mousePosition.current)\n      // e.preventDefault()\n    },\n  }\n  return { mouseEvents, mousePosition }\n}\n","// @flow weak\nimport useEventCallback from \"use-event-callback\"\nimport { getEnclosingBox } from \"./region-tools.js\"\n\nexport default ({ layoutParams, mat }) => {\n  return useEventCallback((r) => {\n    const { iw, ih } = layoutParams.current\n    const bbox = getEnclosingBox(r)\n    const margin = r.type === \"point\" ? 15 : 2\n    const cbox = {\n      x: bbox.x * iw - margin,\n      y: bbox.y * ih - margin,\n      w: bbox.w * iw + margin * 2,\n      h: bbox.h * ih + margin * 2,\n    }\n    const pbox = {\n      ...mat.clone().inverse().applyToPoint(cbox.x, cbox.y),\n      w: cbox.w / mat.a,\n      h: cbox.h / mat.d,\n    }\n    return pbox\n  })\n}\n","// @flow\n\nexport type BaseRegion = {\n  id: string | number,\n  cls?: string,\n  locked?: boolean,\n  visible?: boolean,\n  color: string,\n  editingLabels?: boolean,\n  highlighted?: boolean,\n  tags?: Array<string>,\n}\n\nexport type Point = {|\n  ...$Exact<BaseRegion>,\n  type: \"point\",\n  x: number,\n  y: number,\n|}\n\nexport type PixelRegion =\n  | {|\n      ...$Exact<BaseRegion>,\n      type: \"pixel\",\n      sx: number,\n      sy: number,\n      w: number,\n      h: number,\n      src: string,\n    |}\n  | {|\n      ...$Exact<BaseRegion>,\n      type: \"pixel\",\n      points: Array<[number, number]>,\n    |}\nexport type Box = {|\n  ...$Exact<BaseRegion>,\n  type: \"box\",\n  x: number,\n  y: number,\n  w: number,\n  h: number,\n|}\nexport type Polygon = {|\n  ...$Exact<BaseRegion>,\n  type: \"polygon\",\n  open?: boolean,\n  points: Array<[number, number]>,\n|}\nexport type ExpandingLine = {|\n  ...$Exact<BaseRegion>,\n  type: \"expanding-line\",\n  points: Array<{ x: number, y: number, angle: number, width: number }>,\n|}\n\nexport type Region = Point | PixelRegion | Box | Polygon | ExpandingLine\n\nexport const getEnclosingBox = (region: Region) => {\n  switch (region.type) {\n    case \"polygon\": {\n      const box = {\n        x: Math.min(...region.points.map(([x, y]) => x)),\n        y: Math.min(...region.points.map(([x, y]) => y)),\n        w: 0,\n        h: 0,\n      }\n      box.w = Math.max(...region.points.map(([x, y]) => x)) - box.x\n      box.h = Math.max(...region.points.map(([x, y]) => y)) - box.y\n      return box\n    }\n    case \"expanding-line\": {\n      const box = {\n        x: Math.min(...region.points.map(({ x, y }) => x)),\n        y: Math.min(...region.points.map(({ x, y }) => y)),\n        w: 0,\n        h: 0,\n      }\n      box.w = Math.max(...region.points.map(({ x, y }) => x)) - box.x\n      box.h = Math.max(...region.points.map(({ x, y }) => y)) - box.y\n      return box\n    }\n    case \"box\": {\n      return { x: region.x, y: region.y, w: region.w, h: region.h }\n    }\n    case \"point\": {\n      return { x: region.x, y: region.y, w: 0, h: 0 }\n    }\n    default: {\n      return { x: 0, y: 0, w: 0, h: 0 }\n    }\n  }\n  throw new Error(\"unknown region\")\n}\n\nexport const moveRegion = (region: Region, x: number, y: number) => {\n  switch (region.type) {\n    case \"point\": {\n      return { ...region, x, y }\n    }\n    case \"box\": {\n      return { ...region, x: x - region.w / 2, y: y - region.h / 2 }\n    }\n  }\n  return region\n}\n","// @flow weak\n\nimport React, { Fragment } from \"react\"\nimport { styled } from \"@material-ui/core/styles\"\n\nconst Svg = styled(\"svg\")({\n  pointerEvents: \"none\",\n  position: \"absolute\",\n  zIndex: 1,\n  left: 0,\n  top: 0,\n  width: \"100%\",\n  height: \"100%\",\n  \"& text\": {\n    fill: \"#fff\",\n  },\n  \"& path\": {\n    vectorEffect: \"non-scaling-stroke\",\n    strokeWidth: 2,\n    opacity: 0.5,\n    stroke: \"#FFF\",\n    fill: \"none\",\n    strokeDasharray: 5,\n    animationDuration: \"4s\",\n    animationTimingFunction: \"linear\",\n    animationIterationCount: \"infinite\",\n    animationPlayState: \"running\",\n  },\n})\n\nexport const PointDistances = ({\n  projectRegionBox,\n  regions,\n  pointDistancePrecision,\n  realSize,\n}) => {\n  return (\n    <Svg>\n      {regions\n        .filter((r1) => r1.type === \"point\")\n        .flatMap((r1, i1) =>\n          regions\n            .filter((r2, i2) => i2 > i1)\n            .filter((r2) => r2.type === \"point\")\n            .map((r2) => {\n              const pr1 = projectRegionBox(r1)\n              const pr2 = projectRegionBox(r2)\n              const prm = {\n                x: (pr1.x + pr1.w / 2 + pr2.x + pr2.w / 2) / 2,\n                y: (pr1.y + pr1.h / 2 + pr2.y + pr2.h / 2) / 2,\n              }\n              let displayDistance\n              if (realSize) {\n                const { w, h, unitName } = realSize\n                displayDistance =\n                  Math.sqrt(\n                    Math.pow(r1.x * w - r2.x * w, 2) +\n                      Math.pow(r1.y * h - r2.y * h, 2)\n                  ).toFixed(pointDistancePrecision) + unitName\n              } else {\n                displayDistance =\n                  (\n                    Math.sqrt(\n                      Math.pow(r1.x - r2.x, 2) + Math.pow(r1.y - r2.y, 2)\n                    ) * 100\n                  ).toFixed(pointDistancePrecision) + \"%\"\n              }\n              return (\n                <Fragment>\n                  <path\n                    d={`M${pr1.x + pr1.w / 2},${pr1.y + pr1.h / 2} L${\n                      pr2.x + pr2.w / 2\n                    },${pr2.y + pr2.h / 2}`}\n                  />\n                  <text x={prm.x} y={prm.y}>\n                    {displayDistance}\n                  </text>\n                </Fragment>\n              )\n            })\n        )}\n    </Svg>\n  )\n}\n\nexport default PointDistances\n","// @flow\n\nimport { grey } from \"@material-ui/core/colors\"\n\nexport default {\n  regionInfo: {\n    fontSize: 12,\n    cursor: \"default\",\n    transition: \"opacity 200ms\",\n    opacity: 0.5,\n    \"&:hover\": {\n      opacity: 0.9,\n      cursor: \"pointer\",\n    },\n    \"&.highlighted\": {\n      opacity: 0.9,\n      \"&:hover\": {\n        opacity: 1,\n      },\n    },\n    // pointerEvents: \"none\",\n    fontWeight: 600,\n    color: grey[900],\n    padding: 8,\n    \"& .name\": {\n      display: \"flex\",\n      flexDirection: \"row\",\n      alignItems: \"center\",\n      \"& .circle\": {\n        marginRight: 4,\n        boxShadow: \"0px 0px 2px rgba(0,0,0,0.4)\",\n        width: 10,\n        height: 10,\n        borderRadius: 5,\n      },\n    },\n    \"& .tags\": {\n      \"& .tag\": {\n        color: grey[700],\n        display: \"inline-block\",\n        margin: 1,\n        fontSize: 10,\n        textDecoration: \"underline\",\n      },\n    },\n  },\n}\n","// @flow\n\nimport React, { useState, memo } from \"react\"\nimport Paper from \"@material-ui/core/Paper\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport styles from \"./styles\"\nimport classnames from \"classnames\"\nimport type { Region } from \"../ImageCanvas/region-tools.js\"\nimport IconButton from \"@material-ui/core/IconButton\"\nimport Button from \"@material-ui/core/Button\"\nimport TrashIcon from \"@material-ui/icons/Delete\"\nimport CheckIcon from \"@material-ui/icons/Check\"\nimport UndoIcon from \"@material-ui/icons/Undo\"\nimport Select from \"react-select\"\nimport CreatableSelect from \"react-select/creatable\"\n\nimport { asMutable } from \"seamless-immutable\"\n\nconst useStyles = makeStyles(styles)\n\ntype Props = {\n  region: Region,\n  editing?: boolean,\n  allowedClasses?: Array<string>,\n  allowedTags?: Array<string>,\n  cls?: string,\n  tags?: Array<string>,\n  onDelete: (Region) => null,\n  onChange: (Region) => null,\n  onClose: (Region) => null,\n  onOpen: (Region) => null,\n  onRegionClassAdded: () => {},\n}\n\nexport const RegionLabel = ({\n  region,\n  editing,\n  allowedClasses,\n  allowedTags,\n  onDelete,\n  onChange,\n  onClose,\n  onOpen,\n  onRegionClassAdded,\n}: Props) => {\n  const classes = useStyles()\n\n  return (\n    <Paper\n      onClick={() => (!editing ? onOpen(region) : null)}\n      className={classnames(classes.regionInfo, {\n        highlighted: region.highlighted,\n      })}\n    >\n      {!editing ? (\n        <div>\n          {region.cls && (\n            <div className=\"name\">\n              <div\n                className=\"circle\"\n                style={{ backgroundColor: region.color }}\n              />\n              {region.cls}\n            </div>\n          )}\n          {region.tags && (\n            <div className=\"tags\">\n              {region.tags.map((t) => (\n                <div key={t} className=\"tag\">\n                  {t}\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      ) : (\n        <div style={{ width: 200 }}>\n          <div style={{ display: \"flex\", flexDirection: \"row\" }}>\n            <div\n              style={{\n                display: \"flex\",\n                backgroundColor: region.color,\n                color: \"#fff\",\n                padding: 4,\n                paddingLeft: 8,\n                paddingRight: 8,\n                borderRadius: 4,\n                fontWeight: \"bold\",\n                textShadow: \"0px 0px 5px rgba(0,0,0,0.4)\",\n              }}\n            >\n              {region.type}\n            </div>\n            <div style={{ flexGrow: 1 }} />\n            <IconButton\n              onClick={() => onDelete(region)}\n              tabIndex={-1}\n              style={{ width: 22, height: 22 }}\n              size=\"small\"\n              variant=\"outlined\"\n            >\n              <TrashIcon style={{ marginTop: -8, width: 16, height: 16 }} />\n            </IconButton>\n          </div>\n          {(allowedClasses || []).length > 0 && (\n            <div style={{ marginTop: 6 }}>\n              <CreatableSelect\n                placeholder=\"Classification\"\n                onChange={(o, actionMeta) => {\n                  if (actionMeta.action == \"create-option\") {\n                    onRegionClassAdded(o.value)\n                  }\n                  return onChange({\n                    ...(region: any),\n                    cls: o.value,\n                  })\n                }}\n                value={\n                  region.cls ? { label: region.cls, value: region.cls } : null\n                }\n                options={asMutable(\n                  allowedClasses.map((c) => ({ value: c, label: c }))\n                )}\n              />\n            </div>\n          )}\n          {(allowedTags || []).length > 0 && (\n            <div style={{ marginTop: 4 }}>\n              <Select\n                onChange={(newTags) =>\n                  onChange({\n                    ...(region: any),\n                    tags: newTags.map((t) => t.value),\n                  })\n                }\n                placeholder=\"Tags\"\n                value={(region.tags || []).map((c) => ({ label: c, value: c }))}\n                isMulti\n                options={asMutable(\n                  allowedTags.map((c) => ({ value: c, label: c }))\n                )}\n              />\n            </div>\n          )}\n          {onClose && (\n            <div style={{ marginTop: 4, display: \"flex\" }}>\n              <div style={{ flexGrow: 1 }} />\n              <Button\n                onClick={() => onClose(region)}\n                size=\"small\"\n                variant=\"contained\"\n                color=\"primary\"\n              >\n                <CheckIcon />\n              </Button>\n            </div>\n          )}\n        </div>\n      )}\n    </Paper>\n  )\n}\n\nexport default memo(\n  RegionLabel,\n  (prevProps, nextProps) =>\n    prevProps.editing === nextProps.editing &&\n    prevProps.region === nextProps.region\n)\n","// @flow weak\n\nimport React from \"react\"\nimport Paper from \"@material-ui/core/Paper\"\nimport DefaultRegionLabel from \"../RegionLabel\"\nimport LockIcon from \"@material-ui/icons/Lock\"\n\nconst copyWithout = (obj, ...args) => {\n  const newObj = { ...obj }\n  for (const arg of args) {\n    delete newObj[arg]\n  }\n  return newObj\n}\n\nexport const RegionTags = ({\n  regions,\n  projectRegionBox,\n  mouseEvents,\n  regionClsList,\n  regionTagList,\n  onBeginRegionEdit,\n  onChangeRegion,\n  onCloseRegionEdit,\n  onDeleteRegion,\n  layoutParams,\n  imageSrc,\n  RegionEditLabel,\n  onRegionClassAdded,\n}) => {\n  const RegionLabel =\n    RegionEditLabel != null ? RegionEditLabel : DefaultRegionLabel\n  return regions\n    .filter((r) => r.visible || r.visible === undefined)\n    .map((region) => {\n      const pbox = projectRegionBox(region)\n      const { iw, ih } = layoutParams.current\n      let margin = 8\n      if (region.highlighted && region.type === \"box\") margin += 6\n      const labelBoxHeight =\n        region.editingLabels && !region.locked ? 170 : region.tags ? 60 : 50\n      const displayOnTop = pbox.y > labelBoxHeight\n\n      const coords = displayOnTop\n        ? {\n            left: pbox.x,\n            top: pbox.y - margin / 2,\n          }\n        : { left: pbox.x, top: pbox.y + pbox.h + margin / 2 }\n      if (region.locked) {\n        return (\n          <div\n            key={region.id}\n            style={{\n              position: \"absolute\",\n              ...coords,\n              zIndex: 10 + (region.editingLabels ? 5 : 0),\n            }}\n          >\n            <Paper\n              style={{\n                position: \"absolute\",\n                left: 0,\n                ...(displayOnTop ? { bottom: 0 } : { top: 0 }),\n                zIndex: 10,\n                backgroundColor: \"#fff\",\n                borderRadius: 4,\n                padding: 2,\n                paddingBottom: 0,\n                opacity: 0.5,\n                pointerEvents: \"none\",\n              }}\n            >\n              <LockIcon style={{ width: 16, height: 16, color: \"#333\" }} />\n            </Paper>\n          </div>\n        )\n      }\n      return (\n        <div\n          key={region.id}\n          style={{\n            position: \"absolute\",\n            ...coords,\n            zIndex: 10 + (region.editingLabels ? 5 : 0),\n            width: 200,\n          }}\n          onMouseDown={(e) => e.preventDefault()}\n          onMouseUp={(e) => e.preventDefault()}\n          onMouseEnter={(e) => {\n            if (region.editingLabels) {\n              mouseEvents.onMouseUp(e)\n              e.button = 1\n              mouseEvents.onMouseUp(e)\n            }\n          }}\n        >\n          <div\n            style={{\n              position: \"absolute\",\n              zIndex: 20,\n              left: 0,\n              ...(displayOnTop ? { bottom: 0 } : { top: 0 }),\n            }}\n            {...(!region.editingLabels\n              ? copyWithout(mouseEvents, \"onMouseDown\", \"onMouseUp\")\n              : {})}\n          >\n            <RegionLabel\n              allowedClasses={regionClsList}\n              allowedTags={regionTagList}\n              onOpen={onBeginRegionEdit}\n              onChange={onChangeRegion}\n              onClose={onCloseRegionEdit}\n              onDelete={onDeleteRegion}\n              editing={region.editingLabels}\n              region={region}\n              regions={regions}\n              imageSrc={imageSrc}\n              onRegionClassAdded={onRegionClassAdded}\n            />\n          </div>\n        </div>\n      )\n    })\n}\n\nexport default RegionTags\n","// @flow\n\nimport * as muiColors from \"@material-ui/core/colors\"\n\nexport const colors = [\n  muiColors.red[500],\n  muiColors.blue[500],\n  muiColors.green[500],\n  muiColors.orange[800],\n  muiColors.brown[500],\n  muiColors.lightGreen[700],\n  muiColors.pink[500],\n  muiColors.purple[500],\n  muiColors.indigo[500],\n  muiColors.teal[500],\n  muiColors.lime[500],\n  muiColors.blueGrey[500],\n]\n\nconst transparency = 0x88000000\n\nfunction reverseParseColor(rrggbb) {\n  rrggbb = rrggbb.replace(\"#\", \"\")\n  const bbggrr = rrggbb.substr(4, 2) + rrggbb.substr(2, 2) + rrggbb.substr(0, 2)\n  return parseInt(bbggrr, 16)\n}\n\nexport const colorInts: Array<number> = colors.map(\n  (c) => (reverseParseColor(c) | transparency) >>> 0\n)\n\nexport default colors\n","// @flow\n\nimport React, { useState, useEffect, useMemo, useRef } from \"react\"\nimport { colorInts } from \"../colors\"\nimport { useDebounce } from \"react-use\"\n\nimport MMGC_INIT from \"mmgc1-cpp\"\n\nexport const ImageMask = ({\n  regions,\n  regionClsList,\n  imageSrc,\n  imagePosition,\n  zIndex = 1,\n  hide = false,\n  autoSegmentationOptions = { type: \"simple\" },\n}) => {\n  if (!window.mmgc) window.mmgc = MMGC_INIT()\n  const mmgc = window.mmgc\n  const [canvasRef, setCanvasRef] = useState(null)\n\n  const superPixelsGenerated = useRef(false)\n  const [sampleImageData, setSampleImageData] = useState()\n\n  useEffect(() => {\n    if (!imageSrc) return\n    const canvas = document.createElement(\"canvas\")\n    const ctx = canvas.getContext(\"2d\")\n\n    const image = new Image()\n    image.crossOrigin = \"anonymous\"\n    image.src = imageSrc\n    image.onload = () => {\n      canvas.width = image.naturalWidth\n      canvas.height = image.naturalHeight\n      ctx.drawImage(image, 0, 0)\n      const imageData = ctx.getImageData(\n        0,\n        0,\n        image.naturalWidth,\n        image.naturalHeight\n      )\n      superPixelsGenerated.current = false\n      setSampleImageData(imageData)\n    }\n  }, [imageSrc])\n\n  useDebounce(\n    () => {\n      if (hide) return\n      if (!canvasRef) return\n      if (!sampleImageData) return\n      if (regions.filter((cp) => cp.cls).length < 3) return\n      if (!mmgc.setImageSize) return\n      const context = canvasRef.getContext(\"2d\")\n\n      if (!superPixelsGenerated.current) {\n        superPixelsGenerated.current = \"processing\"\n        mmgc.setSimpleMode(autoSegmentationOptions.type === \"simple\")\n        mmgc.setMaxClusters(1000)\n        mmgc.setImageSize(sampleImageData.width, sampleImageData.height)\n        mmgc.setClassColor(0, 0)\n        for (let i = 0; i < colorInts.length; i++) {\n          mmgc.setClassColor(i + 1, colorInts[i])\n        }\n        const imageAddress = mmgc.getImageAddr()\n        mmgc.HEAPU8.set(sampleImageData.data, imageAddress)\n        mmgc.computeSuperPixels()\n        superPixelsGenerated.current = \"done\"\n      }\n      if (superPixelsGenerated.current !== \"done\") return\n\n      // mmgc.setVerboseMode(true)\n      if (\n        ![\"bg\", \"background\", \"nothing\"].includes(\n          regionClsList[0].toLowerCase()\n        )\n      ) {\n        console.log(\n          `first region cls must be \"bg\" or \"background\" or \"nothing\"`\n        )\n        return\n      }\n      mmgc.clearClassElements()\n      const classPoints = regions\n        .filter((r) => r.type === \"point\")\n        .filter((r) => r.cls)\n      for (const classPoint of classPoints) {\n        if (classPoint.x < 0 || classPoint.x >= 1) continue\n        if (classPoint.y < 0 || classPoint.y >= 1) continue\n        const clsIndex = regionClsList.indexOf(classPoint.cls)\n        if (clsIndex > colorInts.length) {\n          console.log(\"Too many classes to draw on mask!\")\n          continue\n        }\n\n        mmgc.addClassPoint(\n          clsIndex,\n          Math.floor(classPoint.y * sampleImageData.height),\n          Math.floor(classPoint.x * sampleImageData.width)\n        )\n      }\n      const classPolygons = regions\n        .filter((r) => r.type === \"polygon\")\n        .filter((r) => r.cls)\n      for (const polygon of classPolygons) {\n        const { points } = polygon\n        const clsIndex = regionClsList.indexOf(polygon.cls)\n        const pi = mmgc.addPolygon(clsIndex)\n        const pointPairs = points.map((p, i) => [\n          p,\n          points[(i + 1) % points.length],\n        ])\n        for (const [p1, p2] of pointPairs) {\n          const ri1 = Math.round(p1[1] * sampleImageData.height)\n          const ci1 = Math.round(p1[0] * sampleImageData.width)\n          const ri2 = Math.round(p2[1] * sampleImageData.height)\n          const ci2 = Math.round(p2[0] * sampleImageData.width)\n          mmgc.addLineToPolygon(pi, ri1, ci1, ri2, ci2)\n        }\n      }\n\n      mmgc.computeMasks()\n      const maskAddress = mmgc.getColoredMask()\n      const cppImDataUint8 = new Uint8ClampedArray(\n        mmgc.HEAPU8.buffer,\n        maskAddress,\n        sampleImageData.data.length\n      )\n      const maskImageData = new ImageData(\n        cppImDataUint8,\n        sampleImageData.width,\n        sampleImageData.height\n      )\n\n      context.clearRect(0, 0, sampleImageData.width, sampleImageData.height)\n      context.putImageData(maskImageData, 0, 0)\n    },\n    1000,\n    [canvasRef, sampleImageData, regions, hide]\n  )\n\n  const style = useMemo(() => {\n    let width = imagePosition.bottomRight.x - imagePosition.topLeft.x\n    let height = imagePosition.bottomRight.y - imagePosition.topLeft.y\n    return {\n      display: hide ? \"none\" : undefined,\n      imageRendering: \"pixelated\",\n      transform: \"translateZ(0px)\",\n      left: imagePosition.topLeft.x,\n      top: imagePosition.topLeft.y,\n      width: isNaN(width) ? 0 : width,\n      height: isNaN(height) ? 0 : height,\n      zIndex,\n      position: \"absolute\",\n      pointerEvents: \"none\",\n    }\n  }, [\n    imagePosition.topLeft.x,\n    imagePosition.topLeft.y,\n    imagePosition.bottomRight.x,\n    imagePosition.bottomRight.y,\n    zIndex,\n    hide,\n  ])\n\n  return (\n    <canvas\n      style={style}\n      width={sampleImageData ? sampleImageData.width : 0}\n      height={sampleImageData ? sampleImageData.height : 0}\n      ref={setCanvasRef}\n    />\n  )\n}\n\nexport default ImageMask\n","// @flow\n\nimport React from \"react\"\nimport classnames from \"classnames\"\nimport { makeStyles } from \"@material-ui/core/styles\"\n\nconst useStyles = makeStyles({\n  \"@keyframes borderDance\": {\n    from: { strokeDashoffset: 0 },\n    to: { strokeDashoffset: 100 },\n  },\n  highlightBox: {\n    zIndex: 2,\n    transition: \"opacity 500ms\",\n    \"&.highlighted\": {\n      zIndex: 3,\n    },\n    \"&:not(.highlighted)\": {\n      opacity: 0,\n    },\n    \"&:not(.highlighted):hover\": {\n      opacity: 0.6,\n    },\n    \"& path\": {\n      vectorEffect: \"non-scaling-stroke\",\n      strokeWidth: 2,\n      stroke: \"#FFF\",\n      fill: \"none\",\n      strokeDasharray: 5,\n      animationName: \"$borderDance\",\n      animationDuration: \"4s\",\n      animationTimingFunction: \"linear\",\n      animationIterationCount: \"infinite\",\n      animationPlayState: \"running\",\n    },\n  },\n})\n\nexport const HighlightBox = ({\n  mouseEvents,\n  dragWithPrimary,\n  zoomWithPrimary,\n  createWithPrimary,\n  onBeginMovePoint,\n  onSelectRegion,\n  region: r,\n  pbox,\n}: {\n  mouseEvents: any,\n  dragWithPrimary: boolean,\n  zoomWithPrimary: boolean,\n  createWithPrimary: boolean,\n  onBeginMovePoint: Function,\n  onSelectRegion: Function,\n  region: any,\n  pbox: { x: number, y: number, w: number, h: number },\n}) => {\n  const classes = useStyles()\n  if (!pbox.w || pbox.w === Infinity) return null\n  if (!pbox.h || pbox.h === Infinity) return null\n  if (r.unfinished) return null\n\n  const styleCoords =\n    r.type === \"point\"\n      ? {\n          left: pbox.x + pbox.w / 2 - 30,\n          top: pbox.y + pbox.h / 2 - 30,\n          width: 60,\n          height: 60,\n        }\n      : {\n          left: pbox.x - 5,\n          top: pbox.y - 5,\n          width: pbox.w + 10,\n          height: pbox.h + 10,\n        }\n\n  const pathD =\n    r.type === \"point\"\n      ? `M5,5 L${styleCoords.width - 5} 5L${styleCoords.width - 5} ${\n          styleCoords.height - 5\n        }L5 ${styleCoords.height - 5}Z`\n      : `M5,5 L${pbox.w + 5},5 L${pbox.w + 5},${pbox.h + 5} L5,${pbox.h + 5} Z`\n\n  return (\n    <svg\n      key={r.id}\n      className={classnames(classes.highlightBox, {\n        highlighted: r.highlighted,\n      })}\n      {...mouseEvents}\n      {...(!zoomWithPrimary && !dragWithPrimary\n        ? {\n            onMouseDown: (e) => {\n              if (\n                !r.locked &&\n                r.type === \"point\" &&\n                r.highlighted &&\n                e.button === 0\n              ) {\n                return onBeginMovePoint(r)\n              }\n              if (e.button === 0 && !createWithPrimary) return onSelectRegion(r)\n              mouseEvents.onMouseDown(e)\n            },\n          }\n        : {})}\n      style={{\n        ...(r.highlighted\n          ? {\n              pointerEvents: r.type !== \"point\" ? \"none\" : undefined,\n              cursor: \"grab\",\n            }\n          : {\n              cursor: !(zoomWithPrimary || dragWithPrimary || createWithPrimary)\n                ? \"pointer\"\n                : undefined,\n              pointerEvents:\n                zoomWithPrimary ||\n                dragWithPrimary ||\n                (createWithPrimary && !r.highlighted)\n                  ? \"none\"\n                  : undefined,\n            }),\n        position: \"absolute\",\n        ...styleCoords,\n      }}\n    >\n      <path d={pathD} />\n    </svg>\n  )\n}\n\nexport default HighlightBox\n","// @flow weak\n\nimport React, { Fragment, memo } from \"react\"\nimport HighlightBox from \"../HighlightBox\"\nimport { styled } from \"@material-ui/core/styles\"\nimport PreventScrollToParents from \"../PreventScrollToParents\"\n\nconst TransformGrabber = styled(\"div\")({\n  width: 8,\n  height: 8,\n  zIndex: 2,\n  border: \"2px solid #FFF\",\n  position: \"absolute\",\n})\n\nconst boxCursorMap = [\n  [\"nw-resize\", \"n-resize\", \"ne-resize\"],\n  [\"w-resize\", \"grab\", \"e-resize\"],\n  [\"sw-resize\", \"s-resize\", \"se-resize\"],\n]\n\nconst arePropsEqual = (prev, next) => {\n  return (\n    prev.region === next.region &&\n    prev.dragWithPrimary === next.dragWithPrimary &&\n    prev.createWithPrimary === next.createWithPrimary &&\n    prev.zoomWithPrimary === next.zoomWithPrimary &&\n    prev.mat === next.mat\n  )\n}\n\nexport const RegionSelectAndTransformBox = memo(\n  ({\n    region: r,\n    mouseEvents,\n    projectRegionBox,\n    dragWithPrimary,\n    createWithPrimary,\n    zoomWithPrimary,\n    onBeginMovePoint,\n    onSelectRegion,\n    layoutParams,\n    fullImageSegmentationMode = false,\n    mat,\n    onBeginBoxTransform,\n    onBeginMovePolygonPoint,\n    onAddPolygonPoint,\n    showHighlightBox,\n  }) => {\n    const pbox = projectRegionBox(r)\n    const { iw, ih } = layoutParams.current\n    return (\n      <Fragment>\n        <PreventScrollToParents>\n          {showHighlightBox && r.type !== \"polygon\" && (\n            <HighlightBox\n              region={r}\n              mouseEvents={mouseEvents}\n              dragWithPrimary={dragWithPrimary}\n              createWithPrimary={createWithPrimary}\n              zoomWithPrimary={zoomWithPrimary}\n              onBeginMovePoint={onBeginMovePoint}\n              onSelectRegion={onSelectRegion}\n              pbox={pbox}\n            />\n          )}\n          {r.type === \"box\" &&\n            !dragWithPrimary &&\n            !zoomWithPrimary &&\n            !r.locked &&\n            r.highlighted &&\n            mat.a < 1.2 &&\n            [\n              [0, 0],\n              [0.5, 0],\n              [1, 0],\n              [1, 0.5],\n              [1, 1],\n              [0.5, 1],\n              [0, 1],\n              [0, 0.5],\n              [0.5, 0.5],\n            ].map(([px, py], i) => (\n              <TransformGrabber\n                key={i}\n                {...mouseEvents}\n                onMouseDown={(e) => {\n                  if (e.button === 0)\n                    return onBeginBoxTransform(r, [px * 2 - 1, py * 2 - 1])\n                  mouseEvents.onMouseDown(e)\n                }}\n                style={{\n                  left: pbox.x - 4 - 2 + pbox.w * px,\n                  top: pbox.y - 4 - 2 + pbox.h * py,\n                  cursor: boxCursorMap[py * 2][px * 2],\n                  borderRadius: px === 0.5 && py === 0.5 ? 4 : undefined,\n                }}\n              />\n            ))}\n          {r.type === \"polygon\" &&\n            !dragWithPrimary &&\n            !zoomWithPrimary &&\n            !r.locked &&\n            r.highlighted &&\n            r.points.map(([px, py], i) => {\n              const proj = mat\n                .clone()\n                .inverse()\n                .applyToPoint(px * iw, py * ih)\n              return (\n                <TransformGrabber\n                  key={i}\n                  {...mouseEvents}\n                  onMouseDown={(e) => {\n                    if (e.button === 0 && (!r.open || i === 0))\n                      return onBeginMovePolygonPoint(r, i)\n                    mouseEvents.onMouseDown(e)\n                  }}\n                  style={{\n                    cursor: !r.open ? \"move\" : i === 0 ? \"pointer\" : undefined,\n                    zIndex: 10,\n                    pointerEvents:\n                      r.open && i === r.points.length - 1 ? \"none\" : undefined,\n                    left: proj.x - 4,\n                    top: proj.y - 4,\n                  }}\n                />\n              )\n            })}\n          {r.type === \"polygon\" &&\n            r.highlighted &&\n            !dragWithPrimary &&\n            !zoomWithPrimary &&\n            !r.locked &&\n            !r.open &&\n            r.points.length > 1 &&\n            r.points\n              .map((p1, i) => [p1, r.points[(i + 1) % r.points.length]])\n              .map(([p1, p2]) => [(p1[0] + p2[0]) / 2, (p1[1] + p2[1]) / 2])\n              .map((pa, i) => {\n                const proj = mat\n                  .clone()\n                  .inverse()\n                  .applyToPoint(pa[0] * iw, pa[1] * ih)\n                return (\n                  <TransformGrabber\n                    key={i}\n                    {...mouseEvents}\n                    onMouseDown={(e) => {\n                      if (e.button === 0) return onAddPolygonPoint(r, pa, i + 1)\n                      mouseEvents.onMouseDown(e)\n                    }}\n                    style={{\n                      cursor: \"copy\",\n                      zIndex: 10,\n                      left: proj.x - 4,\n                      top: proj.y - 4,\n                      border: \"2px dotted #fff\",\n                      opacity: 0.5,\n                    }}\n                  />\n                )\n              })}\n        </PreventScrollToParents>\n      </Fragment>\n    )\n  },\n  arePropsEqual\n)\n\nexport const RegionSelectAndTransformBoxes = memo(\n  (props) => {\n    return props.regions\n      .filter((r) => r.visible || r.visible === undefined)\n      .filter((r) => !r.locked)\n      .map((r, i) => {\n        return <RegionSelectAndTransformBox key={r.id} {...props} region={r} />\n      })\n  },\n  (n, p) => n.regions === p.regions && n.mat === p.mat\n)\n\nexport default RegionSelectAndTransformBoxes\n","// @flow\n\nimport React, { createContext, useContext, useState } from \"react\"\n\nconst defaultSettings = {\n  showCrosshairs: false,\n  showHighlightBox: true,\n  wasdMode: true,\n}\n\nexport const SettingsContext = createContext(defaultSettings)\n\nconst pullSettingsFromLocalStorage = () => {\n  if (!window || !window.localStorage) return {}\n  let settings = {}\n  for (let i = 0; i < window.localStorage.length; i++) {\n    const key = window.localStorage.key(i)\n    if (key.startsWith(\"settings_\")) {\n      try {\n        settings[key.replace(\"settings_\", \"\")] = JSON.parse(\n          window.localStorage.getItem(key)\n        )\n      } catch (e) {}\n    }\n  }\n  return settings\n}\n\nexport const useSettings = () => useContext(SettingsContext)\n\nexport const SettingsProvider = ({ children }) => {\n  const [state, changeState] = useState(() => pullSettingsFromLocalStorage())\n  const changeSetting = (setting: string, value: any) => {\n    changeState({ ...state, [setting]: value })\n    window.localStorage.setItem(`settings_${setting}`, JSON.stringify(value))\n  }\n  return (\n    <SettingsContext.Provider value={{ ...state, changeSetting }}>\n      {children}\n    </SettingsContext.Provider>\n  )\n}\n\nexport default SettingsProvider\n","// @flow weak\n\nimport React, { useRef, useEffect, useMemo } from \"react\"\nimport { styled } from \"@material-ui/core/styles\"\nimport useEventCallback from \"use-event-callback\"\nimport { useSettings } from \"../SettingsProvider\"\n\nconst Video = styled(\"video\")({\n  zIndex: 0,\n  position: \"absolute\",\n})\n\nconst StyledImage = styled(\"img\")({\n  zIndex: 0,\n  position: \"absolute\",\n})\n\nexport default ({\n  imagePosition,\n  mouseEvents,\n  videoTime,\n  videoSrc,\n  imageSrc,\n  onLoad,\n  videoPlaying,\n  onChangeVideoTime,\n  onChangeVideoPlaying,\n}) => {\n  const settings = useSettings()\n  const videoRef = useRef()\n  const imageRef = useRef()\n\n  useEffect(() => {\n    if (!videoPlaying && videoRef.current) {\n      videoRef.current.currentTime = (videoTime || 0) / 1000\n    }\n  }, [videoTime])\n\n  useEffect(() => {\n    let renderLoopRunning = false\n    if (videoRef.current) {\n      if (videoPlaying) {\n        videoRef.current.play()\n        renderLoopRunning = true\n        if (settings.videoPlaybackSpeed) {\n          videoRef.current.playbackRate = parseFloat(\n            settings.videoPlaybackSpeed\n          )\n        }\n      } else {\n        videoRef.current.pause()\n      }\n    }\n\n    function checkForNewFrame() {\n      if (!renderLoopRunning) return\n      if (!videoRef.current) return\n      const newVideoTime = Math.floor(videoRef.current.currentTime * 1000)\n      if (videoTime !== newVideoTime) {\n        onChangeVideoTime(newVideoTime)\n      }\n      if (videoRef.current.paused) {\n        renderLoopRunning = false\n        onChangeVideoPlaying(false)\n      }\n      requestAnimationFrame(checkForNewFrame)\n    }\n    checkForNewFrame()\n\n    return () => {\n      renderLoopRunning = false\n    }\n  }, [videoPlaying])\n\n  const onLoadedVideoMetadata = useEventCallback((event) => {\n    const videoElm = event.currentTarget\n    videoElm.currentTime = (videoTime || 0) / 1000\n    if (onLoad)\n      onLoad({\n        naturalWidth: videoElm.videoWidth,\n        naturalHeight: videoElm.videoHeight,\n        videoElm: videoElm,\n        duration: videoElm.duration,\n      })\n  })\n  const onImageLoaded = useEventCallback((event) => {\n    const imageElm = event.currentTarget\n    if (onLoad)\n      onLoad({\n        naturalWidth: imageElm.naturalWidth,\n        naturalHeight: imageElm.naturalHeight,\n        imageElm,\n      })\n  })\n\n  const stylePosition = useMemo(() => {\n    let width = imagePosition.bottomRight.x - imagePosition.topLeft.x\n    let height = imagePosition.bottomRight.y - imagePosition.topLeft.y\n    return {\n      imageRendering: \"pixelated\",\n      left: imagePosition.topLeft.x,\n      top: imagePosition.topLeft.y,\n      width: isNaN(width) ? 0 : width,\n      height: isNaN(height) ? 0 : height,\n    }\n  }, [\n    imagePosition.topLeft.x,\n    imagePosition.topLeft.y,\n    imagePosition.bottomRight.x,\n    imagePosition.bottomRight.y,\n  ])\n\n  if (!videoSrc && !imageSrc) return \"No imageSrc or videoSrc provided\"\n\n  return imageSrc && videoTime === undefined ? (\n    <StyledImage\n      {...mouseEvents}\n      src={imageSrc}\n      ref={imageRef}\n      style={stylePosition}\n      onLoad={onImageLoaded}\n    />\n  ) : (\n    <Video\n      {...mouseEvents}\n      ref={videoRef}\n      style={stylePosition}\n      onLoadedMetadata={onLoadedVideoMetadata}\n      src={videoSrc || imageSrc}\n    />\n  )\n}\n","// @flow\n\nimport React, { memo } from \"react\"\nimport colorAlpha from \"color-alpha\"\n\nfunction clamp(num, min, max) {\n  return num <= min ? min : num >= max ? max : num\n}\n\nconst RegionComponents = {\n  point: memo(({ region, iw, ih }) => (\n    <g transform={`translate(${region.x * iw} ${region.y * ih})`}>\n      <path\n        d={\"M0 8L8 0L0 -8L-8 0Z\"}\n        strokeWidth={2}\n        stroke={region.color}\n        fill=\"transparent\"\n      />\n    </g>\n  )),\n  box: memo(({ region, iw, ih }) => (\n    <g transform={`translate(${region.x * iw} ${region.y * ih})`}>\n      <rect\n        strokeWidth={2}\n        x={0}\n        y={0}\n        width={region.w * iw}\n        height={region.h * ih}\n        stroke={colorAlpha(region.color, 0.75)}\n        fill={colorAlpha(region.color, 0.25)}\n      />\n    </g>\n  )),\n  polygon: memo(({ region, iw, ih, fullSegmentationMode }) => {\n    const Component = region.open ? \"polyline\" : \"polygon\"\n    const alphaBase = fullSegmentationMode ? 0.5 : 1\n    return (\n      <Component\n        points={region.points\n          .map(([x, y]) => [x * iw, y * ih])\n          .map((a) => a.join(\" \"))\n          .join(\" \")}\n        strokeWidth={2}\n        stroke={colorAlpha(region.color, 0.75)}\n        fill={colorAlpha(region.color, 0.25)}\n      />\n    )\n  }),\n  \"expanding-line\": memo(({ region, iw, ih }) => {\n    let { expandingWidth = 0.005, points } = region\n    expandingWidth = points.slice(-1)[0].width || expandingWidth\n    const pointPairs = points.map(({ x, y, angle, width }, i) => {\n      if (!angle) {\n        const n = points[clamp(i + 1, 0, points.length - 1)]\n        const p = points[clamp(i - 1, 0, points.length - 1)]\n        angle = Math.atan2(p.x - n.x, p.y - n.y) + Math.PI / 2\n      }\n      const dx = (Math.sin(angle) * (width || expandingWidth)) / 2\n      const dy = (Math.cos(angle) * (width || expandingWidth)) / 2\n      return [\n        { x: x + dx, y: y + dy },\n        { x: x - dx, y: y - dy },\n      ]\n    })\n    const firstSection = pointPairs.map(([p1, p2]) => p1)\n    const secondSection = pointPairs.map(([p1, p2]) => p2).asMutable()\n    secondSection.reverse()\n    const lastPoint = points.slice(-1)[0]\n    return (\n      <>\n        <polygon\n          points={firstSection\n            .concat(region.candidatePoint ? [region.candidatePoint] : [])\n            .concat(secondSection)\n            .map((p) => `${p.x * iw} ${p.y * ih}`)\n            .join(\" \")}\n          strokeWidth={2}\n          stroke={colorAlpha(region.color, 0.75)}\n          fill={colorAlpha(region.color, 0.25)}\n        />\n        {points.map(({ x, y, angle }, i) => (\n          <g\n            transform={`translate(${x * iw} ${y * ih}) rotate(${\n              (-(angle || 0) * 180) / Math.PI\n            })`}\n          >\n            <g>\n              <rect\n                x={-5}\n                y={-5}\n                width={10}\n                height={10}\n                strokeWidth={2}\n                stroke={colorAlpha(region.color, 0.75)}\n                fill={colorAlpha(region.color, 0.25)}\n              />\n            </g>\n          </g>\n        ))}\n        <rect\n          x={lastPoint.x * iw - 8}\n          y={lastPoint.y * ih - 8}\n          width={16}\n          height={16}\n          strokeWidth={4}\n          stroke={colorAlpha(region.color, 0.5)}\n          fill={\"transparent\"}\n        />\n      </>\n    )\n  }),\n  pixel: () => null,\n}\n\nexport const WrappedRegionList = memo(\n  ({ regions, iw, ih, fullSegmentationMode }) => {\n    return regions\n      .filter((r) => r.visible !== false)\n      .map((r) => {\n        const Component = RegionComponents[r.type]\n        return (\n          <Component\n            key={r.regionId}\n            region={r}\n            iw={iw}\n            ih={ih}\n            fullgeSegmentationMode={fullSegmentationMode}\n          />\n        )\n      })\n  },\n  (n, p) => n.regions === p.regions && n.iw === p.iw && n.ih === p.ih\n)\n\nexport const RegionShapes = ({\n  mat,\n  imagePosition,\n  regions = [],\n  fullSegmentationMode,\n}) => {\n  const iw = imagePosition.bottomRight.x - imagePosition.topLeft.x\n  const ih = imagePosition.bottomRight.y - imagePosition.topLeft.y\n  if (isNaN(iw) || isNaN(ih)) return null\n  return (\n    <svg\n      width={iw}\n      height={ih}\n      style={{\n        position: \"absolute\",\n        zIndex: 2,\n        left: imagePosition.topLeft.x,\n        top: imagePosition.topLeft.y,\n        pointerEvents: \"none\",\n        width: iw,\n        height: ih,\n      }}\n    >\n      <WrappedRegionList\n        regions={regions}\n        iw={iw}\n        ih={ih}\n        fullSegmentationMode={fullSegmentationMode}\n      />\n    </svg>\n  )\n}\n\nexport default RegionShapes\n","// @flow weak\n\nimport React, { useRef, useState, useLayoutEffect, useMemo } from \"react\"\nimport type { Node } from \"react\"\nimport { Matrix } from \"transformation-matrix-js\"\nimport Crosshairs from \"../Crosshairs\"\nimport type { Region, Point, Polygon, Box } from \"./region-tools.js\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport styles from \"./styles\"\nimport PreventScrollToParents from \"../PreventScrollToParents\"\nimport useWindowSize from \"../hooks/use-window-size.js\"\nimport useMouse from \"./use-mouse\"\nimport useProjectRegionBox from \"./use-project-box\"\nimport useExcludePattern from \"../hooks/use-exclude-pattern\"\nimport { useRafState } from \"react-use\"\nimport PointDistances from \"../PointDistances\"\nimport RegionTags from \"../RegionTags\"\nimport RegionLabel from \"../RegionLabel\"\nimport ImageMask from \"../ImageMask\"\nimport RegionSelectAndTransformBoxes from \"../RegionSelectAndTransformBoxes\"\nimport VideoOrImageCanvasBackground from \"../VideoOrImageCanvasBackground\"\nimport useEventCallback from \"use-event-callback\"\nimport RegionShapes from \"../RegionShapes\"\nimport useWasdMode from \"./use-wasd-mode\"\n\nconst useStyles = makeStyles(styles)\n\ntype Props = {\n  regions: Array<Region>,\n  imageSrc?: string,\n  videoSrc?: string,\n  videoTime?: number,\n  onMouseMove?: ({ x: number, y: number }) => any,\n  onMouseDown?: ({ x: number, y: number }) => any,\n  onMouseUp?: ({ x: number, y: number }) => any,\n  dragWithPrimary?: boolean,\n  zoomWithPrimary?: boolean,\n  createWithPrimary?: boolean,\n  showTags?: boolean,\n  realSize?: { width: number, height: number, unitName: string },\n  showCrosshairs?: boolean,\n  showMask?: boolean,\n  showHighlightBox?: boolean,\n  showPointDistances?: boolean,\n  pointDistancePrecision?: number,\n  regionClsList?: Array<string>,\n  regionTagList?: Array<string>,\n  allowedArea?: { x: number, y: number, w: number, h: number },\n  RegionEditLabel?: Node,\n  videoPlaying?: boolean,\n  fullImageSegmentationMode?: boolean,\n  autoSegmentationOptions?: Object,\n\n  onChangeRegion: (Region) => any,\n  onBeginRegionEdit: (Region) => any,\n  onCloseRegionEdit: (Region) => any,\n  onDeleteRegion: (Region) => any,\n  onBeginBoxTransform: (Box, [number, number]) => any,\n  onBeginMovePolygonPoint: (Polygon, index: number) => any,\n  onAddPolygonPoint: (Polygon, point: [number, number], index: number) => any,\n  onSelectRegion: (Region) => any,\n  onBeginMovePoint: (Point) => any,\n  onImageOrVideoLoaded: ({\n    naturalWidth: number,\n    naturalHeight: number,\n    duration?: number,\n  }) => any,\n  onChangeVideoTime: (number) => any,\n  onRegionClassAdded: () => {},\n  onChangeVideoPlaying?: Function,\n}\n\nconst getDefaultMat = () => Matrix.from(1, 0, 0, 1, -10, -10)\n\nexport const ImageCanvas = ({\n  regions,\n  imageSrc,\n  videoSrc,\n  videoTime,\n  realSize,\n  showTags,\n  onMouseMove = (p) => null,\n  onMouseDown = (p) => null,\n  onMouseUp = (p) => null,\n  dragWithPrimary = false,\n  zoomWithPrimary = false,\n  createWithPrimary = false,\n  pointDistancePrecision = 0,\n  regionClsList,\n  regionTagList,\n  showCrosshairs,\n  showHighlightBox = true,\n  showPointDistances,\n  allowedArea,\n  RegionEditLabel = null,\n  videoPlaying = false,\n  showMask = true,\n  fullImageSegmentationMode,\n  autoSegmentationOptions,\n  onImageOrVideoLoaded,\n  onChangeRegion,\n  onBeginRegionEdit,\n  onCloseRegionEdit,\n  onBeginBoxTransform,\n  onBeginMovePolygonPoint,\n  onAddPolygonPoint,\n  onSelectRegion,\n  onBeginMovePoint,\n  onDeleteRegion,\n  onChangeVideoTime,\n  onChangeVideoPlaying,\n  onRegionClassAdded,\n}: Props) => {\n  const classes = useStyles()\n\n  const canvasEl = useRef(null)\n  const layoutParams = useRef({})\n  const [dragging, changeDragging] = useRafState(false)\n  const [maskImagesLoaded, changeMaskImagesLoaded] = useRafState(0)\n  const [zoomStart, changeZoomStart] = useRafState(null)\n  const [zoomEnd, changeZoomEnd] = useRafState(null)\n  const [mat, changeMat] = useRafState(getDefaultMat())\n  const maskImages = useRef({})\n  const windowSize = useWindowSize()\n\n  const getLatestMat = useEventCallback(() => mat)\n  useWasdMode({ getLatestMat, changeMat })\n\n  const { mouseEvents, mousePosition } = useMouse({\n    canvasEl,\n    dragging,\n    mat,\n    layoutParams,\n    changeMat,\n    zoomStart,\n    zoomEnd,\n    changeZoomStart,\n    changeZoomEnd,\n    changeDragging,\n    zoomWithPrimary,\n    dragWithPrimary,\n    onMouseMove,\n    onMouseDown,\n    onMouseUp,\n  })\n\n  useLayoutEffect(() => changeMat(mat.clone()), [windowSize])\n\n  const innerMousePos = mat.applyToPoint(\n    mousePosition.current.x,\n    mousePosition.current.y\n  )\n\n  const projectRegionBox = useProjectRegionBox({ layoutParams, mat })\n\n  const [imageDimensions, changeImageDimensions] = useState()\n  const imageLoaded = Boolean(imageDimensions && imageDimensions.naturalWidth)\n  const onVideoOrImageLoaded = useEventCallback(\n    ({ naturalWidth, naturalHeight, duration }) => {\n      const dims = { naturalWidth, naturalHeight, duration }\n      if (onImageOrVideoLoaded) onImageOrVideoLoaded(dims)\n      changeImageDimensions(dims)\n      // Redundant update to fix rerendering issues\n      setTimeout(() => changeImageDimensions(dims), 10)\n    }\n  )\n\n  const excludePattern = useExcludePattern()\n\n  const canvas = canvasEl.current\n  if (canvas && imageLoaded) {\n    const { clientWidth, clientHeight } = canvas\n\n    const fitScale = Math.max(\n      imageDimensions.naturalWidth / (clientWidth - 20),\n      imageDimensions.naturalHeight / (clientHeight - 20)\n    )\n\n    const [iw, ih] = [\n      imageDimensions.naturalWidth / fitScale,\n      imageDimensions.naturalHeight / fitScale,\n    ]\n\n    layoutParams.current = {\n      iw,\n      ih,\n      fitScale,\n      canvasWidth: clientWidth,\n      canvasHeight: clientHeight,\n    }\n  }\n\n  useLayoutEffect(() => {\n    if (!imageDimensions) return\n    const { clientWidth, clientHeight } = canvas\n    canvas.width = clientWidth\n    canvas.height = clientHeight\n    const context = canvas.getContext(\"2d\")\n\n    context.save()\n    context.transform(...mat.clone().inverse().toArray())\n\n    const { iw, ih } = layoutParams.current\n\n    if (allowedArea) {\n      // Pattern to indicate the NOT allowed areas\n      const { x, y, w, h } = allowedArea\n      context.save()\n      context.globalAlpha = 1\n      const outer = [\n        [0, 0],\n        [iw, 0],\n        [iw, ih],\n        [0, ih],\n      ]\n      const inner = [\n        [x * iw, y * ih],\n        [x * iw + w * iw, y * ih],\n        [x * iw + w * iw, y * ih + h * ih],\n        [x * iw, y * ih + h * ih],\n      ]\n      context.moveTo(...outer[0])\n      outer.forEach((p) => context.lineTo(...p))\n      context.lineTo(...outer[0])\n      context.closePath()\n\n      inner.reverse()\n      context.moveTo(...inner[0])\n      inner.forEach((p) => context.lineTo(...p))\n      context.lineTo(...inner[0])\n\n      context.fillStyle = excludePattern || \"#f00\"\n      context.fill()\n\n      context.restore()\n    }\n\n    context.restore()\n  })\n\n  const { iw, ih } = layoutParams.current\n\n  let zoomBox =\n    !zoomStart || !zoomEnd\n      ? null\n      : {\n          ...mat.clone().inverse().applyToPoint(zoomStart.x, zoomStart.y),\n          w: (zoomEnd.x - zoomStart.x) / mat.a,\n          h: (zoomEnd.y - zoomStart.y) / mat.d,\n        }\n  if (zoomBox) {\n    if (zoomBox.w < 0) {\n      zoomBox.x += zoomBox.w\n      zoomBox.w *= -1\n    }\n    if (zoomBox.h < 0) {\n      zoomBox.y += zoomBox.h\n      zoomBox.h *= -1\n    }\n  }\n\n  const imagePosition = {\n    topLeft: mat.clone().inverse().applyToPoint(0, 0),\n    bottomRight: mat.clone().inverse().applyToPoint(iw, ih),\n  }\n\n  const highlightedRegion = useMemo(() => {\n    const highlightedRegions = regions.filter((r) => r.highlighted)\n    if (highlightedRegions.length !== 1) return null\n    return highlightedRegions[0]\n  }, [regions])\n\n  return (\n    <div\n      style={{\n        width: \"100%\",\n        height: \"100%\",\n        maxHeight: \"calc(100vh - 68px)\",\n        position: \"relative\",\n        overflow: \"hidden\",\n        cursor: createWithPrimary\n          ? \"crosshair\"\n          : dragging\n          ? \"grabbing\"\n          : dragWithPrimary\n          ? \"grab\"\n          : zoomWithPrimary\n          ? mat.a < 1\n            ? \"zoom-out\"\n            : \"zoom-in\"\n          : undefined,\n      }}\n    >\n      {showCrosshairs && (\n        <Crosshairs key=\"crossHairs\" mousePosition={mousePosition} />\n      )}\n      {imageLoaded && !dragging && (\n        <RegionSelectAndTransformBoxes\n          key=\"regionSelectAndTransformBoxes\"\n          regions={regions}\n          mouseEvents={mouseEvents}\n          projectRegionBox={projectRegionBox}\n          dragWithPrimary={dragWithPrimary}\n          createWithPrimary={createWithPrimary}\n          zoomWithPrimary={zoomWithPrimary}\n          onBeginMovePoint={onBeginMovePoint}\n          onSelectRegion={onSelectRegion}\n          layoutParams={layoutParams}\n          mat={mat}\n          onBeginBoxTransform={onBeginBoxTransform}\n          onBeginMovePolygonPoint={onBeginMovePolygonPoint}\n          onAddPolygonPoint={onAddPolygonPoint}\n          showHighlightBox={showHighlightBox}\n        />\n      )}\n      {imageLoaded && showTags && !dragging && (\n        <PreventScrollToParents key=\"regionTags\">\n          <RegionTags\n            regions={regions}\n            projectRegionBox={projectRegionBox}\n            mouseEvents={mouseEvents}\n            regionClsList={regionClsList}\n            regionTagList={regionTagList}\n            onBeginRegionEdit={onBeginRegionEdit}\n            onChangeRegion={onChangeRegion}\n            onCloseRegionEdit={onCloseRegionEdit}\n            onDeleteRegion={onDeleteRegion}\n            layoutParams={layoutParams}\n            imageSrc={imageSrc}\n            RegionEditLabel={RegionEditLabel}\n            onRegionClassAdded={onRegionClassAdded}\n          />\n        </PreventScrollToParents>\n      )}\n      {!showTags && highlightedRegion && (\n        <div key=\"topLeftTag\" className={classes.fixedRegionLabel}>\n          <RegionLabel\n            disableClose\n            allowedClasses={regionClsList}\n            allowedTags={regionTagList}\n            onChange={onChangeRegion}\n            onDelete={onDeleteRegion}\n            editing\n            region={highlightedRegion}\n            imageSrc={imageSrc}\n          />\n        </div>\n      )}\n\n      {zoomWithPrimary && zoomBox !== null && (\n        <div\n          key=\"zoomBox\"\n          style={{\n            position: \"absolute\",\n            zIndex: 1,\n            border: \"1px solid #fff\",\n            pointerEvents: \"none\",\n            left: zoomBox.x,\n            top: zoomBox.y,\n            width: zoomBox.w,\n            height: zoomBox.h,\n          }}\n        />\n      )}\n      {showPointDistances && (\n        <PointDistances\n          key=\"pointDistances\"\n          regions={regions}\n          realSize={realSize}\n          projectRegionBox={projectRegionBox}\n          pointDistancePrecision={pointDistancePrecision}\n        />\n      )}\n      <PreventScrollToParents\n        style={{ width: \"100%\", height: \"100%\" }}\n        {...mouseEvents}\n      >\n        <>\n          {fullImageSegmentationMode && (\n            <ImageMask\n              hide={!showMask}\n              autoSegmentationOptions={autoSegmentationOptions}\n              imagePosition={imagePosition}\n              regionClsList={regionClsList}\n              imageSrc={imageSrc}\n              regions={regions}\n            />\n          )}\n          <canvas\n            style={{ opacity: 0.25 }}\n            className={classes.canvas}\n            ref={canvasEl}\n          />\n          <RegionShapes\n            mat={mat}\n            imagePosition={imagePosition}\n            regions={regions}\n            fullSegmentationMode={fullImageSegmentationMode}\n          />\n          <VideoOrImageCanvasBackground\n            videoPlaying={videoPlaying}\n            imagePosition={imagePosition}\n            mouseEvents={mouseEvents}\n            onLoad={onVideoOrImageLoaded}\n            videoTime={videoTime}\n            videoSrc={videoSrc}\n            imageSrc={imageSrc}\n            onChangeVideoTime={onChangeVideoTime}\n            onChangeVideoPlaying={onChangeVideoPlaying}\n          />\n        </>\n      </PreventScrollToParents>\n      <div className={classes.zoomIndicator}>\n        {((1 / mat.a) * 100).toFixed(0)}%\n      </div>\n    </div>\n  )\n}\n\nexport default ImageCanvas\n","import { grey } from \"@material-ui/core/colors\"\n\nexport default {\n  canvas: { width: \"100%\", height: \"100%\", position: \"relative\", zIndex: 1 },\n  zoomIndicator: {\n    position: \"absolute\",\n    bottom: 16,\n    right: 0,\n    backgroundColor: \"rgba(0,0,0,0.4)\",\n    color: \"#fff\",\n    opacity: 0.5,\n    fontWeight: \"bolder\",\n    fontSize: 14,\n    padding: 4,\n  },\n  fixedRegionLabel: {\n    position: \"absolute\",\n    zIndex: 10,\n    top: 10,\n    left: 10,\n    opacity: 0.5,\n    transition: \"opacity 500ms\",\n    \"&:hover\": {\n      opacity: 1,\n    },\n  },\n}\n","import { useEffect } from \"react\"\nimport { useSettings } from \"../SettingsProvider\"\n\nexport default ({ getLatestMat, changeMat }) => {\n  const { wasdMode } = useSettings()\n  useEffect(() => {\n    if (!wasdMode) return\n    const vel = 10\n    const dirs = {\n      w: [0, -vel],\n      a: [-vel, 0],\n      s: [0, vel],\n      d: [vel, 0],\n    }\n    const keysDown = {}\n    const keys = Object.keys(dirs)\n    const keyDownListener = (e) => {\n      if (keys.includes(e.key)) {\n        keysDown[e.key] = true\n        e.preventDefault()\n        e.stopPropagation()\n      }\n    }\n    const keyUpListener = (e) => {\n      if (keys.includes(e.key)) {\n        keysDown[e.key] = false\n        e.preventDefault()\n        e.stopPropagation()\n      }\n    }\n    const interval = setInterval(() => {\n      let newMat = getLatestMat().clone()\n      let somethingChanged = false\n      for (const key in keysDown) {\n        if (keysDown[key]) {\n          newMat = newMat.translate(...dirs[key])\n          somethingChanged = true\n        }\n      }\n      if (somethingChanged) changeMat(newMat)\n    }, 16)\n    window.addEventListener(\"keydown\", keyDownListener)\n    window.addEventListener(\"keyup\", keyUpListener)\n    return () => {\n      clearInterval(interval)\n      window.removeEventListener(\"keydown\", keyDownListener)\n      window.removeEventListener(\"keyup\", keyUpListener)\n    }\n  }, [wasdMode])\n}\n","// @flow weak\n\nimport { useRef } from \"react\"\nimport excludePatternSrc from \"./xpattern.js\"\n\nexport default () => {\n  const excludePattern = useRef(null)\n  if (excludePattern.current === null) {\n    excludePattern.current = {\n      image: new Image(),\n      pattern: null,\n    }\n    const canvas = document.createElement(\"canvas\")\n    canvas.width = 100\n    canvas.height = 100\n    const context = canvas.getContext(\"2d\")\n\n    excludePattern.current.image.onload = () => {\n      excludePattern.current.pattern = context.createPattern(\n        excludePattern.current.image,\n        \"repeat\"\n      )\n    }\n    excludePattern.current.image.src = excludePatternSrc\n  }\n  return excludePattern.current.pattern\n}\n","export default `data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4wMSAxY5oG+lzgAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAAcSURBVAjXY/jPwPCfAQnA+TAGugLcAhhakRUAAK3lEe8m9qZhAAAAAElFTkSuQmCC`\n","// @flow\n\nimport React, { memo, createContext, useContext } from \"react\"\nimport { styled } from \"@material-ui/core/styles\"\nimport Button from \"@material-ui/core/Button\"\nimport useEventCallback from \"use-event-callback\"\n\nconst StyledButton = styled(Button)({\n  width: 80,\n  margin: 2,\n})\n\nconst IconName = styled(\"div\")({\n  fontWeight: \"bold\",\n})\n\nexport const HeaderButtonContext = createContext()\n\nconst MemoizedHeaderButton = memo(\n  ({ name, disabled, Icon, onClick }) => (\n    <StyledButton disabled={disabled} onClick={onClick}>\n      <div>\n        <Icon />\n        <IconName>{name}</IconName>\n      </div>\n    </StyledButton>\n  ),\n  (prevProps, nextProps) =>\n    prevProps.name === nextProps.name &&\n    prevProps.disabled === nextProps.disabled\n)\n\nexport const HeaderButton = ({\n  name,\n  disabled,\n  Icon,\n}: {\n  name: string,\n  disabled?: boolean,\n  Icon: any,\n}) => {\n  const { onHeaderButtonClick } = useContext(HeaderButtonContext)\n  const onClick = useEventCallback(() => onHeaderButtonClick(name))\n  return (\n    <MemoizedHeaderButton\n      name={name}\n      disabled={disabled}\n      Icon={Icon}\n      onClick={onClick}\n    />\n  )\n}\n\nexport default HeaderButton\n","import { grey } from \"@material-ui/core/colors\"\n\nexport default {\n  header: {\n    display: \"flex\",\n    position: \"relative\",\n    flexDirection: \"row\",\n    flexShrink: 0,\n    zIndex: 10,\n    boxShadow: \"0px 3px 8px rgba(0,0,0,.1)\",\n  },\n  fileInfo: {\n    alignItems: \"center\",\n    flexGrow: 1,\n    \"&.videoMode\": {\n      flexMode: 0.1,\n    },\n    display: \"flex\",\n    fontWeight: \"bold\",\n    color: grey[800],\n    marginRight: 16,\n    fontSize: 24,\n    paddingLeft: 16,\n  },\n}\n","// @flow weak\n\nimport React, { useMemo, useState, useEffect } from \"react\"\nimport { styled } from \"@material-ui/core/styles\"\nimport range from \"lodash/range\"\nimport * as colors from \"@material-ui/core/colors\"\nimport useMeasure from \"react-use-measure\"\nimport useEventCallback from \"use-event-callback\"\nimport { useRafState } from \"react-use\"\nimport getTimeString from \"./get-time-string\"\n\nconst Container = styled(\"div\")({\n  position: \"relative\",\n  display: \"flex\",\n  flexGrow: 1,\n  minWidth: 240,\n  marginLeft: 16,\n  marginRight: 16,\n})\n\nconst Tick = styled(\"div\")({\n  position: \"absolute\",\n  width: 2,\n  marginLeft: -1,\n  height: \"100%\",\n  backgroundColor: colors.grey[300],\n  bottom: 0,\n})\nconst TickText = styled(\"div\")({\n  position: \"absolute\",\n  userSelect: \"none\",\n  fontSize: 10,\n  color: colors.grey[600],\n  fontWeight: \"bold\",\n  bottom: 0,\n})\n\nconst PositionCursor = styled(\"div\")({\n  position: \"absolute\",\n  bottom: \"calc(50% + 6px)\",\n  fontSize: 10,\n  fontWeight: \"bold\",\n  color: \"#fff\",\n  display: \"grid\",\n  placeItems: \"center\",\n  width: 48,\n  marginLeft: -24,\n  borderRadius: 2,\n  height: 24,\n  backgroundColor: colors.blue[500],\n  userSelect: \"none\",\n  fontVariantNumeric: \"tabular-nums\",\n\n  \"&::before\": {\n    position: \"absolute\",\n    bottom: -6,\n    left: 24 - 8,\n    content: '\"\"',\n    width: 0,\n    height: 0,\n    borderTop: `8px solid ${colors.blue[500]}`,\n    borderLeft: \"8px solid transparent\",\n    borderRight: \"8px solid transparent\",\n  },\n})\n\nconst KeyframeMarker = styled(\"div\")({\n  position: \"absolute\",\n  bottom: 8,\n  cursor: \"pointer\",\n  opacity: 0.75,\n  fontSize: 10,\n  fontWeight: \"bold\",\n  color: \"#fff\",\n  display: \"grid\",\n  placeItems: \"center\",\n  width: 16,\n  marginLeft: 0,\n  borderTopLeftRadius: 2,\n  borderTopRightRadius: 2,\n  height: 12,\n  marginLeft: -8,\n  backgroundColor: colors.red[500],\n  userSelect: \"none\",\n  fontVariantNumeric: \"tabular-nums\",\n\n  \"&::before\": {\n    position: \"absolute\",\n    bottom: -8,\n    left: 0,\n    content: '\"\"',\n    width: 0,\n    height: 0,\n    borderTop: `8px solid ${colors.red[500]}`,\n    borderLeft: \"8px solid transparent\",\n    borderRight: \"8px solid transparent\",\n  },\n})\n\nconst min = 60000\nconst displayIntervalPairs = [\n  [50, 250],\n  [100, 500],\n  [250, 1000],\n  [1000, 5000],\n  [5000, 30000],\n  [10000, min],\n  [30000, min * 2],\n  [min, min * 5],\n  [min * 5, min * 30],\n  [min * 10, min * 60],\n  [min * 30, min * 60 * 3],\n  [min * 60, min * 60 * 5],\n]\n\nconst getMajorInterval = (duration) => {\n  for (const [minor, major] of displayIntervalPairs) {\n    if (duration / major < 6 && duration / major > 2) {\n      return [minor, major]\n    }\n  }\n  return [duration / 4, duration]\n}\n\nexport default ({\n  currentTime = 0,\n  duration,\n  onChangeCurrentTime,\n  keyframes,\n}) => {\n  const [ref, bounds] = useMeasure()\n  const [instantCurrentTime, changeInstantCurrentTime] = useState(currentTime)\n  const [draggingTime, changeDraggingTime] = useRafState(false)\n  const keyframeTimes = Object.keys(keyframes || {})\n    .map((t) => parseInt(t))\n    .filter((t) => !isNaN(t))\n    .sort((a, b) => a - b)\n\n  useEffect(() => {\n    if (currentTime !== instantCurrentTime) {\n      changeInstantCurrentTime(currentTime)\n    }\n  }, [currentTime])\n\n  const [minorInterval, majorInterval] = useMemo(\n    () => getMajorInterval(duration),\n    [duration]\n  )\n\n  const onMouseMove = useEventCallback((e) => {\n    if (draggingTime) {\n      const px = (e.clientX - bounds.left) / bounds.width\n      changeInstantCurrentTime(\n        Math.min(duration, Math.max(0, Math.floor(px * duration)))\n      )\n    }\n  })\n\n  const onMouseUp = useEventCallback((e) => {\n    changeDraggingTime(false)\n    const px = (e.clientX - bounds.left) / bounds.width\n    const newTime = Math.min(duration, Math.max(0, Math.floor(px * duration)))\n    changeInstantCurrentTime(newTime)\n    onChangeCurrentTime(newTime)\n  })\n\n  // TODO skeleton\n  if (!duration) return null\n\n  return (\n    <Container onMouseMove={onMouseMove} onMouseUp={onMouseUp} ref={ref}>\n      {range(0, duration, majorInterval).map((a) => (\n        <>\n          <Tick\n            key={a}\n            style={{ left: (a / duration) * bounds.width, height: \"50%\" }}\n          />\n          <TickText\n            style={{\n              left: (a / duration) * bounds.width + 8,\n              bottom: \"calc(50% - 12px)\",\n            }}\n          >\n            {getTimeString(a)}\n          </TickText>\n        </>\n      ))}\n      {range(0, duration, minorInterval)\n        .filter((a) => !Number.isInteger(a / majorInterval))\n        .map((a) => (\n          <Tick\n            key={a}\n            style={{\n              left: (a / duration) * bounds.width,\n              height: \"25%\",\n            }}\n          />\n        ))}\n      {keyframeTimes.map((kt) => (\n        <KeyframeMarker\n          onClick={() => onChangeCurrentTime(kt)}\n          key={kt}\n          style={{ left: (kt / duration) * bounds.width }}\n        />\n      ))}\n      <PositionCursor\n        onMouseDown={(e) => changeDraggingTime(true)}\n        style={{\n          cursor: draggingTime ? \"grabbing\" : \"grab\",\n          left: (instantCurrentTime / duration) * bounds.width,\n        }}\n      >\n        {getTimeString(instantCurrentTime)}\n      </PositionCursor>\n    </Container>\n  )\n}\n","// @flow\n\nimport React from \"react\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport HeaderButton, { HeaderButtonContext } from \"../HeaderButton\"\nimport BackIcon from \"@material-ui/icons/KeyboardArrowLeft\"\nimport NextIcon from \"@material-ui/icons/KeyboardArrowRight\"\nimport PlayIcon from \"@material-ui/icons/PlayArrow\"\nimport PauseIcon from \"@material-ui/icons/Pause\"\nimport SettingsIcon from \"@material-ui/icons/Settings\"\nimport HelpIcon from \"@material-ui/icons/Help\"\nimport FullscreenIcon from \"@material-ui/icons/Fullscreen\"\nimport ExitIcon from \"@material-ui/icons/ExitToApp\"\nimport QueuePlayNextIcon from \"@material-ui/icons/QueuePlayNext\"\nimport HotkeysIcon from \"@material-ui/icons/Keyboard\"\nimport styles from \"./styles\"\nimport KeyframeTimeline from \"../KeyframeTimeline\"\nimport classnames from \"classnames\"\n\nconst useStyles = makeStyles(styles)\n\ntype Props = {\n  onHeaderButtonClick: (string) => any,\n  title: string,\n  inFullScreen?: boolean,\n  multipleImages?: boolean,\n  isAVideoFrame?: boolean,\n  nextVideoFrameHasRegions?: boolean,\n  videoDuration?: number,\n  videoPlaying?: boolean,\n\n  onChangeCurrentTime?: (newTime: number) => any,\n  onPlayVideo?: Function,\n  onPauseVideo?: Function,\n}\n\nexport const Header = ({\n  onHeaderButtonClick,\n  title,\n  inFullScreen,\n  videoMode,\n  isAVideoFrame = false,\n  nextVideoFrameHasRegions = false,\n  videoDuration,\n  currentVideoTime,\n  multipleImages,\n  videoPlaying,\n  onChangeCurrentTime,\n  keyframes,\n  alwaysShowPrevButton,\n  alwaysShowNextButton,\n}: Props) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.header}>\n      <div className={classnames(classes.fileInfo, videoMode && \"videoMode\")}>\n        {title}\n      </div>\n      {videoMode && (\n        <KeyframeTimeline\n          key=\"keyframeTimeline\"\n          currentTime={currentVideoTime}\n          duration={videoDuration}\n          onChangeCurrentTime={onChangeCurrentTime}\n          keyframes={keyframes}\n        />\n      )}\n      <div className={classes.headerActions}>\n        <HeaderButtonContext.Provider value={{ onHeaderButtonClick }}>\n          {(multipleImages || alwaysShowPrevButton) && (\n            <HeaderButton name=\"Prev\" Icon={BackIcon} />\n          )}\n          {(multipleImages || alwaysShowNextButton) && (\n            <>\n              <HeaderButton name=\"Next\" Icon={NextIcon} />\n              <HeaderButton\n                name=\"Clone\"\n                disabled={nextVideoFrameHasRegions}\n                Icon={QueuePlayNextIcon}\n              />\n            </>\n          )}\n          {videoMode && (\n            <>\n              {!videoPlaying ? (\n                <HeaderButton key=\"play\" name=\"Play\" Icon={PlayIcon} />\n              ) : (\n                <HeaderButton key=\"pause\" name=\"Pause\" Icon={PauseIcon} />\n              )}\n            </>\n          )}\n          <HeaderButton name=\"Settings\" Icon={SettingsIcon} />\n          {/* <HeaderButton name=\"Help\" Icon={HelpIcon} /> */}\n          {inFullScreen ? (\n            <HeaderButton name=\"Window\" Icon={FullscreenIcon} />\n          ) : (\n            <HeaderButton name=\"Fullscreen\" Icon={FullscreenIcon} />\n          )}\n          {/* <HeaderButton name=\"Hotkeys\" Icon={HotkeysIcon} /> */}\n          <HeaderButton name=\"Save\" Icon={ExitIcon} />\n        </HeaderButtonContext.Provider>\n      </div>\n    </div>\n  )\n}\n\nexport default Header\n","// @flow\n\nimport React, { createContext, useContext, memo } from \"react\"\nimport IconButton from \"@material-ui/core/IconButton\"\nimport Tooltip from \"@material-ui/core/Tooltip\"\nimport { blue } from \"@material-ui/core/colors\"\n\nexport const SelectedTool = createContext()\n\nexport const SmallToolButton = ({\n  id,\n  name,\n  icon,\n  selected,\n  togglable,\n  alwaysShowing = false,\n}: {\n  id: string,\n  name: string,\n  icon: any,\n  alwaysShowing?: boolean,\n  selected?: boolean,\n  togglable?: boolean,\n}) => {\n  const { enabledTools, selectedTool, onClickTool } = useContext(SelectedTool)\n  if (!enabledTools.includes(id) && !alwaysShowing) return null\n  selected = selected || selectedTool === id\n  return (\n    <Tooltip placement=\"right\" title={name}>\n      <div>\n        <IconButton\n          disabled={!togglable ? selected : undefined}\n          aria-label={name}\n          onClick={() => onClickTool(id)}\n          size=\"small\"\n          style={{\n            width: 50,\n            height: 50,\n            margin: 1,\n            color: selected ? blue[500] : undefined,\n          }}\n        >\n          {icon}\n        </IconButton>\n      </div>\n    </Tooltip>\n  )\n}\n\nexport default memo(\n  SmallToolButton,\n  (prevProps, nextProps) =>\n    prevProps.togglable === nextProps.togglable &&\n    prevProps.selected === nextProps.selected &&\n    prevProps.name === nextProps.name &&\n    prevProps.id === nextProps.id\n)\n","// @flow\n\nimport React, { useMemo } from \"react\"\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport {\n  faArrowsAlt,\n  faMousePointer,\n  faExpandArrowsAlt,\n  faGripLines,\n  faTag,\n  faPaintBrush,\n  faCrosshairs,\n  faDrawPolygon,\n  faVectorSquare,\n  faHandPaper,\n  faSearch,\n  faMask,\n} from \"@fortawesome/free-solid-svg-icons\"\nimport SmallToolButton, { SelectedTool } from \"../SmallToolButton\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport { grey } from \"@material-ui/core/colors\"\n\nconst useStyles = makeStyles({\n  iconTools: {\n    display: \"flex\",\n    padding: 4,\n    flexDirection: \"column\",\n    zIndex: 9,\n    boxShadow: \"0px 0px 5px rgba(0,0,0,0.1)\",\n    borderRight: `1px solid ${grey[300]}`,\n    backgroundColor: grey[100],\n  },\n  grow: { flexGrow: 1 },\n})\n\ntype Props = {\n  showTags?: boolean,\n  showMask?: boolean,\n  enabledTools?: Array<string>,\n  selectedTool: string,\n  onClickTool: (string) => any,\n}\n\nconst defaultTools = [\n  \"select\",\n  \"create-point\",\n  \"create-box\",\n  \"create-polygon\",\n  \"create-expanding-line\",\n]\n\nexport const IconTools = ({\n  showTags,\n  showMask,\n  selectedTool,\n  onClickTool,\n  enabledTools = defaultTools,\n}: Props) => {\n  const classes = useStyles()\n  const selectedToolContextValue = useMemo(\n    () => ({ enabledTools, selectedTool, onClickTool }),\n    [enabledTools, selectedTool]\n  )\n  return (\n    <div className={classes.iconTools}>\n      <SelectedTool.Provider value={selectedToolContextValue}>\n        <SmallToolButton\n          id=\"select\"\n          name=\"Select Region\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faMousePointer} />}\n        />\n        <SmallToolButton\n          alwaysShowing\n          id=\"pan\"\n          name=\"Drag/Pan\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faHandPaper} />}\n        />\n        <SmallToolButton\n          alwaysShowing\n          id=\"zoom\"\n          name=\"Zoom In/Out\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faSearch} />}\n        />\n        {/* <SmallToolButton\n          name=\"Move Region\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faArrowsAlt} />}\n        />\n        <SmallToolButton\n          name=\"Resize Region\"\n          icon={\n            <FontAwesomeIcon size=\"xs\" fixedWidth icon={faExpandArrowsAlt} />\n          }\n        /> */}\n        <SmallToolButton\n          alwaysShowing\n          togglable\n          id=\"show-tags\"\n          selected={showTags}\n          name=\"Show Tags\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faTag} />}\n        />\n        <SmallToolButton\n          id=\"create-point\"\n          name=\"Add Point\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faCrosshairs} />}\n        />\n        <SmallToolButton\n          id=\"create-box\"\n          name=\"Add Bounding Box\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faVectorSquare} />}\n        />\n        <SmallToolButton\n          id=\"create-polygon\"\n          name=\"Add Polygon\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faDrawPolygon} />}\n        />\n        <SmallToolButton\n          id=\"create-expanding-line\"\n          name=\"Add Expanding Line\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faGripLines} />}\n        />\n        <SmallToolButton\n          togglable\n          selected={showMask}\n          id=\"show-mask\"\n          name=\"Show / Hide Mask\"\n          icon={<FontAwesomeIcon size=\"xs\" fixedWidth icon={faMask} />}\n        />\n      </SelectedTool.Provider>\n    </div>\n  )\n}\n\nexport default IconTools\n","import { grey } from \"@material-ui/core/colors\"\n\nexport default {\n  container: {\n    display: \"flex\",\n    flexGrow: 1,\n    flexDirection: \"column\",\n    height: \"100%\",\n    maxHeight: \"100vh\",\n    backgroundColor: \"#fff\",\n    overflow: \"hidden\",\n    \"&.fullscreen\": {\n      position: \"absolute\",\n      zIndex: 99999,\n      left: 0,\n      right: 0,\n      top: 0,\n      bottom: 0,\n    },\n  },\n  workspace: {\n    backgroundColor: grey[200],\n    flexGrow: 1,\n    display: \"flex\",\n    flexDirection: \"row\",\n    height: \"100%\",\n    overflow: \"hidden\",\n  },\n  iconToolsContainer: { display: \"flex\" },\n  imageCanvasContainer: {\n    display: \"flex\",\n    flexGrow: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  noImageSelected: {\n    fontWeight: \"bold\",\n    fontSize: 32,\n    color: grey[500],\n  },\n  sidebarContainer: {\n    width: 300,\n    flexShrink: 0,\n    overflowY: \"auto\",\n    backgroundColor: grey[100],\n    borderLeft: `1px solid ${grey[300]}`,\n    zIndex: 9,\n    height: \"100%\",\n    boxShadow: \"0px 0px 5px rgba(0,0,0,0.1)\",\n  },\n}\n","// @flow\n\nimport React from \"react\"\nimport Dialog from \"@material-ui/core/Dialog\"\nimport DialogTitle from \"@material-ui/core/DialogTitle\"\nimport DialogContent from \"@material-ui/core/DialogContent\"\nimport DialogActions from \"@material-ui/core/DialogActions\"\nimport Button from \"@material-ui/core/Button\"\nimport Survey from \"material-survey/components/Survey\"\nimport { useSettings } from \"../SettingsProvider\"\n\nexport const SettingsDialog = ({ open, onClose }) => {\n  const settings = useSettings()\n  return (\n    <Dialog open={open || false} onClose={onClose}>\n      <DialogTitle>Settings</DialogTitle>\n      <DialogContent style={{ minWidth: 400 }}>\n        <Survey\n          variant=\"flat\"\n          noActions\n          defaultAnswers={settings}\n          onQuestionChange={(q, a, answers) => settings.changeSetting(q, a)}\n          form={{\n            questions: [\n              {\n                type: \"boolean\",\n                title: \"Show Crosshairs\",\n                name: \"showCrosshairs\",\n              },\n              {\n                type: \"boolean\",\n                title: \"Show Highlight Box\",\n                name: \"showHighlightBox\",\n              },\n              {\n                type: \"boolean\",\n                title: \"WASD Mode\",\n                name: \"wasdMode\",\n              },\n              {\n                type: \"dropdown\",\n                title: \"Video Playback Speed\",\n                name: \"videoPlaybackSpeed\",\n                defaultValue: \"1x\",\n                choices: [\"0.25x\", \"0.5x\", \"1x\", \"2x\"],\n              },\n            ],\n          }}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onClose}>Close</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nexport default SettingsDialog\n","// @flow\n\nimport React from \"react\"\nimport ReactFullscreen from \"react-full-screen\"\n\nexport const Fullscreen = (props) => {\n  if (!props.enabled) return props.children\n  return <ReactFullscreen {...props}>{props.children}</ReactFullscreen>\n}\n\nexport default Fullscreen\n","import { getIn } from \"seamless-immutable\"\n\nexport default (state) => {\n  let currentImageIndex = null,\n    pathToActiveImage,\n    activeImage\n  if (state.annotationType === \"image\") {\n    currentImageIndex = state.images.findIndex(\n      (img) =>\n        img.src === state.selectedImage &&\n        (state.selectedImageFrameTime === undefined ||\n          img.frameTime === state.selectedImageFrameTime)\n    )\n    if (currentImageIndex === -1) {\n      currentImageIndex = null\n      activeImage = null\n    } else {\n      pathToActiveImage = [\"images\", currentImageIndex]\n      activeImage = getIn(state, pathToActiveImage)\n    }\n  } else if (state.annotationType === \"video\") {\n    pathToActiveImage = [\"keyframes\", state.currentVideoTime || 0]\n    activeImage = getIn(state, pathToActiveImage) || null\n  }\n  return { currentImageIndex, pathToActiveImage, activeImage }\n}\n","import React, { useMemo } from \"react\"\nimport { HotKeys } from \"react-hotkeys\"\n\nexport const defaultHotkeys = [\n  {\n    id: \"select_tool\",\n    description: \"Switch to the Select Tool\",\n    binding: \"escape\",\n  },\n  {\n    id: \"zoom_tool\",\n    description: \"Select the Zoom Tool\",\n    binding: \"z\",\n  },\n  {\n    id: \"create_point\",\n    description: \"Create a point\",\n  },\n  {\n    id: \"create_bounding_box\",\n    description: \"Create a bounding box\",\n    binding: \"b\",\n  },\n  {\n    id: \"pan_tool\",\n    description: \"Select the Pan Tool\",\n    binding: \"m\",\n  },\n  {\n    id: \"create_polygon\",\n    description: \"Create a Polygon\",\n    binding: \"p\",\n  },\n  {\n    id: \"create_pixel\",\n    description: \"Create a Pixel Mask\",\n  },\n  {\n    id: \"save_and_previous_sample\",\n    description: \"Save and go to previous sample\",\n    binding: \"ArrowLeft\",\n  },\n  {\n    id: \"save_and_next_sample\",\n    description: \"Save and go to next sample\",\n    binding: \"ArrowRight\",\n  },\n  {\n    id: \"save_and_exit_sample\",\n    description: \"Save and exit current sample\",\n  },\n  {\n    id: \"exit_sample\",\n    description: \"Exit sample without saving\",\n  },\n]\nexport const defaultKeyMap = {}\nfor (const { id, binding } of defaultHotkeys) defaultKeyMap[id] = binding\n\nexport const useDispatchHotkeyHandlers = ({ dispatch }) => {\n  const handlers = useMemo(\n    () => ({\n      select_tool: () => {\n        dispatch({\n          type: \"SELECT_TOOL\",\n          selectedTool: \"select\",\n        })\n      },\n      zoom_tool: () => {\n        dispatch({\n          type: \"SELECT_TOOL\",\n          selectedTool: \"zoom\",\n        })\n      },\n      create_point: () => {\n        dispatch({\n          type: \"SELECT_TOOL\",\n          selectedTool: \"create-point\",\n        })\n      },\n      create_bounding_box: () => {\n        dispatch({\n          type: \"SELECT_TOOL\",\n          selectedTool: \"create-box\",\n        })\n      },\n      pan_tool: () => {\n        dispatch({\n          type: \"SELECT_TOOL\",\n          selectedTool: \"pan\",\n        })\n      },\n      create_polygon: () => {\n        dispatch({\n          type: \"SELECT_TOOL\",\n          selectedTool: \"create-polygon\",\n        })\n      },\n      create_pixel: () => {\n        dispatch({\n          type: \"SELECT_TOOL\",\n          selectedTool: \"create-pixel\",\n        })\n      },\n      save_and_previous_sample: () => {\n        dispatch({\n          type: \"HEADER_BUTTON_CLICKED\",\n          buttonName: \"Prev\",\n        })\n      },\n      save_and_next_sample: () => {\n        dispatch({\n          type: \"HEADER_BUTTON_CLICKED\",\n          buttonName: \"Next\",\n        })\n      },\n      save_and_exit_sample: () => {\n        dispatch({\n          type: \"HEADER_BUTTON_CLICKED\",\n          buttonName: \"Save\",\n        })\n      },\n      // TODO\n      // exit_sample: () => {\n      //   dispatch({\n      //     type: \"\",\n      //   })\n      // }\n    }),\n    [dispatch]\n  )\n  return handlers\n}\n\nexport default ({ children, dispatch }) => {\n  const handlers = useDispatchHotkeyHandlers({ dispatch })\n  return (\n    <HotKeys allowChanges handlers={handlers}>\n      {children}\n    </HotKeys>\n  )\n}\n","// @flow\n\nimport type { Region } from \"../../ImageCanvas/region-tools.js\"\n\nconst emptyArr = []\n\nexport default (\n  keyframes: { [string | number]: { regions: Array<Region> } },\n  time: number\n) => {\n  if (keyframes[time || 0]) {\n    return keyframes[time || 0].regions\n  }\n  // Get surrounding video keyframes\n  const keyframeTimes = Object.keys(keyframes)\n    .map((a) => parseInt(a))\n    .filter((a) => !isNaN(a))\n  if (keyframeTimes.length === 0) return emptyArr\n  keyframeTimes.sort((a, b) => a - b)\n  let nextKeyframeTimeIndex = keyframeTimes.findIndex((kt) => kt >= time)\n  if (nextKeyframeTimeIndex === -1) {\n    return (\n      keyframes[keyframeTimes[keyframeTimes.length - 1]].regions || emptyArr\n    )\n  } else if (nextKeyframeTimeIndex === 0) {\n    return emptyArr\n  }\n\n  const t1 = keyframeTimes[nextKeyframeTimeIndex - 1]\n  const prevKeyframe = keyframes[t1]\n  const t2 = keyframeTimes[nextKeyframeTimeIndex]\n  const nextKeyframe = keyframes[t2]\n\n  const [prevRegionMap, nextRegionMap] = [{}, {}]\n  for (const region of prevKeyframe.regions) prevRegionMap[region.id] = region\n  for (const region of nextKeyframe.regions) nextRegionMap[region.id] = region\n\n  const impliedRegions = []\n\n  // Weighted time coefficients for linear transition\n  const w1 = (t2 - time) / (t2 - t1)\n  const w2 = 1 - w1\n\n  for (const regionId in prevRegionMap) {\n    const [prev, next] = [prevRegionMap[regionId], nextRegionMap[regionId]]\n    if (!next) {\n      impliedRegions.push({\n        ...prev,\n        highlighted: false,\n        editingLabels: false,\n      })\n      continue\n    }\n    switch (prev.type) {\n      case \"point\": {\n        impliedRegions.push({\n          ...prev,\n          highlighted: false,\n          editingLabels: false,\n          x: prev.x * w1 + next.x * w2,\n          y: prev.y * w1 + next.y * w2,\n        })\n        break\n      }\n      case \"box\": {\n        impliedRegions.push({\n          ...prev,\n          highlighted: false,\n          editingLabels: false,\n          x: prev.x * w1 + next.x * w2,\n          y: prev.y * w1 + next.y * w2,\n          w: prev.w * w1 + next.w * w2,\n          h: prev.h * w1 + next.h * w2,\n        })\n        break\n      }\n      case \"polygon\": {\n        if (next.points.length === prev.points.length) {\n          impliedRegions.push({\n            ...prev,\n            highlighted: false,\n            editingLabels: false,\n            points: prev.points.map((pp, i) => [\n              pp[0] * w1 + next.points[i][0] * w2,\n              pp[1] * w1 + next.points[i][1] * w2,\n            ]),\n          })\n        } else {\n          impliedRegions.push(prev)\n        }\n        break\n      }\n    }\n  }\n\n  return impliedRegions\n}\n","// @flow\n\nimport { useMemo } from \"react\"\nimport type { MainLayoutVideoAnnotationState } from \"../Annotator/types\"\nimport getImpliedVideoRegions from \"../Annotator/reducers/get-implied-video-regions.js\"\n\nconst emptyArr = []\n\nexport default (state: MainLayoutVideoAnnotationState) => {\n  if (state.annotationType !== \"video\") return emptyArr\n  const { keyframes, currentVideoTime = 0 } = state\n  // TODO memoize\n  return useMemo(() => getImpliedVideoRegions(keyframes, currentVideoTime), [\n    keyframes,\n    currentVideoTime,\n  ])\n}\n","// @flow\n\nimport React, { useState, useRef, useCallback } from \"react\"\nimport type { Node } from \"react\"\nimport Grid from \"@material-ui/core/Grid\"\nimport { makeStyles } from \"@material-ui/core/styles\"\nimport Sidebar from \"../Sidebar\"\nimport ImageCanvas from \"../ImageCanvas\"\nimport Header from \"../Header\"\nimport IconTools from \"../IconTools\"\nimport styles from \"./styles\"\nimport type { MainLayoutState, Action } from \"./types\"\nimport useKey from \"use-key-hook\"\nimport classnames from \"classnames\"\nimport { useSettings } from \"../SettingsProvider\"\nimport SettingsDialog from \"../SettingsDialog\"\nimport Fullscreen from \"../Fullscreen\"\nimport getActiveImage from \"../Annotator/reducers/get-active-image\"\nimport useImpliedVideoRegions from \"./use-implied-video-regions\"\nimport { useDispatchHotkeyHandlers } from \"../ShortcutsManager\"\nimport { withHotKeys } from \"react-hotkeys\"\n\nconst useStyles = makeStyles(styles)\n\nconst HotkeyDiv = withHotKeys(({ hotKeys, children, divRef, ...props }) => (\n  <div {...{ ...hotKeys, ...props }} ref={divRef}>\n    {children}\n  </div>\n))\n\ntype Props = {\n  state: MainLayoutState,\n  RegionEditLabel?: Node,\n  dispatch: (Action) => any,\n  alwaysShowNextButton?: boolean,\n  alwaysShowPrevButton?: boolean,\n  onRegionClassAdded: () => {},\n}\n\nexport const MainLayout = ({\n  state,\n  dispatch,\n  alwaysShowNextButton = false,\n  alwaysShowPrevButton = false,\n  RegionEditLabel,\n  onRegionClassAdded,\n}: Props) => {\n  const classes = useStyles()\n  const settings = useSettings()\n\n  const memoizedActionFns = useRef({})\n  const action = (type: string, ...params: Array<string>) => {\n    const fnKey = `${type}(${params.join(\",\")})`\n    if (memoizedActionFns.current[fnKey])\n      return memoizedActionFns.current[fnKey]\n\n    const fn = (...args: any) =>\n      params.length > 0\n        ? dispatch(\n            ({\n              type,\n              ...params.reduce((acc, p, i) => ((acc[p] = args[i]), acc), {}),\n            }: any)\n          )\n        : dispatch({ type, ...args[0] })\n    memoizedActionFns.current[fnKey] = fn\n    return fn\n  }\n\n  const { currentImageIndex, activeImage } = getActiveImage(state)\n  let nextImage\n  if (currentImageIndex !== null) {\n    nextImage = state.images[currentImageIndex + 1]\n  }\n\n  useKey(() => dispatch({ type: \"CANCEL\" }), {\n    detectKeys: [27],\n  })\n\n  const isAVideoFrame = activeImage && activeImage.frameTime !== undefined\n  const innerContainerRef = useRef()\n  const hotkeyHandlers = useDispatchHotkeyHandlers({ dispatch })\n\n  let impliedVideoRegions = useImpliedVideoRegions(state)\n\n  const refocusOnMouseEvent = useCallback((e) => {\n    if (!innerContainerRef.current) return\n    if (innerContainerRef.current.contains(document.activeElement)) return\n    if (innerContainerRef.current.contains(e.target)) {\n      innerContainerRef.current.focus()\n      e.target.focus()\n    }\n  }, [])\n\n  return (\n    <Fullscreen\n      enabled={state.fullScreen}\n      onChange={(open) => {\n        if (!open) {\n          action(\"HEADER_BUTTON_CLICKED\", \"buttonName\")(\"Exit Fullscreen\")\n        }\n      }}\n    >\n      <HotkeyDiv\n        tabIndex={-1}\n        divRef={innerContainerRef}\n        onMouseDown={refocusOnMouseEvent}\n        onMouseOver={refocusOnMouseEvent}\n        allowChanges\n        handlers={hotkeyHandlers}\n        className={classnames(\n          classes.container,\n          state.fullScreen && \"Fullscreen\"\n        )}\n      >\n        <div className={classes.headerContainer}>\n          <Header\n            onHeaderButtonClick={action(\"HEADER_BUTTON_CLICKED\", \"buttonName\")}\n            videoMode={state.annotationType === \"video\"}\n            alwaysShowNextButton={alwaysShowNextButton}\n            alwaysShowPrevButton={alwaysShowPrevButton}\n            inFullScreen={state.fullScreen}\n            isAVideoFrame={isAVideoFrame}\n            nextVideoFrameHasRegions={\n              !nextImage || (nextImage.regions && nextImage.regions.length > 0)\n            }\n            videoDuration={state.videoDuration}\n            multipleImages={state.images && state.images.length > 1}\n            title={\n              state.annotationType === \"image\"\n                ? activeImage\n                  ? activeImage.name\n                  : \"No Image Selected\"\n                : state.videoName || \"\"\n            }\n            onChangeCurrentTime={action(\"CHANGE_VIDEO_TIME\", \"newTime\")}\n            videoPlaying={state.videoPlaying}\n            currentVideoTime={state.currentVideoTime}\n            keyframes={state.keyframes}\n          />\n        </div>\n        <div className={classes.workspace}>\n          <div className={classes.iconToolsContainer}>\n            <IconTools\n              enabledTools={state.enabledTools}\n              showTags={state.showTags}\n              showMask={state.showMask}\n              selectedTool={state.selectedTool}\n              onClickTool={action(\"SELECT_TOOL\", \"selectedTool\")}\n            />\n          </div>\n          <div className={classes.imageCanvasContainer}>\n            {state.annotationType === \"image\" && !state.selectedImage ? (\n              <div className={classes.noImageSelected}>No Image Selected</div>\n            ) : (\n              <div style={{ height: \"100%\", width: \"100%\" }}>\n                <ImageCanvas\n                  {...settings}\n                  key={state.selectedImage}\n                  showMask={state.showMask}\n                  fullImageSegmentationMode={state.fullImageSegmentationMode}\n                  autoSegmentationOptions={state.autoSegmentationOptions}\n                  showTags={state.showTags}\n                  allowedArea={state.allowedArea}\n                  regionClsList={state.regionClsList}\n                  regionTagList={state.regionTagList}\n                  regions={\n                    state.annotationType === \"image\"\n                      ? activeImage.regions || []\n                      : impliedVideoRegions\n                  }\n                  realSize={activeImage ? activeImage.realSize : undefined}\n                  videoPlaying={state.videoPlaying}\n                  imageSrc={\n                    state.annotationType === \"image\"\n                      ? state.selectedImage\n                      : null\n                  }\n                  videoSrc={\n                    state.annotationType === \"video\" ? state.videoSrc : null\n                  }\n                  pointDistancePrecision={state.pointDistancePrecision}\n                  createWithPrimary={state.selectedTool.includes(\"create\")}\n                  dragWithPrimary={state.selectedTool === \"pan\"}\n                  zoomWithPrimary={state.selectedTool === \"zoom\"}\n                  showPointDistances={state.showPointDistances}\n                  pointDistancePrecision={state.pointDistancePrecision}\n                  videoTime={\n                    state.annotationType === \"image\"\n                      ? state.selectedImageFrameTime\n                      : state.currentVideoTime\n                  }\n                  onMouseMove={action(\"MOUSE_MOVE\")}\n                  onMouseDown={action(\"MOUSE_DOWN\")}\n                  onMouseUp={action(\"MOUSE_UP\")}\n                  onChangeRegion={action(\"CHANGE_REGION\", \"region\")}\n                  onBeginRegionEdit={action(\"OPEN_REGION_EDITOR\", \"region\")}\n                  onCloseRegionEdit={action(\"CLOSE_REGION_EDITOR\", \"region\")}\n                  onDeleteRegion={action(\"DELETE_REGION\", \"region\")}\n                  onBeginBoxTransform={action(\n                    \"BEGIN_BOX_TRANSFORM\",\n                    \"box\",\n                    \"directions\"\n                  )}\n                  onBeginMovePolygonPoint={action(\n                    \"BEGIN_MOVE_POLYGON_POINT\",\n                    \"polygon\",\n                    \"pointIndex\"\n                  )}\n                  onAddPolygonPoint={action(\n                    \"ADD_POLYGON_POINT\",\n                    \"polygon\",\n                    \"point\",\n                    \"pointIndex\"\n                  )}\n                  onSelectRegion={action(\"SELECT_REGION\", \"region\")}\n                  onBeginMovePoint={action(\"BEGIN_MOVE_POINT\", \"point\")}\n                  onImageLoaded={action(\"IMAGE_LOADED\", \"image\")}\n                  RegionEditLabel={RegionEditLabel}\n                  onImageOrVideoLoaded={action(\n                    \"IMAGE_OR_VIDEO_LOADED\",\n                    \"metadata\"\n                  )}\n                  onChangeVideoTime={action(\"CHANGE_VIDEO_TIME\", \"newTime\")}\n                  onChangeVideoPlaying={action(\n                    \"CHANGE_VIDEO_PLAYING\",\n                    \"isPlaying\"\n                  )}\n                  onRegionClassAdded={onRegionClassAdded}\n                />\n              </div>\n            )}\n          </div>\n          <div className={classes.sidebarContainer}>\n            <Sidebar\n              debug={window.localStorage.$ANNOTATE_DEBUG_MODE && state}\n              taskDescription={state.taskDescription}\n              images={state.images}\n              regions={activeImage ? activeImage.regions : null}\n              history={state.history}\n              currentImage={activeImage}\n              labelImages={state.labelImages}\n              imageClsList={state.imageClsList}\n              imageTagList={state.imageTagList}\n              keyframes={state.keyframes}\n              currentVideoTime={state.currentVideoTime}\n              onChangeImage={action(\"CHANGE_IMAGE\", \"delta\")}\n              onSelectRegion={action(\"SELECT_REGION\", \"region\")}\n              onDeleteRegion={action(\"DELETE_REGION\", \"region\")}\n              onSelectImage={action(\"SELECT_IMAGE\", \"image\")}\n              onChangeRegion={action(\"CHANGE_REGION\", \"region\")}\n              onRestoreHistory={action(\"RESTORE_HISTORY\")}\n              onChangeVideoTime={action(\"CHANGE_VIDEO_TIME\", \"newTime\")}\n              onDeleteKeyframe={action(\"DELETE_KEYFRAME\", \"time\")}\n              onShortcutActionDispatched={dispatch}\n            />\n          </div>\n        </div>\n        <SettingsDialog\n          open={state.settingsOpen}\n          onClose={() =>\n            dispatch({\n              type: \"HEADER_BUTTON_CLICKED\",\n              buttonName: \"Settings\",\n            })\n          }\n        />\n      </HotkeyDiv>\n    </Fullscreen>\n  )\n}\n\nexport default MainLayout\n","export default (...reducers) => (state, action) => {\n  for (const reducer of reducers) {\n    state = reducer(state, action)\n  }\n  return state\n}\n","// @flow\n\nimport type { MainLayoutState, Action } from \"../../MainLayout/types\"\nimport { setIn, updateIn, asMutable, without } from \"seamless-immutable\"\nimport moment from \"moment\"\n\nconst typesToSaveWithHistory = {\n  BEGIN_BOX_TRANSFORM: \"Transform/Move Box\",\n  BEGIN_MOVE_POINT: \"Move Point\",\n  DELETE_REGION: \"Delete Region\",\n}\n\nexport const saveToHistory = (state: MainLayoutState, name: string) =>\n  updateIn(state, [\"history\"], (h) =>\n    [\n      {\n        time: moment().toDate(),\n        state: without(state, \"history\"),\n        name,\n      },\n    ].concat((h || []).slice(0, 9))\n  )\n\nexport default (reducer) => {\n  return (state: MainLayoutState, action: Action) => {\n    const prevState = state\n    const nextState = reducer(state, action)\n\n    if (action.type === \"RESTORE_HISTORY\") {\n      if (state.history.length > 0) {\n        return setIn(\n          nextState.history[0].state,\n          [\"history\"],\n          nextState.history.slice(1)\n        )\n      }\n    } else {\n      if (\n        prevState !== nextState &&\n        Object.keys(typesToSaveWithHistory).includes(action.type)\n      ) {\n        return setIn(\n          nextState,\n          [\"history\"],\n          [\n            {\n              time: moment().toDate(),\n              state: without(prevState, \"history\"),\n              name: typesToSaveWithHistory[action.type] || action.type,\n            },\n          ]\n            .concat(nextState.history || [])\n            .slice(0, 9)\n        )\n      }\n    }\n\n    return nextState\n  }\n}\n","// @flow\n\nfunction clamp(num, min, max) {\n  return num <= min ? min : num >= max ? max : num\n}\n\nexport default (expandingLine) => {\n  const expandingWidth = expandingLine.expandingWidth || 0.005\n  const pointPairs = expandingLine.points.map(({ x, y, angle, width }, i) => {\n    if (!angle) {\n      const n =\n        expandingLine.points[clamp(i + 1, 0, expandingLine.points.length - 1)]\n      const p =\n        expandingLine.points[clamp(i - 1, 0, expandingLine.points.length - 1)]\n      angle = Math.atan2(p.x - n.x, p.y - n.y) + Math.PI / 2\n    }\n    const dx = (Math.sin(angle) * (width || expandingWidth)) / 2\n    const dy = (Math.cos(angle) * (width || expandingWidth)) / 2\n    return [\n      { x: x + dx, y: y + dy },\n      { x: x - dx, y: y - dy },\n    ]\n  })\n  const firstSection = pointPairs.map(([p1, p2]) => p1)\n  const secondSection = pointPairs.map(([p1, p2]) => p2).asMutable()\n  secondSection.reverse()\n\n  const newPoints = firstSection.concat(secondSection).map(({ x, y }) => [x, y])\n\n  return {\n    ...expandingLine,\n    type: \"polygon\",\n    open: false,\n    points: newPoints,\n    unfinished: undefined,\n    candidatePoint: undefined,\n  }\n\n  // let { expandingWidth = 0.005, points } = region\n  // expandingWidth = points.slice(-1)[0].width || expandingWidth\n  // const lastPoint = points.slice(-1)[0]\n  // return (\n  //   <>\n  //     <polygon\n  //       points={\n  //         .map((p) => `${p.x * iw} ${p.y * ih}`)\n  //         .join(\" \")}\n  // return {\n  //   ...expandingLine,\n  //   unfinished: undefined,\n  //   candidatePoint: undefined,\n  // }\n}\n","// @flow\nimport type { MainLayoutState, Action } from \"../../MainLayout/types\"\nimport { moveRegion } from \"../../ImageCanvas/region-tools.js\"\nimport { getIn, setIn, updateIn } from \"seamless-immutable\"\nimport moment from \"moment\"\nimport isEqual from \"lodash/isEqual\"\nimport getActiveImage from \"./get-active-image\"\nimport { saveToHistory } from \"./history-handler.js\"\nimport colors from \"../../colors\"\nimport fixTwisted from \"./fix-twisted\"\nimport convertExpandingLineToPolygon from \"./convert-expanding-line-to-polygon\"\n\nconst getRandomId = () => Math.random().toString().split(\".\")[1]\n\nexport default (state: MainLayoutState, action: Action) => {\n  if (action.type === \"ON_CLS_ADDED\" && action.cls && action.cls !== \"\") {\n    const oldRegionClsList = state.regionClsList\n    const newState = {\n      ...state,\n      regionClsList: oldRegionClsList.concat(action.cls),\n    }\n    return newState\n  }\n\n  // Throttle certain actions\n  if (action.type === \"MOUSE_MOVE\") {\n    if (Date.now() - ((state: any).lastMouseMoveCall || 0) < 16) return state\n    state = setIn(state, [\"lastMouseMoveCall\"], Date.now())\n  }\n  if (!action.type.includes(\"MOUSE\")) {\n    state = setIn(state, [\"lastAction\"], action)\n  }\n\n  const { currentImageIndex, pathToActiveImage, activeImage } = getActiveImage(\n    state\n  )\n\n  const getRegionIndex = (region) => {\n    const regionId = typeof region === \"string\" ? region : region.id\n    if (!activeImage) return null\n    const regionIndex = (activeImage.regions || []).findIndex(\n      (r) => r.id === regionId\n    )\n    return regionIndex === -1 ? null : regionIndex\n  }\n  const getRegion = (regionId) => {\n    if (!activeImage) return null\n    const regionIndex = getRegionIndex(regionId)\n    if (regionIndex === null) return [null, null]\n    const region = activeImage.regions[regionIndex]\n    return [region, regionIndex]\n  }\n  const modifyRegion = (regionId, obj) => {\n    const [region, regionIndex] = getRegion(regionId)\n    if (!region) return state\n    if (obj !== null) {\n      return setIn(state, [...pathToActiveImage, \"regions\", regionIndex], {\n        ...region,\n        ...obj,\n      })\n    } else {\n      // delete region\n      const regions = activeImage.regions\n      return setIn(\n        state,\n        [...pathToActiveImage, \"regions\"],\n        (regions || []).filter((r) => r.id !== region.id)\n      )\n    }\n  }\n  const unselectRegions = (state: MainLayoutState) => {\n    if (!activeImage) return state\n    return setIn(\n      state,\n      [...pathToActiveImage, \"regions\"],\n      (activeImage.regions || []).map((r) => ({\n        ...r,\n        highlighted: false,\n      }))\n    )\n  }\n\n  const closeEditors = (state: MainLayoutState) => {\n    if (currentImageIndex === null) return state\n    return setIn(\n      state,\n      [...pathToActiveImage, \"regions\"],\n      (activeImage.regions || []).map((r) => ({\n        ...r,\n        editingLabels: false,\n      }))\n    )\n  }\n\n  const setNewImage = (img: string | Object) => {\n    let { src, frameTime } = typeof img === \"object\" ? img : { src: img }\n    return setIn(\n      setIn(state, [\"selectedImage\"], src),\n      [\"selectedImageFrameTime\"],\n      frameTime\n    )\n  }\n\n  switch (action.type) {\n    case \"@@INIT\": {\n      return state\n    }\n    case \"SELECT_IMAGE\": {\n      return setNewImage(action.image)\n    }\n    case \"CHANGE_REGION\": {\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      const oldRegion = activeImage.regions[regionIndex]\n      if (oldRegion.cls !== action.region.cls) {\n        state = saveToHistory(state, \"Change Region Classification\")\n        const clsIndex = state.regionClsList.indexOf(action.region.cls)\n        if (clsIndex !== -1) {\n          action.region.color = colors[clsIndex % colors.length]\n        }\n      }\n      if (!isEqual(oldRegion.tags, action.region.tags)) {\n        state = saveToHistory(state, \"Change Region Tags\")\n      }\n      return setIn(\n        state,\n        [...pathToActiveImage, \"regions\", regionIndex],\n        action.region\n      )\n    }\n    case \"CHANGE_IMAGE\": {\n      if (!activeImage) return state\n      const { delta } = action\n      for (const key of Object.keys(delta)) {\n        if (key === \"cls\") saveToHistory(state, \"Change Image Class\")\n        if (key === \"tags\") saveToHistory(state, \"Change Image Tags\")\n        state = setIn(state, [...pathToActiveImage, key], delta[key])\n      }\n      return state\n    }\n    case \"SELECT_REGION\": {\n      const { region } = action\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      const regions = [...(activeImage.regions || [])].map((r) => ({\n        ...r,\n        highlighted: r.id === region.id,\n        editingLabels: r.id === region.id,\n      }))\n      return setIn(state, [...pathToActiveImage, \"regions\"], regions)\n    }\n    case \"BEGIN_MOVE_POINT\": {\n      state = closeEditors(state)\n      return setIn(state, [\"mode\"], {\n        mode: \"MOVE_REGION\",\n        regionId: action.point.id,\n      })\n    }\n    case \"BEGIN_BOX_TRANSFORM\": {\n      const { box, directions } = action\n      state = closeEditors(state)\n      if (directions[0] === 0 && directions[1] === 0) {\n        return setIn(state, [\"mode\"], { mode: \"MOVE_REGION\", regionId: box.id })\n      } else {\n        return setIn(state, [\"mode\"], {\n          mode: \"RESIZE_BOX\",\n          regionId: box.id,\n          freedom: directions,\n          original: { x: box.x, y: box.y, w: box.w, h: box.h },\n        })\n      }\n    }\n    case \"BEGIN_MOVE_POLYGON_POINT\": {\n      const { polygon, pointIndex } = action\n      state = closeEditors(state)\n      if (\n        state.mode &&\n        state.mode.mode === \"DRAW_POLYGON\" &&\n        pointIndex === 0\n      ) {\n        return setIn(\n          modifyRegion(polygon, {\n            points: polygon.points.slice(0, -1),\n            open: false,\n          }),\n          [\"mode\"],\n          null\n        )\n      } else {\n        state = saveToHistory(state, \"Move Polygon Point\")\n      }\n      return setIn(state, [\"mode\"], {\n        mode: \"MOVE_POLYGON_POINT\",\n        regionId: polygon.id,\n        pointIndex,\n      })\n    }\n    case \"ADD_POLYGON_POINT\": {\n      const { polygon, point, pointIndex } = action\n      const regionIndex = getRegionIndex(polygon)\n      if (regionIndex === null) return state\n      const points = [...polygon.points]\n      points.splice(pointIndex, 0, point)\n      return setIn(state, [...pathToActiveImage, \"regions\", regionIndex], {\n        ...polygon,\n        points,\n      })\n    }\n    case \"MOUSE_MOVE\": {\n      const { x, y } = action\n      if (!state.mode) return state\n      if (!activeImage) return state\n      const { mouseDownAt } = state\n      switch (state.mode.mode) {\n        case \"MOVE_POLYGON_POINT\": {\n          const { pointIndex, regionId } = state.mode\n          const regionIndex = getRegionIndex(regionId)\n          if (regionIndex === null) return state\n          return setIn(\n            state,\n            [\n              ...pathToActiveImage,\n              \"regions\",\n              regionIndex,\n              \"points\",\n              pointIndex,\n            ],\n            [x, y]\n          )\n        }\n        case \"MOVE_REGION\": {\n          const { regionId } = state.mode\n          const regionIndex = getRegionIndex(regionId)\n          if (regionIndex === null) return state\n          return setIn(\n            state,\n            [...pathToActiveImage, \"regions\", regionIndex],\n            moveRegion(activeImage.regions[regionIndex], x, y)\n          )\n        }\n        case \"RESIZE_BOX\": {\n          const {\n            regionId,\n            freedom: [xFree, yFree],\n            original: { x: ox, y: oy, w: ow, h: oh },\n          } = state.mode\n          const regionIndex = getRegionIndex(regionId)\n          if (regionIndex === null) return state\n          const box = activeImage.regions[regionIndex]\n\n          const dx = xFree === 0 ? ox : xFree === -1 ? Math.min(ox + ow, x) : ox\n          const dw =\n            xFree === 0\n              ? ow\n              : xFree === -1\n              ? ow + (ox - dx)\n              : Math.max(0, ow + (x - ox - ow))\n          const dy = yFree === 0 ? oy : yFree === -1 ? Math.min(oy + oh, y) : oy\n          const dh =\n            yFree === 0\n              ? oh\n              : yFree === -1\n              ? oh + (oy - dy)\n              : Math.max(0, oh + (y - oy - oh))\n\n          // determine if we should switch the freedom\n          if (dw <= 0.001) {\n            state = setIn(state, [\"mode\", \"freedom\"], [xFree * -1, yFree])\n          }\n          if (dh <= 0.001) {\n            state = setIn(state, [\"mode\", \"freedom\"], [xFree, yFree * -1])\n          }\n\n          return setIn(state, [...pathToActiveImage, \"regions\", regionIndex], {\n            ...box,\n            x: dx,\n            w: dw,\n            y: dy,\n            h: dh,\n          })\n        }\n        case \"DRAW_POLYGON\": {\n          const { regionId } = state.mode\n          const [region, regionIndex] = getRegion(regionId)\n          if (!region) return setIn(state, [\"mode\"], null)\n          return setIn(\n            state,\n            [\n              ...pathToActiveImage,\n              \"regions\",\n              regionIndex,\n              \"points\",\n              (region: any).points.length - 1,\n            ],\n            [x, y]\n          )\n        }\n        case \"DRAW_EXPANDING_LINE\": {\n          const { regionId } = state.mode\n          const [expandingLine, regionIndex] = getRegion(regionId)\n          if (!expandingLine) return state\n          const isMouseDown = Boolean(state.mouseDownAt)\n          if (isMouseDown) {\n            // If the mouse is down, set width/angle\n            const lastPoint = expandingLine.points.slice(-1)[0]\n            const mouseDistFromLastPoint = Math.sqrt(\n              (lastPoint.x - x) ** 2 + (lastPoint.y - y) ** 2\n            )\n            if (mouseDistFromLastPoint < 0.002 && !lastPoint.width) return state\n\n            const newState = setIn(\n              state,\n              [...pathToActiveImage, \"regions\", regionIndex, \"points\"],\n              expandingLine.points.slice(0, -1).concat([\n                {\n                  ...lastPoint,\n                  width: mouseDistFromLastPoint * 2,\n                  angle: Math.atan2(lastPoint.x - x, lastPoint.y - y),\n                },\n              ])\n            )\n            return newState\n          } else {\n            // If mouse is up, move the next candidate point\n            return setIn(\n              state,\n              [...pathToActiveImage, \"regions\", regionIndex],\n              {\n                ...expandingLine,\n                candidatePoint: { x, y },\n              }\n            )\n          }\n\n          return state\n        }\n        case \"SET_EXPANDING_LINE_WIDTH\": {\n          const { regionId } = state.mode\n          const [expandingLine, regionIndex] = getRegion(regionId)\n          if (!expandingLine) return state\n          const lastPoint = expandingLine.points.slice(-1)[0]\n          const { mouseDownAt } = state\n          return setIn(\n            state,\n            [...pathToActiveImage, \"regions\", regionIndex, \"expandingWidth\"],\n            Math.sqrt((lastPoint.x - x) ** 2 + (lastPoint.y - y) ** 2)\n          )\n        }\n        default:\n          return state\n      }\n    }\n    case \"MOUSE_DOWN\": {\n      if (!activeImage) return state\n      const { x, y } = action\n      state = setIn(state, [\"mouseDownAt\"], { x, y })\n\n      if (state.allowedArea) {\n        // TODO clamp x/y instead of giving up\n        // TODO or image bounds\n        const aa = state.allowedArea\n        if (x < aa.x || x > aa.x + aa.w || y < aa.y || y > aa.y + aa.h) {\n          return state\n        }\n      }\n\n      if (state.mode) {\n        switch (state.mode.mode) {\n          case \"DRAW_POLYGON\": {\n            const [polygon, regionIndex] = getRegion(state.mode.regionId)\n            if (!polygon) break\n            return setIn(\n              state,\n              [...pathToActiveImage, \"regions\", regionIndex],\n              { ...polygon, points: polygon.points.concat([[x, y]]) }\n            )\n          }\n          case \"DRAW_EXPANDING_LINE\": {\n            const [expandingLine, regionIndex] = getRegion(state.mode.regionId)\n            if (!expandingLine) break\n            const lastPoint = expandingLine.points.slice(-1)[0]\n            if (\n              expandingLine.points.length > 1 &&\n              Math.sqrt((lastPoint.x - x) ** 2 + (lastPoint.y - y) ** 2) < 0.002\n            ) {\n              if (!lastPoint.width) {\n                return setIn(state, [\"mode\"], {\n                  mode: \"SET_EXPANDING_LINE_WIDTH\",\n                  regionId: state.mode.regionId,\n                })\n              } else {\n                return state\n                  .setIn(\n                    [...pathToActiveImage, \"regions\", regionIndex],\n                    convertExpandingLineToPolygon(expandingLine)\n                  )\n                  .setIn([\"mode\"], null)\n              }\n            }\n\n            // Create new point\n            return setIn(\n              state,\n              [...pathToActiveImage, \"regions\", regionIndex, \"points\"],\n              expandingLine.points.concat([{ x, y, angle: null, width: null }])\n            )\n          }\n          case \"SET_EXPANDING_LINE_WIDTH\": {\n            const [expandingLine, regionIndex] = getRegion(state.mode.regionId)\n            if (!expandingLine) break\n            const { expandingWidth } = expandingLine\n            return state\n              .setIn(\n                [...pathToActiveImage, \"regions\", regionIndex],\n                convertExpandingLineToPolygon({\n                  ...expandingLine,\n                  points: expandingLine.points.map((p) =>\n                    p.width ? p : { ...p, width: expandingWidth }\n                  ),\n                  expandingWidth: undefined,\n                })\n              )\n              .setIn([\"mode\"], null)\n          }\n          default:\n            break\n        }\n      }\n\n      let newRegion\n      let defaultRegionCls = undefined,\n        defaultRegionColor = \"#ff0000\"\n      if (activeImage && (activeImage.regions || []).length > 0) {\n        defaultRegionCls = activeImage.regions.slice(-1)[0].cls\n        const clsIndex = (state.regionClsList || []).indexOf(defaultRegionCls)\n        if (clsIndex !== -1) {\n          defaultRegionColor = colors[clsIndex % colors.length]\n        }\n      }\n\n      switch (state.selectedTool) {\n        case \"create-point\": {\n          state = saveToHistory(state, \"Create Point\")\n          newRegion = {\n            type: \"point\",\n            x,\n            y,\n            highlighted: true,\n            editingLabels: true,\n            color: defaultRegionColor,\n            id: getRandomId(),\n            cls: defaultRegionCls,\n          }\n          break\n        }\n        case \"create-box\": {\n          state = saveToHistory(state, \"Create Box\")\n          newRegion = {\n            type: \"box\",\n            x: x,\n            y: y,\n            w: 0.01,\n            h: 0.01,\n            highlighted: true,\n            editingLabels: false,\n            color: defaultRegionColor,\n            cls: defaultRegionCls,\n            id: getRandomId(),\n          }\n          state = setIn(state, [\"mode\"], {\n            mode: \"RESIZE_BOX\",\n            editLabelEditorAfter: true,\n            regionId: newRegion.id,\n            freedom: [1, 1],\n            original: { x, y, w: newRegion.w, h: newRegion.h },\n            isNew: true,\n          })\n          break\n        }\n        case \"create-polygon\": {\n          if (state.mode && state.mode.mode === \"DRAW_POLYGON\") break\n          state = saveToHistory(state, \"Create Polygon\")\n          newRegion = {\n            type: \"polygon\",\n            points: [\n              [x, y],\n              [x, y],\n            ],\n            open: true,\n            highlighted: true,\n            color: defaultRegionColor,\n            cls: defaultRegionCls,\n            id: getRandomId(),\n          }\n          state = setIn(state, [\"mode\"], {\n            mode: \"DRAW_POLYGON\",\n            regionId: newRegion.id,\n          })\n          break\n        }\n        case \"create-expanding-line\": {\n          state = saveToHistory(state, \"Create Expanding Line\")\n          newRegion = {\n            type: \"expanding-line\",\n            unfinished: true,\n            points: [{ x, y, angle: null, width: null }],\n            open: true,\n            highlighted: true,\n            color: defaultRegionColor,\n            cls: defaultRegionCls,\n            id: getRandomId(),\n          }\n          state = setIn(state, [\"mode\"], {\n            mode: \"DRAW_EXPANDING_LINE\",\n            regionId: newRegion.id,\n          })\n          break\n        }\n        default:\n          break\n      }\n\n      const regions = [...(getIn(state, pathToActiveImage).regions || [])]\n        .map((r) =>\n          setIn(r, [\"editingLabels\"], false).setIn([\"highlighted\"], false)\n        )\n        .concat(newRegion ? [newRegion] : [])\n\n      return setIn(state, [...pathToActiveImage, \"regions\"], regions)\n    }\n    case \"MOUSE_UP\": {\n      const { x, y } = action\n      const { mouseDownAt = { x, y } } = state\n      if (!state.mode) return state\n      state = setIn(state, [\"mouseDownAt\"], null)\n      switch (state.mode.mode) {\n        case \"RESIZE_BOX\": {\n          if (state.mode.isNew) {\n            if (\n              Math.abs(state.mode.original.x - x) < 0.002 &&\n              Math.abs(state.mode.original.y - y) < 0.002\n            ) {\n              return setIn(\n                modifyRegion(state.mode.regionId, null),\n                [\"mode\"],\n                null\n              )\n            }\n          }\n          if (state.mode.editLabelEditorAfter) {\n            return {\n              ...modifyRegion(state.mode.regionId, { editingLabels: true }),\n              mode: null,\n            }\n          }\n        }\n        case \"MOVE_REGION\":\n        case \"MOVE_POLYGON_POINT\": {\n          return { ...state, mode: null }\n        }\n        case \"CREATE_POINT_LINE\": {\n          return state\n        }\n        case \"DRAW_EXPANDING_LINE\": {\n          const [expandingLine, regionIndex] = getRegion(state.mode.regionId)\n          if (!expandingLine) return state\n          let newExpandingLine = expandingLine\n          const lastPoint =\n            expandingLine.points.length !== 0\n              ? expandingLine.points.slice(-1)[0]\n              : mouseDownAt\n          let jointStart\n          if (expandingLine.points.length > 1) {\n            jointStart = expandingLine.points.slice(-2)[0]\n          } else {\n            jointStart = lastPoint\n          }\n          const mouseDistFromLastPoint = Math.sqrt(\n            (lastPoint.x - x) ** 2 + (lastPoint.y - y) ** 2\n          )\n          if (mouseDistFromLastPoint > 0.002) {\n            // The user is drawing has drawn the width for the last point\n            const newPoints = [...expandingLine.points]\n            for (let i = 0; i < newPoints.length - 1; i++) {\n              if (newPoints[i].width) continue\n              newPoints[i] = {\n                ...newPoints[i],\n                width: lastPoint.width,\n              }\n            }\n            newExpandingLine = setIn(\n              expandingLine,\n              [\"points\"],\n              fixTwisted(newPoints)\n            )\n          } else {\n            return state\n          }\n          return setIn(\n            state,\n            [...pathToActiveImage, \"regions\", regionIndex],\n            newExpandingLine\n          )\n        }\n        default:\n          return state\n      }\n    }\n    case \"OPEN_REGION_EDITOR\": {\n      const { region } = action\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      const newRegions = setIn(\n        activeImage.regions.map((r) => ({\n          ...r,\n          highlighted: false,\n          editingLabels: false,\n        })),\n        [regionIndex],\n        {\n          ...(activeImage.regions || [])[regionIndex],\n          highlighted: true,\n          editingLabels: true,\n        }\n      )\n      return setIn(state, [...pathToActiveImage, \"regions\"], newRegions)\n    }\n    case \"CLOSE_REGION_EDITOR\": {\n      const { region } = action\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      return setIn(state, [...pathToActiveImage, \"regions\", regionIndex], {\n        ...(activeImage.regions || [])[regionIndex],\n        editingLabels: false,\n      })\n    }\n    case \"DELETE_REGION\": {\n      const regionIndex = getRegionIndex(action.region)\n      if (regionIndex === null) return state\n      return setIn(\n        state,\n        [...pathToActiveImage, \"regions\"],\n        (activeImage.regions || []).filter((r) => r.id !== action.region.id)\n      )\n    }\n    case \"HEADER_BUTTON_CLICKED\": {\n      const buttonName = action.buttonName.toLowerCase()\n      switch (buttonName) {\n        case \"prev\": {\n          if (currentImageIndex === null) return state\n          if (currentImageIndex === 0) return state\n          return setNewImage(state.images[currentImageIndex - 1])\n        }\n        case \"next\": {\n          if (currentImageIndex === null) return state\n          if (currentImageIndex === state.images.length - 1) return state\n          return setNewImage(state.images[currentImageIndex + 1])\n        }\n        case \"clone\": {\n          if (currentImageIndex === null) return state\n          if (currentImageIndex === state.images.length - 1) return state\n          return setIn(\n            setNewImage(state.images[currentImageIndex + 1]),\n            [\"images\", currentImageIndex + 1, \"regions\"],\n            activeImage.regions\n          )\n        }\n        case \"settings\": {\n          return setIn(state, [\"settingsOpen\"], !state.settingsOpen)\n        }\n        case \"help\": {\n          return state\n        }\n        case \"fullscreen\": {\n          return setIn(state, [\"fullScreen\"], true)\n        }\n        case \"exit fullscreen\":\n        case \"window\": {\n          return setIn(state, [\"fullScreen\"], false)\n        }\n        case \"hotkeys\": {\n          return state\n        }\n        case \"exit\":\n        case \"done\": {\n          return state\n        }\n        default:\n          return state\n      }\n    }\n    case \"SELECT_TOOL\": {\n      if (action.selectedTool === \"show-tags\") {\n        return setIn(state, [\"showTags\"], !state.showTags)\n      } else if (action.selectedTool === \"show-mask\") {\n        return setIn(state, [\"showMask\"], !state.showMask)\n      }\n      state = setIn(state, [\"mode\"], null)\n      return setIn(state, [\"selectedTool\"], action.selectedTool)\n    }\n    case \"CANCEL\": {\n      const { mode } = state\n      if (mode) {\n        switch (mode.mode) {\n          case \"DRAW_EXPANDING_LINE\":\n          case \"SET_EXPANDING_LINE_WIDTH\":\n          case \"DRAW_POLYGON\": {\n            const { regionId } = mode\n            return modifyRegion(regionId, null)\n          }\n          case \"MOVE_POLYGON_POINT\":\n          case \"RESIZE_BOX\":\n          case \"MOVE_REGION\": {\n            return setIn(state, [\"mode\"], null)\n          }\n          default:\n            return state\n        }\n      }\n      // Close any open boxes\n      const regions: any = activeImage.regions\n      if (regions && regions.some((r) => r.editingLabels)) {\n        return setIn(\n          state,\n          [...pathToActiveImage, \"regions\"],\n          regions.map((r) => ({\n            ...r,\n            editingLabels: false,\n          }))\n        )\n      } else if (regions) {\n        return setIn(\n          state,\n          [...pathToActiveImage, \"regions\"],\n          regions.map((r) => ({\n            ...r,\n            highlighted: false,\n          }))\n        )\n      }\n      break\n    }\n    default:\n      break\n  }\n  return state\n}\n","// @flow\n\nimport type {\n  MainLayoutImageAnnotationState,\n  Action,\n} from \"../../MainLayout/types\"\nimport { setIn } from \"seamless-immutable\"\nimport getActiveImage from \"./get-active-image\"\n\nexport default (state: MainLayoutImageAnnotationState, action: Action) => {\n  const { currentImageIndex, pathToActiveImage, activeImage } = getActiveImage(\n    state\n  )\n\n  switch (action.type) {\n    case \"IMAGE_OR_VIDEO_LOADED\": {\n      return setIn(state, [\"images\", currentImageIndex, \"pixelSize\"], {\n        w: action.metadata.naturalWidth,\n        h: action.metadata.naturalHeight,\n      })\n    }\n  }\n  return state\n}\n","// @flow\n\nimport type {\n  MainLayoutVideoAnnotationState,\n  Action,\n} from \"../../MainLayout/types\"\nimport { setIn, without } from \"seamless-immutable\"\nimport getImpliedVideoRegions from \"./get-implied-video-regions\"\nimport { saveToHistory } from \"./history-handler.js\"\n\nexport default (state: MainLayoutVideoAnnotationState, action: Action) => {\n  const copyImpliedRegions = () => {\n    return setIn(\n      saveToHistory(state, \"Add Keyframe\"),\n      [\"keyframes\", state.currentVideoTime],\n      {\n        regions: getImpliedVideoRegions(\n          state.keyframes,\n          state.currentVideoTime\n        ),\n      }\n    )\n  }\n\n  switch (action.type) {\n    case \"IMAGE_OR_VIDEO_LOADED\": {\n      const { duration } = action.metadata\n      if (typeof duration === \"number\") {\n        return setIn(state, [\"videoDuration\"], duration * 1000)\n      }\n    }\n    case \"HEADER_BUTTON_CLICKED\": {\n      switch (action.buttonName.toLowerCase()) {\n        case \"play\":\n          return setIn(state, [\"videoPlaying\"], true)\n        case \"pause\":\n          return setIn(state, [\"videoPlaying\"], false)\n      }\n    }\n    case \"CHANGE_VIDEO_TIME\": {\n      return setIn(state, [\"currentVideoTime\"], action.newTime)\n    }\n    case \"CHANGE_VIDEO_PLAYING\": {\n      return setIn(state, [\"videoPlaying\"], action.isPlaying)\n    }\n    case \"DELETE_KEYFRAME\": {\n      return setIn(state, [\"keyframes\"], without(state.keyframes, action.time))\n    }\n  }\n\n  // Before the user modifies regions, copy the interpolated regions over to a\n  // new keyframe\n  if (!state.keyframes[state.currentVideoTime]) {\n    switch (action.type) {\n      case \"BEGIN_BOX_TRANSFORM\":\n      case \"BEGIN_MOVE_POINT\":\n      case \"BEGIN_MOVE_POLYGON_POINT\":\n      case \"BEGIN_BOX_TRANSFORM\":\n      case \"BEGIN_MOVE_POLYGON_POINT\":\n      case \"ADD_POLYGON_POINT\":\n      case \"SELECT_REGION\":\n      case \"CHANGE_REGION\":\n      case \"DELETE_REGION\":\n      case \"OPEN_REGION_EDITOR\":\n        return copyImpliedRegions()\n      case \"MOUSE_DOWN\": {\n        switch (state.selectedTool) {\n          case \"create-point\":\n          case \"create-polygon\":\n          case \"create-box\":\n            return copyImpliedRegions()\n        }\n      }\n    }\n  }\n\n  return state\n}\n","// @flow\n\nimport React, { useReducer, useEffect } from \"react\"\nimport type { Node } from \"react\"\nimport MainLayout from \"../MainLayout\"\nimport type {\n  ToolEnum,\n  Image,\n  Mode,\n  MainLayoutState,\n  Action,\n} from \"../MainLayout/types\"\nimport SettingsProvider from \"../SettingsProvider\"\n\nimport combineReducers from \"./reducers/combine-reducers.js\"\nimport generalReducer from \"./reducers/general-reducer.js\"\nimport imageReducer from \"./reducers/image-reducer.js\"\nimport videoReducer from \"./reducers/video-reducer.js\"\nimport historyHandler from \"./reducers/history-handler.js\"\n\nimport useEventCallback from \"use-event-callback\"\nimport makeImmutable, { without } from \"seamless-immutable\"\n\ntype Props = {\n  taskDescription: string,\n  allowedArea?: { x: number, y: number, w: number, h: number },\n  regionTagList?: Array<string>,\n  regionClsList?: Array<string>,\n  imageTagList?: Array<string>,\n  imageClsList?: Array<string>,\n  enabledTools?: Array<string>,\n  selectedTool?: String,\n  showTags?: boolean,\n  selectedImage?: string,\n  images?: Array<Image>,\n  showPointDistances?: boolean,\n  pointDistancePrecision?: number,\n  RegionEditLabel?: Node,\n  onExit: (MainLayoutState) => any,\n  videoTime?: number,\n  videoSrc?: string,\n  keyframes?: Object,\n  videoName?: string,\n  fullImageSegmentationMode?: boolean,\n  autoSegmentationOptions?:\n    | {| type: \"simple\" |}\n    | {| type: \"autoseg\", maxClusters?: number, slicWeightFactor?: number |},\n}\n\nexport const Annotator = ({\n  images,\n  allowedArea,\n  selectedImage = images && images.length > 0 ? images[0].src : undefined,\n  showPointDistances,\n  pointDistancePrecision,\n  showTags = true,\n  enabledTools = [\n    \"select\",\n    \"create-point\",\n    \"create-box\",\n    \"create-polygon\",\n    \"create-expanding-line\",\n    \"show-mask\",\n  ],\n  selectedTool = \"select\",\n  regionTagList = [],\n  regionClsList = [],\n  imageTagList = [],\n  imageClsList = [],\n  keyframes = {},\n  taskDescription,\n  fullImageSegmentationMode = false,\n  RegionEditLabel,\n  videoSrc,\n  videoTime = 0,\n  videoName,\n  onExit,\n  onNextImage,\n  onPrevImage,\n  autoSegmentationOptions = { type: \"autoseg\" },\n}: Props) => {\n  if (!images && !videoSrc)\n    return 'Missing required prop \"images\" or \"videoSrc\"'\n  const annotationType = images ? \"image\" : \"video\"\n  const [state, dispatchToReducer] = useReducer(\n    historyHandler(\n      combineReducers(\n        annotationType === \"image\" ? imageReducer : videoReducer,\n        generalReducer\n      )\n    ),\n    makeImmutable({\n      annotationType,\n      showTags,\n      allowedArea,\n      showPointDistances,\n      pointDistancePrecision,\n      selectedTool,\n      fullImageSegmentationMode: fullImageSegmentationMode,\n      autoSegmentationOptions,\n      mode: null,\n      taskDescription,\n      showMask: true,\n      labelImages: imageClsList.length > 0 || imageTagList.length > 0,\n      regionClsList,\n      regionTagList,\n      imageClsList,\n      imageTagList,\n      currentVideoTime: videoTime,\n      enabledTools,\n      history: [],\n      videoName,\n      ...(annotationType === \"image\"\n        ? {\n            selectedImage,\n            images,\n            selectedImageFrameTime:\n              images && images.length > 0 ? images[0].frameTime : undefined,\n          }\n        : {\n            videoSrc,\n            keyframes,\n          }),\n    })\n  )\n\n  const dispatch = useEventCallback((action: Action) => {\n    if (action.type === \"HEADER_BUTTON_CLICKED\") {\n      if ([\"Exit\", \"Done\", \"Save\", \"Complete\"].includes(action.buttonName)) {\n        return onExit(without(state, \"history\"))\n      } else if (action.buttonName === \"Next\" && onNextImage) {\n        return onNextImage(without(state, \"history\"))\n      } else if (action.buttonName === \"Prev\" && onPrevImage) {\n        return onPrevImage(without(state, \"history\"))\n      }\n    }\n    dispatchToReducer(action)\n  })\n\n  const onRegionClassAdded = useEventCallback((cls) => {\n    dispatchToReducer({\n      type: \"ON_CLS_ADDED\",\n      cls: cls,\n    })\n  })\n\n  useEffect(() => {\n    if (!selectedImage) return\n    dispatchToReducer({\n      type: \"SELECT_IMAGE\",\n      image: state.images.find((img) => img.src === selectedImage),\n    })\n  }, [selectedImage])\n\n  return (\n    <SettingsProvider>\n      <MainLayout\n        RegionEditLabel={RegionEditLabel}\n        alwaysShowNextButton={Boolean(onNextImage)}\n        alwaysShowPrevButton={Boolean(onPrevImage)}\n        state={state}\n        dispatch={dispatch}\n        onRegionClassAdded={onRegionClassAdded}\n      />\n    </SettingsProvider>\n  )\n}\n\nexport default Annotator\n","// @flow\n\nimport React, { Component } from \"react\"\nimport Dialog from \"@material-ui/core/Dialog\"\nimport Button from \"@material-ui/core/Button\"\nimport DialogTitle from \"@material-ui/core/DialogTitle\"\nimport DialogContent from \"@material-ui/core/DialogContent\"\nimport DialogActions from \"@material-ui/core/DialogActions\"\n\nexport default class ErrorBoundaryDialog extends Component {\n  state = { hasError: false, err: \"\" }\n  componentDidCatch(err, info) {\n    this.setState({\n      hasError: true,\n      err: err.toString() + \"\\n\\n\" + info.componentStack,\n    })\n  }\n  render() {\n    if (this.state.hasError) {\n      return (\n        <Dialog open={this.state.hasError} onClose={this.props.onClose}>\n          <DialogTitle>Error Loading Annotator</DialogTitle>\n          <DialogContent>\n            <pre>{this.state.err}</pre>\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={this.props.onClose}>Close</Button>\n          </DialogActions>\n        </Dialog>\n      )\n    }\n    return this.props.children\n  }\n}\n","// @flow\nimport React, { useState } from \"react\"\nimport ReactDOM from \"react-dom\"\nimport Editor, { examples } from \"./Editor\"\nimport Annotator from \"../Annotator\"\nimport ErrorBoundaryDialog from \"./ErrorBoundaryDialog.js\"\n\nexport default () => {\n  const [annotatorOpen, changeAnnotatorOpen] = useState(false)\n  const [annotatorProps, changeAnnotatorProps] = useState(examples[\"Custom\"]())\n  const [lastOutput, changeLastOutput] = useState()\n\n  return (\n    <div>\n      {annotatorOpen ? (\n        <ErrorBoundaryDialog\n          onClose={() => {\n            changeAnnotatorOpen(false)\n          }}\n        >\n          <Annotator\n            {...(annotatorProps: any)}\n            onExit={(output) => {\n              delete (output: any)[\"lastAction\"]\n              changeLastOutput(output)\n              changeAnnotatorOpen(false)\n            }}\n          />\n        </ErrorBoundaryDialog>\n      ) : (\n        <Editor\n          lastOutput={lastOutput}\n          onOpenAnnotator={(props) => {\n            changeAnnotatorProps(props)\n            changeAnnotatorOpen(true)\n          }}\n        />\n      )}\n    </div>\n  )\n}\n","// @flow\n\nimport React from \"react\"\nimport Button from \"@material-ui/core/Button\"\nimport { styled } from \"@material-ui/core/styles\"\nimport * as colors from \"@material-ui/core/colors\"\nimport Grid from \"@material-ui/core/Grid\"\nimport Markdown from \"react-markdown\"\nimport GitHubButton from \"react-github-btn\"\nimport \"./github-markdown.css\"\nimport raw from \"raw.macro\"\nimport { Prism as SyntaxHighlighter } from \"react-syntax-highlighter\"\nimport { docco } from \"react-syntax-highlighter/dist/cjs/languages/hljs/javascript\"\n\nconst contentMd = raw(\"./content.md\")\n\nconst RootContainer = styled(\"div\")({\n  display: \"flex\",\n  flexDirection: \"column\",\n  alignItems: \"center\",\n})\nconst ContentContainer = styled(\"div\")({\n  width: \"100%\",\n  boxSizing: \"border-box\",\n  display: \"flex\",\n  flexDirection: \"column\",\n  maxWidth: 1200,\n})\nconst Header = styled(\"div\")({\n  width: \"100%\",\n  display: \"flex\",\n  justifyContent: \"center\",\n  backgroundColor: colors.blue[600],\n  padding: 8,\n  boxSizing: \"border-box\",\n})\nconst HeaderButton = styled(Button)({\n  color: \"white\",\n  margin: 8,\n  padding: 16,\n  paddingLeft: 24,\n  paddingRight: 24,\n})\nconst Hero = styled(\"div\")({\n  display: \"flex\",\n  justifyContent: \"center\",\n  width: \"100%\",\n  backgroundColor: colors.blue[500],\n  padding: 16,\n  color: \"white\",\n  boxSizing: \"border-box\",\n})\nconst HeroMain = styled(\"div\")({\n  fontSize: 48,\n  fontWeight: \"bold\",\n  paddingTop: 64,\n  textShadow: \"0px 1px 5px rgba(0,0,0,0.3)\",\n})\nconst HeroSub = styled(\"div\")({\n  paddingTop: 32,\n  lineHeight: 1.5,\n  fontSize: 24,\n  textShadow: \"0px 1px 3px rgba(0,0,0,0.2)\",\n})\nconst HeroButtons = styled(\"div\")({\n  paddingTop: 32,\n  paddingBottom: 48,\n})\nconst Section = styled(\"div\")({\n  display: \"flex\",\n  padding: 16,\n  paddingTop: 32,\n  flexDirection: \"column\",\n})\n\nconst CodeBlock = ({ language, value }) => {\n  return (\n    <SyntaxHighlighter language={language} style={docco}>\n      {value}\n    </SyntaxHighlighter>\n  )\n}\n\nfunction flatten(text, child) {\n  return typeof child === \"string\"\n    ? text + child\n    : React.Children.toArray(child.props.children).reduce(flatten, text)\n}\n\nfunction HeadingRenderer(props) {\n  var children = React.Children.toArray(props.children)\n  var text = children.reduce(flatten, \"\")\n  var slug = text.toLowerCase().replace(/\\W/g, \"-\")\n  return React.createElement(\"h\" + props.level, { id: slug }, props.children)\n}\n\nconst LandingPage = () => {\n  return (\n    <RootContainer>\n      <Header id=\"about\">\n        <ContentContainer style={{ flexDirection: \"row\", flexGrow: 1 }}>\n          <HeaderButton href=\"#features\">Features</HeaderButton>\n          <HeaderButton href=\"#usage\">Usage</HeaderButton>\n          <HeaderButton href=\"#props\">Props</HeaderButton>\n          <HeaderButton href=\"./demo\">Demo Playground</HeaderButton>\n        </ContentContainer>\n      </Header>\n      <Hero>\n        <ContentContainer>\n          <HeroMain>React Image Annotate</HeroMain>\n          <HeroSub>\n            Powerful React component for image annotations with bounding boxes,\n            tagging, classification, multiple images and polygon segmentation.\n          </HeroSub>\n          <HeroButtons>\n            <GitHubButton\n              href=\"https://github.com/waoai/react-image-annotate\"\n              data-size=\"large\"\n              data-show-count=\"true\"\n              aria-label=\"Star waoai/react-image-annotate on GitHub\"\n            >\n              Star\n            </GitHubButton>\n          </HeroButtons>\n        </ContentContainer>\n      </Hero>\n      <ContentContainer className=\"markdown-body\">\n        <Section className=\"markdown-body\">\n          <Markdown\n            escapeHtml={false}\n            source={contentMd}\n            renderers={{\n              code: CodeBlock,\n              heading: HeadingRenderer,\n            }}\n          />\n        </Section>\n      </ContentContainer>\n    </RootContainer>\n  )\n}\n\nexport default LandingPage\n","// @flow\n\nimport React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport Theme from \"./Theme\"\nimport DemoSite from \"./DemoSite\"\nimport LandingPage from \"./LandingPage\"\nimport \"./site.css\"\n\nconst Site = () => {\n  const path = window.location.pathname\n    .replace(/\\/$/, \"\")\n    .split(\"/\")\n    .slice(-1)[0]\n  return <Theme>{path === \"demo\" ? <DemoSite /> : <LandingPage />}</Theme>\n}\n\nReactDOM.render(<Site />, document.getElementById(\"root\"))\n"],"sourceRoot":""}